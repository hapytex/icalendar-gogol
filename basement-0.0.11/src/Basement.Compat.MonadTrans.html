<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Basement.Compat.MonadTrans</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Psychohistorians</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- An internal and really simple monad transformers,</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- without any bells and whistse.</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Basement.Compat.MonadTrans</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier">State</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier">Reader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Basement.Compat.Base.html"><span class="hs-identifier">Basement.Compat.Base</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- | Simple State monad</span><span>
</span><span id="line-19"></span><span class="hs-keyword">newtype</span><span> </span><span id="State"><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span id="local-6989586621679161207"><span class="annot"><a href="#local-6989586621679161207"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679161206"><span class="annot"><a href="#local-6989586621679161206"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679161205"><span class="annot"><a href="#local-6989586621679161205"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="State"><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runState"><span class="annot"><span class="annottext">State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679161207"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679161206"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679161205"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679161207"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span id="local-6989586621679161125"><span id="local-6989586621679161126"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161122"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161125"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161126"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>    </span><span id="local-6989586621679161120"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; State s m a -&gt; State s m b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679161119"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679161119"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679161118"><span class="annot"><span class="annottext">fa :: State s m a
</span><a href="#local-6989586621679161118"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (b, s)) -&gt; State s m b
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; State s m a
</span><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (b, s)) -&gt; State s m b) -&gt; (s -&gt; m (b, s)) -&gt; State s m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State s m a -&gt; s -&gt; m (a, s)
forall s (m :: * -&gt; *) a. State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">State s m a
</span><a href="#local-6989586621679161118"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; ((a, s) -&gt; m (b, s)) -&gt; s -&gt; m (b, s)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679161117"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161117"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161116"><span class="annot"><span class="annottext">s2 :: s
</span><a href="#local-6989586621679161116"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b, s) -&gt; m (b, s)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679161119"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161117"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679161116"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-23"></span><span id="local-6989586621679161114"><span id="local-6989586621679161115"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161105"><span id="local-6989586621679161107"><span id="local-6989586621679161109"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161114"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>    </span><span id="local-6989586621679161103"><span class="annot"><span class="annottext">pure :: a -&gt; State s m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679161102"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; State s m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; State s m a
</span><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (a, s)) -&gt; State s m a) -&gt; (s -&gt; m (a, s)) -&gt; State s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161101"><span class="annot"><span class="annottext">st :: s
</span><a href="#local-6989586621679161101"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, s) -&gt; m (a, s)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679161101"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span id="local-6989586621679161100"><span class="annot"><span class="annottext">fab :: State s m (a -&gt; b)
</span><a href="#local-6989586621679161100"><span class="hs-identifier hs-var">fab</span></a></span></span><span> </span><span id="local-6989586621679161099"><span class="annot"><span class="annottext">&lt;*&gt; :: State s m (a -&gt; b) -&gt; State s m a -&gt; State s m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679161098"><span class="annot"><span class="annottext">fa :: State s m a
</span><a href="#local-6989586621679161098"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (b, s)) -&gt; State s m b
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; State s m a
</span><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (b, s)) -&gt; State s m b) -&gt; (s -&gt; m (b, s)) -&gt; State s m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161097"><span class="annot"><span class="annottext">s1 :: s
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-26"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679161096"><span class="annot"><span class="annottext">ab :: a -&gt; b
</span><a href="#local-6989586621679161096"><span class="hs-identifier hs-var">ab</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679161095"><span class="annot"><span class="annottext">s2 :: s
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State s m (a -&gt; b) -&gt; s -&gt; m (a -&gt; b, s)
forall s (m :: * -&gt; *) a. State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">State s m (a -&gt; b)
</span><a href="#local-6989586621679161100"><span class="hs-identifier hs-var">fab</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-27"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679161094"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161094"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679161093"><span class="annot"><span class="annottext">s3 :: s
</span><a href="#local-6989586621679161093"><span class="hs-identifier hs-var">s3</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State s m a -&gt; s -&gt; m (a, s)
forall s (m :: * -&gt; *) a. State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">State s m a
</span><a href="#local-6989586621679161098"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><span class="annottext">(b, s) -&gt; m (b, s)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679161096"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161094"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679161093"><span class="hs-identifier hs-var">s3</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-29"></span><span id="local-6989586621679161091"><span id="local-6989586621679161092"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161087"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161092"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161091"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161092"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>    </span><span id="local-6989586621679161084"><span class="annot"><span class="annottext">return :: a -&gt; State r m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679161083"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161083"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m (a, r)) -&gt; State r m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; State s m a
</span><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m (a, r)) -&gt; State r m a) -&gt; (r -&gt; m (a, r)) -&gt; State r m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161082"><span class="annot"><span class="annottext">st :: r
</span><a href="#local-6989586621679161082"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, r) -&gt; m (a, r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161083"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161082"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span id="local-6989586621679161081"><span class="annot"><span class="annottext">ma :: State r m a
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679161080"><span class="annot"><span class="annottext">&gt;&gt;= :: State r m a -&gt; (a -&gt; State r m b) -&gt; State r m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679161079"><span class="annot"><span class="annottext">mb :: a -&gt; State r m b
</span><a href="#local-6989586621679161079"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m (b, r)) -&gt; State r m b
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; State s m a
</span><a href="Basement.Compat.MonadTrans.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m (b, r)) -&gt; State r m b) -&gt; (r -&gt; m (b, r)) -&gt; State r m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161078"><span class="annot"><span class="annottext">s1 :: r
</span><a href="#local-6989586621679161078"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679161077"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161077"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679161076"><span class="annot"><span class="annottext">s2 :: r
</span><a href="#local-6989586621679161076"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State r m a -&gt; r -&gt; m (a, r)
forall s (m :: * -&gt; *) a. State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">State r m a
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161078"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><span class="annottext">State r m b -&gt; r -&gt; m (b, r)
forall s (m :: * -&gt; *) a. State s m a -&gt; s -&gt; m (a, s)
</span><a href="Basement.Compat.MonadTrans.html#runState"><span class="hs-identifier hs-var hs-var">runState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; State r m b
</span><a href="#local-6989586621679161079"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161077"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161076"><span class="hs-identifier hs-var">s2</span></a></span></span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Simple Reader monad</span><span>
</span><span id="line-36"></span><span class="hs-keyword">newtype</span><span> </span><span id="Reader"><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span></span><span> </span><span id="local-6989586621679161151"><span class="annot"><a href="#local-6989586621679161151"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679161150"><span class="annot"><a href="#local-6989586621679161150"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679161149"><span class="annot"><a href="#local-6989586621679161149"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Reader"><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runReader"><span class="annot"><span class="annottext">Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679161151"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679161150"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161149"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span id="local-6989586621679161072"><span id="local-6989586621679161073"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161069"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161073"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161072"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161073"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679161068"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Reader r m a -&gt; Reader r m b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679161067"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679161067"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679161066"><span class="annot"><span class="annottext">fa :: Reader r m a
</span><a href="#local-6989586621679161066"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m b) -&gt; Reader r m b
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; Reader r m a
</span><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m b) -&gt; Reader r m b) -&gt; (r -&gt; m b) -&gt; Reader r m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reader r m a -&gt; r -&gt; m a
forall r (m :: * -&gt; *) a. Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Reader r m a
</span><a href="#local-6989586621679161066"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; m a) -&gt; (a -&gt; m b) -&gt; r -&gt; m b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679161065"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161065"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679161067"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161065"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-40"></span><span id="local-6989586621679161063"><span id="local-6989586621679161064"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161054"><span id="local-6989586621679161056"><span id="local-6989586621679161058"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161064"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161063"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161064"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679161053"><span class="annot"><span class="annottext">pure :: a -&gt; Reader r m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679161052"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161052"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m a) -&gt; Reader r m a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; Reader r m a
</span><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m a) -&gt; Reader r m a) -&gt; (r -&gt; m a) -&gt; Reader r m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161052"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span id="local-6989586621679161051"><span class="annot"><span class="annottext">fab :: Reader r m (a -&gt; b)
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var">fab</span></a></span></span><span> </span><span id="local-6989586621679161050"><span class="annot"><span class="annottext">&lt;*&gt; :: Reader r m (a -&gt; b) -&gt; Reader r m a -&gt; Reader r m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679161049"><span class="annot"><span class="annottext">fa :: Reader r m a
</span><a href="#local-6989586621679161049"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m b) -&gt; Reader r m b
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; Reader r m a
</span><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m b) -&gt; Reader r m b) -&gt; (r -&gt; m b) -&gt; Reader r m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161048"><span class="annot"><span class="annottext">r :: r
</span><a href="#local-6989586621679161048"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-43"></span><span>        </span><span id="local-6989586621679161047"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161047"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reader r m a -&gt; r -&gt; m a
forall r (m :: * -&gt; *) a. Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Reader r m a
</span><a href="#local-6989586621679161049"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161048"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-44"></span><span>        </span><span id="local-6989586621679161046"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679161046"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reader r m (a -&gt; b) -&gt; r -&gt; m (a -&gt; b)
forall r (m :: * -&gt; *) a. Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Reader r m (a -&gt; b)
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var">fab</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161048"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; m b) -&gt; b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679161046"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161047"><span class="hs-identifier hs-var">a</span></a></span></span></span><span>
</span><span id="line-46"></span><span id="local-6989586621679161044"><span id="local-6989586621679161045"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161040"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679161045"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161044"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679161045"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679161038"><span class="annot"><span class="annottext">return :: a -&gt; Reader r m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679161037"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679161037"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m a) -&gt; Reader r m a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; Reader r m a
</span><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m a) -&gt; Reader r m a) -&gt; (r -&gt; m a) -&gt; Reader r m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161037"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679161036"><span class="annot"><span class="annottext">ma :: Reader r m a
</span><a href="#local-6989586621679161036"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679161035"><span class="annot"><span class="annottext">&gt;&gt;= :: Reader r m a -&gt; (a -&gt; Reader r m b) -&gt; Reader r m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679161034"><span class="annot"><span class="annottext">mb :: a -&gt; Reader r m b
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m b) -&gt; Reader r m b
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; Reader r m a
</span><a href="Basement.Compat.MonadTrans.html#Reader"><span class="hs-identifier hs-var">Reader</span></a></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m b) -&gt; Reader r m b) -&gt; (r -&gt; m b) -&gt; Reader r m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679161033"><span class="annot"><span class="annottext">r :: r
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>        </span><span id="local-6989586621679161032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reader r m a -&gt; r -&gt; m a
forall r (m :: * -&gt; *) a. Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Reader r m a
</span><a href="#local-6989586621679161036"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="annottext">Reader r m b -&gt; r -&gt; m b
forall r (m :: * -&gt; *) a. Reader r m a -&gt; r -&gt; m a
</span><a href="Basement.Compat.MonadTrans.html#runReader"><span class="hs-identifier hs-var hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Reader r m b
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">r</span></a></span></span></span><span>
</span><span id="line-51"></span></pre></body></html>