<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections     #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.ICalendar.Parser.Properties</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Error</span></span><span>          </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.RWS</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base64.Lazy</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B64</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CI</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Version</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ver</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                      </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readP_to_S</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Prim</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html"><span class="hs-identifier">Text.ICalendar.Parser.Common</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Parameters.html"><span class="hs-identifier">Text.ICalendar.Parser.Parameters</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html"><span class="hs-identifier">Text.ICalendar.Types</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseFreeBusy"><span class="hs-identifier hs-type">parseFreeBusy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#FreeBusy"><span class="hs-identifier hs-type">FreeBusy</span></a></span><span>
</span><span id="line-32"></span><span id="parseFreeBusy"><span class="annot"><span class="annottext">parseFreeBusy :: Content -&gt; ContentParser FreeBusy
</span><a href="Text.ICalendar.Parser.Properties.html#parseFreeBusy"><span class="hs-identifier hs-var hs-var">parseFreeBusy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;FREEBUSY&quot;</span><span> </span><span id="local-6989586621679155466"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155466"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155465"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155465"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-33"></span><span>    </span><span id="local-6989586621679155464"><span class="annot"><span class="annottext">FBType
</span><a href="#local-6989586621679155464"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  FBType
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         FBType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     FBType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FBType
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     FBType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FBType
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; FBType
</span><a href="Text.ICalendar.Parser.Parameters.html#parseFBType"><span class="hs-identifier hs-var">parseFBType</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; FBType) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; FBType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FBType)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     FBType
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      FBType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     FBType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-34"></span><span>                     </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;FBTYPE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span id="local-6989586621679155455"><span class="annot"><span class="annottext">Set UTCPeriod
</span><a href="#local-6989586621679155455"><span class="hs-identifier hs-var">periods</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[UTCPeriod] -&gt; Set UTCPeriod
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([UTCPeriod] -&gt; Set UTCPeriod)
-&gt; ([ByteString]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [UTCPeriod])
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set UTCPeriod)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      UTCPeriod)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [UTCPeriod]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     UTCPeriod
</span><a href="Text.ICalendar.Parser.Parameters.html#parseUTCPeriod"><span class="hs-identifier hs-var">parseUTCPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set UTCPeriod))
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set UTCPeriod)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155465"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="annottext">FreeBusy -&gt; ContentParser FreeBusy
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FreeBusy -&gt; ContentParser FreeBusy)
-&gt; FreeBusy -&gt; ContentParser FreeBusy
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FBType -&gt; Set UTCPeriod -&gt; OtherParams -&gt; FreeBusy
</span><a href="Text.ICalendar.Types.html#FreeBusy"><span class="hs-identifier hs-var">FreeBusy</span></a></span><span> </span><span class="annot"><span class="annottext">FBType
</span><a href="#local-6989586621679155464"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Set UTCPeriod
</span><a href="#local-6989586621679155455"><span class="hs-identifier hs-var">periods</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])] -&gt; OtherParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="hs-string">&quot;FBTYPE&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155466"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseFreeBusy"><span class="hs-identifier hs-var">parseFreeBusy</span></a></span><span> </span><span id="local-6989586621679155448"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155448"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser FreeBusy
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser FreeBusy)
-&gt; String -&gt; ContentParser FreeBusy
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseFreeBusy: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155448"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span id="local-6989586621679155445"><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseXDurationOpt"><span class="hs-identifier hs-type">parseXDurationOpt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-40"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStart"><span class="hs-identifier hs-type">DTStart</span></a></span><span>
</span><span id="line-43"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679155445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DurationProp"><span class="hs-identifier hs-type">DurationProp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-44"></span><span id="parseXDurationOpt"><span class="annot"><span class="annottext">parseXDurationOpt :: CI Text
-&gt; (DateTime -&gt; OtherParams -&gt; a)
-&gt; (Date -&gt; OtherParams -&gt; a)
-&gt; Maybe DTStart
-&gt; ContentParser (Maybe (Either a DurationProp))
</span><a href="Text.ICalendar.Parser.Properties.html#parseXDurationOpt"><span class="hs-identifier hs-var hs-var">parseXDurationOpt</span></a></span></span><span> </span><span id="local-6989586621679155443"><span class="annot"><span class="annottext">w :: CI Text
</span><a href="#local-6989586621679155443"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679155442"><span class="annot"><span class="annottext">a :: DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679155442"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679155441"><span class="annot"><span class="annottext">b :: Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679155441"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679155440"><span class="annot"><span class="annottext">dts :: Maybe DTStart
</span><a href="#local-6989586621679155440"><span class="hs-identifier hs-var">dts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>    </span><span id="local-6989586621679155439"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679155439"><span class="hs-identifier hs-var">dte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CI Text
-&gt; (Content -&gt; ContentParser (Maybe a)) -&gt; ContentParser (Maybe a)
forall b.
Default b =&gt;
CI Text -&gt; (Content -&gt; ContentParser b) -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#optLine1"><span class="hs-identifier hs-var">optLine1</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155443"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((Content -&gt; ContentParser (Maybe a)) -&gt; ContentParser (Maybe a))
-&gt; (Content -&gt; ContentParser (Maybe a)) -&gt; ContentParser (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a)
-&gt; (Content
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) a)
-&gt; Content
-&gt; ContentParser (Maybe a)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; OtherParams -&gt; a)
-&gt; (Date -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) a
forall a.
(DateTime -&gt; OtherParams -&gt; a)
-&gt; (Date -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateOrDateTime"><span class="hs-identifier hs-var">parseSimpleDateOrDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679155442"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679155441"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679155436"><span class="annot"><span class="annottext">Maybe DurationProp
</span><a href="#local-6989586621679155436"><span class="hs-identifier hs-var">dur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CI Text
-&gt; (Content -&gt; ContentParser (Maybe DurationProp))
-&gt; ContentParser (Maybe DurationProp)
forall b.
Default b =&gt;
CI Text -&gt; (Content -&gt; ContentParser b) -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#optLine1"><span class="hs-identifier hs-var">optLine1</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;DURATION&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Content -&gt; ContentParser (Maybe DurationProp))
 -&gt; ContentParser (Maybe DurationProp))
-&gt; (Content -&gt; ContentParser (Maybe DurationProp))
-&gt; ContentParser (Maybe DurationProp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DurationProp -&gt; Maybe DurationProp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DurationProp -&gt; Maybe DurationProp)
-&gt; (Content
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         DurationProp)
-&gt; Content
-&gt; ContentParser (Maybe DurationProp)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
-&gt; Content
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
</span><a href="Text.ICalendar.Parser.Properties.html#parseDurationProp"><span class="hs-identifier hs-var">parseDurationProp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155440"><span class="hs-identifier hs-var">dts</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679155439"><span class="hs-identifier hs-var">dte</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DurationProp
</span><a href="#local-6989586621679155436"><span class="hs-identifier hs-var">dur</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-48"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Either a DurationProp)
-&gt; ContentParser (Maybe (Either a DurationProp))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either a DurationProp)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-49"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679155434"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679155434"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Either a DurationProp)
-&gt; ContentParser (Maybe (Either a DurationProp))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either a DurationProp)
 -&gt; ContentParser (Maybe (Either a DurationProp)))
-&gt; (Either a DurationProp -&gt; Maybe (Either a DurationProp))
-&gt; Either a DurationProp
-&gt; ContentParser (Maybe (Either a DurationProp))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either a DurationProp -&gt; Maybe (Either a DurationProp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either a DurationProp
 -&gt; ContentParser (Maybe (Either a DurationProp)))
-&gt; Either a DurationProp
-&gt; ContentParser (Maybe (Either a DurationProp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a DurationProp
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155434"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-50"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679155433"><span class="annot"><span class="annottext">x :: DurationProp
</span><a href="#local-6989586621679155433"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Either a DurationProp)
-&gt; ContentParser (Maybe (Either a DurationProp))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either a DurationProp)
 -&gt; ContentParser (Maybe (Either a DurationProp)))
-&gt; (Either a DurationProp -&gt; Maybe (Either a DurationProp))
-&gt; Either a DurationProp
-&gt; ContentParser (Maybe (Either a DurationProp))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either a DurationProp -&gt; Maybe (Either a DurationProp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either a DurationProp
 -&gt; ContentParser (Maybe (Either a DurationProp)))
-&gt; Either a DurationProp
-&gt; ContentParser (Maybe (Either a DurationProp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DurationProp -&gt; Either a DurationProp
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DurationProp
</span><a href="#local-6989586621679155433"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-51"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser (Maybe (Either a DurationProp))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Either DTEND or DURATION can be specified, but not \
                         \both.&quot;</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Parse trigger. 3.8.6.3</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTrigger"><span class="hs-identifier hs-type">parseTrigger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Trigger"><span class="hs-identifier hs-type">Trigger</span></a></span><span>
</span><span id="line-56"></span><span id="parseTrigger"><span class="annot"><span class="annottext">parseTrigger :: Content -&gt; ContentParser Trigger
</span><a href="Text.ICalendar.Parser.Properties.html#parseTrigger"><span class="hs-identifier hs-var hs-var">parseTrigger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;TRIGGER&quot;</span><span> </span><span id="local-6989586621679155431"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155431"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155430"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155430"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679155429"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155429"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; (Maybe [Text] -&gt; [Text])
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe [Text] -&gt; [Text]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;DURATION&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155431"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155429"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-59"></span><span>         </span><span class="hs-string">&quot;DURATION&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>            </span><span id="local-6989586621679155427"><span class="annot"><span class="annottext">AlarmTriggerRelationship
</span><a href="#local-6989586621679155427"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  AlarmTriggerRelationship
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         AlarmTriggerRelationship)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlarmTriggerRelationship
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">AlarmTriggerRelationship
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
</span><a href="Text.ICalendar.Parser.Parameters.html#parseAlarmTriggerRelationship"><span class="hs-identifier hs-var">parseAlarmTriggerRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      AlarmTriggerRelationship)
-&gt; (Text -&gt; CI Text)
-&gt; Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span>
</span><span id="line-62"></span><span>                               </span><span class="annot"><span class="annottext">(Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      AlarmTriggerRelationship)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      AlarmTriggerRelationship)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     AlarmTriggerRelationship
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RELATED&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155431"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-63"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155424"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155424"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155423"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155423"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155423"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155423"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RELATED&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155431"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-64"></span><span>            </span><span id="local-6989586621679155421"><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621679155421"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; ContentParser Duration
</span><a href="Text.ICalendar.Parser.Parameters.html#parseDuration"><span class="hs-identifier hs-var">parseDuration</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;TRIGGER&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155430"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-65"></span><span>            </span><span class="annot"><span class="annottext">Trigger -&gt; ContentParser Trigger
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Trigger -&gt; ContentParser Trigger)
-&gt; Trigger -&gt; ContentParser Trigger
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Duration -&gt; AlarmTriggerRelationship -&gt; OtherParams -&gt; Trigger
</span><a href="Text.ICalendar.Types.html#TriggerDuration"><span class="hs-identifier hs-var">TriggerDuration</span></a></span><span> </span><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621679155421"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">AlarmTriggerRelationship
</span><a href="#local-6989586621679155427"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155424"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>         </span><span class="hs-string">&quot;DATE-TIME&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679155418"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679155418"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; ContentParser UTCTime
</span><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var">mustBeUTC</span></a></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; ContentParser UTCTime)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
-&gt; ContentParser UTCTime
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155430"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-67"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155414"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155414"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155413"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155413"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155413"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155431"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-68"></span><span>                           </span><span class="annot"><span class="annottext">Trigger -&gt; ContentParser Trigger
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Trigger -&gt; ContentParser Trigger)
-&gt; Trigger -&gt; ContentParser Trigger
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; OtherParams -&gt; Trigger
</span><a href="Text.ICalendar.Types.html#TriggerDateTime"><span class="hs-identifier hs-var">TriggerDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679155418"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155414"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>         </span><span id="local-6989586621679155411"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679155411"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Trigger
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Trigger)
-&gt; String -&gt; ContentParser Trigger
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTrigger: invalid value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155411"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTrigger"><span class="hs-identifier hs-var">parseTrigger</span></a></span><span> </span><span id="local-6989586621679155410"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155410"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Trigger
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Trigger)
-&gt; String -&gt; ContentParser Trigger
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTrigger: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155410"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Parse related to. 3.8.4.5</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRelatedTo"><span class="hs-identifier hs-type">parseRelatedTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RelatedTo"><span class="hs-identifier hs-type">RelatedTo</span></a></span><span>
</span><span id="line-75"></span><span id="parseRelatedTo"><span class="annot"><span class="annottext">parseRelatedTo :: Content -&gt; ContentParser RelatedTo
</span><a href="Text.ICalendar.Parser.Properties.html#parseRelatedTo"><span class="hs-identifier hs-var hs-var">parseRelatedTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;RELATED-TO&quot;</span><span> </span><span id="local-6989586621679155408"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155408"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155407"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155407"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679155406"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155406"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155407"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679155403"><span class="annot"><span class="annottext">RelationshipType
</span><a href="#local-6989586621679155403"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  RelationshipType
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         RelationshipType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     RelationshipType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelationshipType
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     RelationshipType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">RelationshipType
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; RelationshipType
</span><a href="Text.ICalendar.Parser.Parameters.html#parseRelationshipType"><span class="hs-identifier hs-var">parseRelationshipType</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; RelationshipType)
-&gt; (Text -&gt; CI Text) -&gt; Text -&gt; RelationshipType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RelationshipType)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     RelationshipType
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      RelationshipType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     RelationshipType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-78"></span><span>                </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RELTYPE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155408"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">RelatedTo -&gt; ContentParser RelatedTo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RelatedTo -&gt; ContentParser RelatedTo)
-&gt; RelatedTo -&gt; ContentParser RelatedTo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; RelationshipType -&gt; OtherParams -&gt; RelatedTo
</span><a href="Text.ICalendar.Types.html#RelatedTo"><span class="hs-identifier hs-var">RelatedTo</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155406"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">RelationshipType
</span><a href="#local-6989586621679155403"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])] -&gt; OtherParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155400"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155400"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RELTYPE&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155408"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRelatedTo"><span class="hs-identifier hs-var">parseRelatedTo</span></a></span><span> </span><span id="local-6989586621679155399"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155399"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RelatedTo
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RelatedTo)
-&gt; String -&gt; ContentParser RelatedTo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRelatedTo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155399"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Parse request status. 3.8.8.3</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRequestStatus"><span class="hs-identifier hs-type">parseRequestStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RequestStatus"><span class="hs-identifier hs-type">RequestStatus</span></a></span><span>
</span><span id="line-85"></span><span id="parseRequestStatus"><span class="annot"><span class="annottext">parseRequestStatus :: Content -&gt; ContentParser RequestStatus
</span><a href="Text.ICalendar.Parser.Properties.html#parseRequestStatus"><span class="hs-identifier hs-var hs-var">parseRequestStatus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;REQUEST-STATUS&quot;</span><span> </span><span id="local-6989586621679155397"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155397"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155396"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155396"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155395"><span class="annot"><span class="annottext">statcode' :: ByteString
</span><a href="#local-6989586621679155395"><span class="hs-identifier hs-var">statcode'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155394"><span class="annot"><span class="annottext">rest :: ByteString
</span><a href="#local-6989586621679155394"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155396"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="#local-6989586621679155392"><span class="hs-identifier hs-type">statcode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621679155392"><span class="annot"><span class="annottext">statcode :: Maybe [Int]
</span><a href="#local-6989586621679155392"><span class="hs-identifier hs-var hs-var">statcode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe Int) -&gt; [ByteString] -&gt; Maybe [Int]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int)
-&gt; (ByteString -&gt; String) -&gt; ByteString -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; Maybe [Int]) -&gt; [ByteString] -&gt; Maybe [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155395"><span class="hs-identifier hs-var">statcode'</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Int] -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Int]
</span><a href="#local-6989586621679155392"><span class="hs-identifier hs-var">statcode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRequestStatus: invalid code: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155396"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155394"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRequestStatus: missing statdesc: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155396"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679155386"><span class="annot"><span class="annottext">statdesc :: Text
</span><a href="#local-6989586621679155386"><span class="hs-identifier hs-var">statdesc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155385"><span class="annot"><span class="annottext">rest' :: ByteString
</span><a href="#local-6989586621679155385"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155384"><span class="annot"><span class="annottext">a :: [Text]
</span><a href="#local-6989586621679155384"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679155383"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679155383"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155383"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (Text, ByteString))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Text, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679155384"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                                   </span><span class="annot"><span class="annottext">(([Text], ByteString)
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Text, ByteString))
-&gt; (ByteString
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         ([Text], ByteString))
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Text, ByteString)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     ([Text], ByteString)
</span><a href="Text.ICalendar.Parser.Common.html#parseText%27"><span class="hs-identifier hs-var">parseText'</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Text, ByteString))
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Text, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.tail</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155394"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679155379"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155379"><span class="hs-identifier hs-var">statext</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155385"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-96"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-97"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Char
</span><span class="hs-identifier hs-var">B.head</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155385"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-98"></span><span>                              </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRequestStatus: bad desc: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-99"></span><span>                                               </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155396"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-100"></span><span>                          </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text)
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.tail</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155385"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679155377"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155377"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language) -&gt; Maybe [Text] -&gt; Maybe [Language]
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155397"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155375"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155375"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155374"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155374"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155374"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [CI Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155397"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">RequestStatus -&gt; ContentParser RequestStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RequestStatus -&gt; ContentParser RequestStatus)
-&gt; RequestStatus -&gt; ContentParser RequestStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int]
-&gt; Text
-&gt; Maybe Language
-&gt; Maybe Text
-&gt; OtherParams
-&gt; RequestStatus
</span><a href="Text.ICalendar.Types.html#RequestStatus"><span class="hs-identifier hs-var">RequestStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Int] -&gt; [Int]
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Int]
</span><a href="#local-6989586621679155392"><span class="hs-identifier hs-var">statcode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155386"><span class="hs-identifier hs-var">statdesc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155377"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155379"><span class="hs-identifier hs-var">statext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155375"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRequestStatus"><span class="hs-identifier hs-var">parseRequestStatus</span></a></span><span> </span><span id="local-6989586621679155370"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155370"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RequestStatus
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RequestStatus)
-&gt; String -&gt; ContentParser RequestStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRequestStatus: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155370"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Parse exception date-times. 3.8.5.1</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseExDate"><span class="hs-identifier hs-type">parseExDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#ExDate"><span class="hs-identifier hs-type">ExDate</span></a></span><span>
</span><span id="line-108"></span><span id="parseExDate"><span class="annot"><span class="annottext">parseExDate :: Content -&gt; ContentParser ExDate
</span><a href="Text.ICalendar.Parser.Properties.html#parseExDate"><span class="hs-identifier hs-var hs-var">parseExDate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;EXDATE&quot;</span><span> </span><span id="local-6989586621679155368"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155368"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155367"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155367"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679155366"><span class="annot"><span class="annottext">typ :: Text
</span><a href="#local-6989586621679155366"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155365"><span class="annot"><span class="annottext">tzid :: Maybe Text
</span><a href="#local-6989586621679155365"><span class="hs-identifier hs-var">tzid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155364"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155364"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
-&gt; ContentParser (Text, Maybe Text, [(CI Text, [Text])])
</span><a href="Text.ICalendar.Parser.Common.html#typTzIdO"><span class="hs-identifier hs-var">typTzIdO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155368"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155362"><span class="annot"><span class="annottext">bs' :: [ByteString]
</span><a href="#local-6989586621679155362"><span class="hs-identifier hs-var hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155367"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155366"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>         </span><span class="hs-string">&quot;DATE-TIME&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679155361"><span class="annot"><span class="annottext">[DateTime]
</span><a href="#local-6989586621679155361"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      DateTime)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [DateTime]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155365"><span class="hs-identifier hs-var">tzid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679155362"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-113"></span><span>                           </span><span class="annot"><span class="annottext">ExDate -&gt; ContentParser ExDate
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ExDate -&gt; ContentParser ExDate)
-&gt; (OtherParams -&gt; ExDate) -&gt; OtherParams -&gt; ContentParser ExDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set DateTime -&gt; OtherParams -&gt; ExDate
</span><a href="Text.ICalendar.Types.html#ExDateTimes"><span class="hs-identifier hs-var">ExDateTimes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DateTime] -&gt; Set DateTime
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[DateTime]
</span><a href="#local-6989586621679155361"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser ExDate)
-&gt; OtherParams -&gt; ContentParser ExDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155364"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-114"></span><span>         </span><span class="hs-string">&quot;DATE&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679155359"><span class="annot"><span class="annottext">[Date]
</span><a href="#local-6989586621679155359"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Date)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Date]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Date
</span><a href="Text.ICalendar.Parser.Common.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679155362"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-115"></span><span>                      </span><span class="annot"><span class="annottext">ExDate -&gt; ContentParser ExDate
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ExDate -&gt; ContentParser ExDate)
-&gt; (OtherParams -&gt; ExDate) -&gt; OtherParams -&gt; ContentParser ExDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set Date -&gt; OtherParams -&gt; ExDate
</span><a href="Text.ICalendar.Types.html#ExDates"><span class="hs-identifier hs-var">ExDates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Date] -&gt; Set Date
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Date]
</span><a href="#local-6989586621679155359"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser ExDate)
-&gt; OtherParams -&gt; ContentParser ExDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155364"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-116"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser ExDate
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser ExDate) -&gt; String -&gt; ContentParser ExDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Invalid type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155366"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseExDate"><span class="hs-identifier hs-var">parseExDate</span></a></span><span> </span><span id="local-6989586621679155356"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155356"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser ExDate
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser ExDate) -&gt; String -&gt; ContentParser ExDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseExDate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155356"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Parse categories. 3.8.1.2</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseCategories"><span class="hs-identifier hs-type">parseCategories</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Categories"><span class="hs-identifier hs-type">Categories</span></a></span><span>
</span><span id="line-121"></span><span id="parseCategories"><span class="annot"><span class="annottext">parseCategories :: Content -&gt; ContentParser Categories
</span><a href="Text.ICalendar.Parser.Properties.html#parseCategories"><span class="hs-identifier hs-var hs-var">parseCategories</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;CATEGORIES&quot;</span><span> </span><span id="local-6989586621679155354"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155354"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155353"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155353"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679155352"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679155352"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155353"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621679155351"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155351"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language) -&gt; Maybe [Text] -&gt; Maybe [Language]
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155354"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155350"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155350"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679155349"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155349"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [CI Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155354"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">Categories -&gt; ContentParser Categories
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Categories -&gt; ContentParser Categories)
-&gt; Categories -&gt; ContentParser Categories
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Text -&gt; Maybe Language -&gt; OtherParams -&gt; Categories
</span><a href="Text.ICalendar.Types.html#Categories"><span class="hs-identifier hs-var">Categories</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Set Text
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679155352"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155351"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155350"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseCategories"><span class="hs-identifier hs-var">parseCategories</span></a></span><span> </span><span id="local-6989586621679155347"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155347"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Categories
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Categories)
-&gt; String -&gt; ContentParser Categories
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseCategories: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155347"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Parse attendee. 3.8.4.1</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseAttendee"><span class="hs-identifier hs-type">parseAttendee</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Attendee"><span class="hs-identifier hs-type">Attendee</span></a></span><span>
</span><span id="line-130"></span><span id="parseAttendee"><span class="annot"><span class="annottext">parseAttendee :: Content -&gt; ContentParser Attendee
</span><a href="Text.ICalendar.Parser.Properties.html#parseAttendee"><span class="hs-identifier hs-var hs-var">parseAttendee</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;ATTENDEE&quot;</span><span> </span><span id="local-6989586621679155345"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155344"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155344"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679155343"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679155343"><span class="hs-identifier hs-var">attendeeValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
-&gt; ContentParser URI
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155344"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679155339"><span class="annot"><span class="annottext">CUType
</span><a href="#local-6989586621679155339"><span class="hs-identifier hs-var">attendeeCUType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      CUType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     CUType
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; CUType
</span><a href="Text.ICalendar.Parser.Parameters.html#parseCUType"><span class="hs-identifier hs-var">parseCUType</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; CUType) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; CUType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; CUType)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     CUType
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      CUType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     CUType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-133"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CUTYPE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679155336"><span class="annot"><span class="annottext">Set URI
</span><a href="#local-6989586621679155336"><span class="hs-identifier hs-var">attendeeMember</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[URI] -&gt; Set URI
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([URI] -&gt; Set URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [URI])
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [URI]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-135"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;MEMBER&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679155335"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679155335"><span class="hs-identifier hs-var">attendeeRole</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Role)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Role
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; Role
</span><a href="Text.ICalendar.Parser.Parameters.html#parseRole"><span class="hs-identifier hs-var">parseRole</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Role) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Role
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Role)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Role
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Role)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Role
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ROLE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679155333"><span class="annot"><span class="annottext">PartStat
</span><a href="#local-6989586621679155333"><span class="hs-identifier hs-var">attendeePartStat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      PartStat)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     PartStat
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; PartStat
</span><a href="Text.ICalendar.Parser.Parameters.html#parsePartStat"><span class="hs-identifier hs-var">parsePartStat</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; PartStat) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; PartStat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PartStat)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     PartStat
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      PartStat)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     PartStat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-138"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PARTSTAT&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679155331"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679155331"><span class="hs-identifier hs-var">attendeeRSVP</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Bool)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
</span><a href="Text.ICalendar.Parser.Parameters.html#parseBool"><span class="hs-identifier hs-var">parseBool</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Bool)
-&gt; (Text -&gt; CI Text)
-&gt; Text
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Bool)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Bool)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-140"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RSVP&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679155329"><span class="annot"><span class="annottext">Set URI
</span><a href="#local-6989586621679155329"><span class="hs-identifier hs-var">attendeeDelTo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[URI] -&gt; Set URI
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([URI] -&gt; Set URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [URI])
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [URI]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-142"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DELEGATED-TO&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679155328"><span class="annot"><span class="annottext">Set URI
</span><a href="#local-6989586621679155328"><span class="hs-identifier hs-var">attendeeDelFrom</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (m :: * -&gt; *) b a.
(Monad m, Default b) =&gt;
(a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[URI] -&gt; Set URI
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([URI] -&gt; Set URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [URI])
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [URI]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-144"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DELEGATED-FROM&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679155327"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679155327"><span class="hs-identifier hs-var">attendeeSentBy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser URI)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ContentParser URI
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-146"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SENT-BY&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679155326"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155326"><span class="hs-identifier hs-var">attendeeCN</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CN&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679155325"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679155325"><span class="hs-identifier hs-var">attendeeDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser URI)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ContentParser URI
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-149"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DIR&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679155324"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155324"><span class="hs-identifier hs-var">attendeeLanguage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-151"></span><span>                        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155323"><span class="annot"><span class="annottext">attendeeOther :: OtherParams
</span><a href="#local-6989586621679155323"><span class="hs-identifier hs-var hs-var">attendeeOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])] -&gt; OtherParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; Bool
forall a b. (Eq a, IsString a) =&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679155322"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155345"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621679155322"><span class="annot"><span class="annottext">f :: (a, b) -&gt; Bool
</span><a href="#local-6989586621679155322"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155321"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679155321"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155321"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;CUTYPE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;MEMBER&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;ROLE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;PARTSTAT&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;RSVP&quot;</span></span><span>
</span><span id="line-154"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;DELEGATED-TO&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;DELEGATED-FROM&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;SENT-BY&quot;</span></span><span>
</span><span id="line-155"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;CN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;DIR&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">Attendee -&gt; ContentParser Attendee
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Attendee :: URI
-&gt; CUType
-&gt; Set URI
-&gt; Role
-&gt; PartStat
-&gt; Bool
-&gt; Set URI
-&gt; Set URI
-&gt; Maybe URI
-&gt; Maybe Text
-&gt; Maybe URI
-&gt; Maybe Language
-&gt; OtherParams
-&gt; Attendee
</span><a href="Text.ICalendar.Types.html#Attendee"><span class="hs-identifier hs-type hs-type">Attendee</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155546"><span id="local-6989586621679155547"><span id="local-6989586621679155548"><span class="annot"><a href="#local-6989586621679155338"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679155548"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="#local-6989586621679155547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679155546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155548"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679155546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155548"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155547"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679155338"><span class="annot"><span class="annottext">g :: (a -&gt; m b) -&gt; Maybe a -&gt; m b
</span><a href="#local-6989586621679155338"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m b -&gt; (a -&gt; m b) -&gt; Maybe a -&gt; m b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">(m b -&gt; (a -&gt; m b) -&gt; Maybe a -&gt; m b)
-&gt; m b -&gt; (a -&gt; m b) -&gt; Maybe a -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseAttendee"><span class="hs-identifier hs-var">parseAttendee</span></a></span><span> </span><span id="local-6989586621679155305"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155305"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Attendee
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Attendee)
-&gt; String -&gt; ContentParser Attendee
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAttendee: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155305"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Parse attachment. 3.8.1.1</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseAttachment"><span class="hs-identifier hs-type">parseAttachment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Attachment"><span class="hs-identifier hs-type">Attachment</span></a></span><span>
</span><span id="line-164"></span><span id="parseAttachment"><span class="annot"><span class="annottext">parseAttachment :: Content -&gt; ContentParser Attachment
</span><a href="Text.ICalendar.Parser.Properties.html#parseAttachment"><span class="hs-identifier hs-var hs-var">parseAttachment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;ATTACH&quot;</span><span> </span><span id="local-6989586621679155303"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155302"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155302"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679155301"><span class="annot"><span class="annottext">Maybe MIMEType
</span><a href="#local-6989586621679155301"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      MIMEType)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe MIMEType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     MIMEType
</span><a href="Text.ICalendar.Parser.Parameters.html#parseMime"><span class="hs-identifier hs-var">parseMime</span></a></span><span> </span><span class="annot"><span class="annottext">(Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      MIMEType)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     MIMEType
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe MIMEType))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe MIMEType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;FMTTYPE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679155299"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155299"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155299"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-string">&quot;BINARY&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>             </span><span id="local-6989586621679155298"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155298"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ENCODING&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-170"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155298"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-string">&quot;BASE64&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>                      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><span class="hs-identifier hs-var">B64.decode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155302"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679155296"><span class="annot"><span class="annottext">e :: String
</span><a href="#local-6989586621679155296"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Attachment
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Attachment)
-&gt; String -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAttachment: invalid \
                                                  \base64: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155296"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-175"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679155295"><span class="annot"><span class="annottext">v :: ByteString
</span><a href="#local-6989586621679155295"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attachment -&gt; ContentParser Attachment
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Attachment -&gt; ContentParser Attachment)
-&gt; Attachment -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe MIMEType -&gt; ByteString -&gt; OtherParams -&gt; Attachment
</span><a href="Text.ICalendar.Types.html#BinaryAttachment"><span class="hs-identifier hs-var">BinaryAttachment</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MIMEType
</span><a href="#local-6989586621679155301"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155295"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-176"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])] -&gt; OtherParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; Bool
forall a b. (Eq a, IsString a) =&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679155293"><span class="hs-identifier hs-var">binF</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>                  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Attachment
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Attachment)
-&gt; String -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAttachment: invalid encoding: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-178"></span><span>                                        </span><span class="annot"><span class="annottext">Maybe Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155298"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-179"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679155292"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679155292"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
-&gt; ContentParser URI
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155302"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>                       </span><span class="annot"><span class="annottext">Attachment -&gt; ContentParser Attachment
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Attachment -&gt; ContentParser Attachment)
-&gt; Attachment -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe MIMEType -&gt; URI -&gt; OtherParams -&gt; Attachment
</span><a href="Text.ICalendar.Types.html#UriAttachment"><span class="hs-identifier hs-var">UriAttachment</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MIMEType
</span><a href="#local-6989586621679155301"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679155292"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])] -&gt; OtherParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; Bool
forall a b. (Eq a, IsString a) =&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679155290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155303"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Attachment
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Attachment)
-&gt; String -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAttachment: invalid value: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155299"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155293"><span class="annot"><span class="annottext">binF :: (a, b) -&gt; Bool
</span><a href="#local-6989586621679155293"><span class="hs-identifier hs-var hs-var">binF</span></a></span></span><span> </span><span id="local-6989586621679155289"><span class="annot"><span class="annottext">a :: (a, b)
</span><a href="#local-6989586621679155289"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679155288"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679155288"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; Bool
forall a b. (Eq a, IsString a) =&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679155290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679155289"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155288"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155288"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ENCODING&quot;</span></span><span>
</span><span id="line-183"></span><span>        </span><span id="local-6989586621679155290"><span class="annot"><span class="annottext">f :: (a, b) -&gt; Bool
</span><a href="#local-6989586621679155290"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155287"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679155287"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;FMTTYPE&quot;</span></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseAttachment"><span class="hs-identifier hs-var">parseAttachment</span></a></span><span> </span><span id="local-6989586621679155286"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155286"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Attachment
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Attachment)
-&gt; String -&gt; ContentParser Attachment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAttachment: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155286"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseDurationProp"><span class="hs-identifier hs-type">parseDurationProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStart"><span class="hs-identifier hs-type">DTStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DurationProp"><span class="hs-identifier hs-type">DurationProp</span></a></span><span>
</span><span id="line-187"></span><span id="parseDurationProp"><span class="annot"><span class="annottext">parseDurationProp :: Maybe DTStart
-&gt; Content
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
</span><a href="Text.ICalendar.Parser.Properties.html#parseDurationProp"><span class="hs-identifier hs-var hs-var">parseDurationProp</span></a></span></span><span> </span><span id="local-6989586621679155285"><span class="annot"><span class="annottext">dts :: Maybe DTStart
</span><a href="#local-6989586621679155285"><span class="hs-identifier hs-var">dts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;DURATION&quot;</span><span> </span><span id="local-6989586621679155284"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155284"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155283"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155283"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679155282"><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621679155282"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; ContentParser Duration
</span><a href="Text.ICalendar.Parser.Parameters.html#parseDuration"><span class="hs-identifier hs-var">parseDuration</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;DURATION&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155283"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155285"><span class="hs-identifier hs-var">dts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621679155282"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStartDate"><span class="hs-identifier hs-type">DTStartDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155276"><span id="local-6989586621679155277"><span id="local-6989586621679155278"><span id="local-6989586621679155279"><span id="local-6989586621679155280"><span class="annot"><a href="Text.ICalendar.Types.html#DurationDate"><span class="hs-identifier hs-type">DurationDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155278"><span class="hs-identifier hs-var">durHour</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155277"><span class="hs-identifier hs-var">durMinute</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155276"><span class="hs-identifier hs-var">durSecond</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStartDate"><span class="hs-identifier hs-type">DTStartDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DurationWeek"><span class="hs-identifier hs-type">DurationWeek</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStartDate"><span class="hs-identifier hs-type">DTStartDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>             </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DURATION must be in weeks or days when DTSTART \
                        \has VALUE DATE and not DATE-TIME.&quot;</span></span><span>
</span><span id="line-196"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">DurationProp
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DurationProp
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      DurationProp)
-&gt; (OtherParams -&gt; DurationProp)
-&gt; OtherParams
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration -&gt; OtherParams -&gt; DurationProp
</span><a href="Text.ICalendar.Types.html#DurationProp"><span class="hs-identifier hs-var">DurationProp</span></a></span><span> </span><span class="annot"><span class="annottext">Duration
</span><a href="#local-6989586621679155282"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      DurationProp)
-&gt; OtherParams
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155284"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseDurationProp"><span class="hs-identifier hs-var">parseDurationProp</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679155267"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155267"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      DurationProp)
-&gt; String
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DurationProp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseDurationProp: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRecurId"><span class="hs-identifier hs-type">parseRecurId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStart"><span class="hs-identifier hs-type">DTStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RecurrenceId"><span class="hs-identifier hs-type">RecurrenceId</span></a></span><span>
</span><span id="line-201"></span><span id="parseRecurId"><span class="annot"><span class="annottext">parseRecurId :: Maybe DTStart -&gt; Content -&gt; ContentParser RecurrenceId
</span><a href="Text.ICalendar.Parser.Properties.html#parseRecurId"><span class="hs-identifier hs-var hs-var">parseRecurId</span></a></span></span><span> </span><span id="local-6989586621679155265"><span class="annot"><span class="annottext">dts :: Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span id="local-6989586621679155264"><span class="annot"><span class="annottext">p :: SourcePos
</span><a href="#local-6989586621679155264"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-string">&quot;RECURRENCE-ID&quot;</span><span> </span><span id="local-6989586621679155263"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155263"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155262"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155262"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679155261"><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621679155261"><span class="hs-identifier hs-var">range'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Range)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Range)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Range
</span><a href="Text.ICalendar.Parser.Parameters.html#parseRange"><span class="hs-identifier hs-var">parseRange</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Range)
-&gt; (Text -&gt; CI Text)
-&gt; Text
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Range
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Range)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Range
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Range))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Range)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RANGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155263"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679155259"><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; OtherParams -&gt; RecurrenceId)
-&gt; (Date -&gt; OtherParams -&gt; RecurrenceId)
-&gt; Content
-&gt; ContentParser RecurrenceId
forall a.
(DateTime -&gt; OtherParams -&gt; a)
-&gt; (Date -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateOrDateTime"><span class="hs-identifier hs-var">parseSimpleDateOrDateTime</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
-&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621679155261"><span class="hs-identifier hs-var">range'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
 -&gt; OtherParams -&gt; RecurrenceId)
-&gt; (DateTime -&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
-&gt; DateTime
-&gt; OtherParams
-&gt; RecurrenceId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId
</span><a href="Text.ICalendar.Types.html#RecurrenceIdDateTime"><span class="hs-identifier hs-var">RecurrenceIdDateTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
-&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621679155261"><span class="hs-identifier hs-var">range'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
 -&gt; OtherParams -&gt; RecurrenceId)
-&gt; (Date -&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId)
-&gt; Date
-&gt; OtherParams
-&gt; RecurrenceId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Date -&gt; Maybe Range -&gt; OtherParams -&gt; RecurrenceId
</span><a href="Text.ICalendar.Types.html#RecurrenceIdDate"><span class="hs-identifier hs-var">RecurrenceIdDate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos
-&gt; CI Text -&gt; [(CI Text, [Text])] -&gt; ByteString -&gt; Content
</span><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-var">ContentLine</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679155264"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;RECURRENCE-ID&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="hs-string">&quot;RANGE&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155263"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155262"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-209"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStartDate"><span class="hs-identifier hs-type">DTStartDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RecurrenceIdDate"><span class="hs-identifier hs-type">RecurrenceIdDate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>             </span><span class="annot"><span class="annottext">RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-211"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStartDateTime"><span class="hs-identifier hs-type">DTStartDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dtStartDateTimeValue :: DTStart -&gt; DateTime
</span><a href="Text.ICalendar.Types.html#dtStartDateTimeValue"><span class="hs-identifier hs-var">dtStartDateTimeValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679155254"><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679155254"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>          </span><span class="annot"><a href="Text.ICalendar.Types.html#RecurrenceIdDateTime"><span class="hs-identifier hs-type">RecurrenceIdDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">recurrenceIdDateTime :: RecurrenceId -&gt; DateTime
</span><a href="Text.ICalendar.Types.html#recurrenceIdDateTime"><span class="hs-identifier hs-var">recurrenceIdDateTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679155252"><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679155252"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679155254"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679155252"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- TODO: Check this. iff confuse me.</span><span>
</span><span id="line-214"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-type">UTCDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#FloatingDateTime"><span class="hs-identifier hs-type">FloatingDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DTStart -&gt; RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a b a.
(MonadError String m, Show a, Show b) =&gt;
a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-215"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-type">UTCDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#ZonedDateTime"><span class="hs-identifier hs-type">ZonedDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DTStart -&gt; RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a b a.
(MonadError String m, Show a, Show b) =&gt;
a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-216"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#FloatingDateTime"><span class="hs-identifier hs-type">FloatingDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-type">UTCDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DTStart -&gt; RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a b a.
(MonadError String m, Show a, Show b) =&gt;
a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-217"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#ZonedDateTime"><span class="hs-identifier hs-type">ZonedDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-type">UTCDateTime</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DTStart -&gt; RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a b a.
(MonadError String m, Show a, Show b) =&gt;
a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-218"></span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-219"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DTStart -&gt; RecurrenceId -&gt; ContentParser RecurrenceId
forall (m :: * -&gt; *) a b a.
(MonadError String m, Show a, Show b) =&gt;
a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DTStart
</span><a href="#local-6989586621679155265"><span class="hs-identifier hs-var">dts</span></a></span><span> </span><span class="annot"><span class="annottext">RecurrenceId
</span><a href="#local-6989586621679155259"><span class="hs-identifier hs-var">recurid</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155249"><span class="annot"><span class="annottext">err :: a -&gt; b -&gt; m a
</span><a href="#local-6989586621679155249"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679155247"><span class="annot"><span class="annottext">d :: a
</span><a href="#local-6989586621679155247"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679155246"><span class="annot"><span class="annottext">r :: b
</span><a href="#local-6989586621679155246"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a) -&gt; String -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRecurId: DTSTART local time mismatch: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-221"></span><span>                                </span><span class="annot"><span class="annottext">(a, b) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155247"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679155246"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRecurId"><span class="hs-identifier hs-var">parseRecurId</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679155245"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155245"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RecurrenceId
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RecurrenceId)
-&gt; String -&gt; ContentParser RecurrenceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRecurId: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155245"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Parse time transparency. 3.8.2.7</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTransp"><span class="hs-identifier hs-type">parseTransp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#TimeTransparency"><span class="hs-identifier hs-type">TimeTransparency</span></a></span><span>
</span><span id="line-226"></span><span id="parseTransp"><span class="annot"><span class="annottext">parseTransp :: Content -&gt; ContentParser TimeTransparency
</span><a href="Text.ICalendar.Parser.Properties.html#parseTransp"><span class="hs-identifier hs-var hs-var">parseTransp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;TRANSP&quot;</span><span> </span><span id="local-6989586621679155243"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155243"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155242"><span class="annot"><span class="annottext">x :: ByteString
</span><a href="#local-6989586621679155242"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155242"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;OPAQUE&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeTransparency -&gt; ContentParser TimeTransparency
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TimeTransparency -&gt; ContentParser TimeTransparency)
-&gt; (OtherParams -&gt; TimeTransparency)
-&gt; OtherParams
-&gt; ContentParser TimeTransparency
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TimeTransparency
</span><a href="Text.ICalendar.Types.html#Opaque"><span class="hs-identifier hs-var">Opaque</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TimeTransparency)
-&gt; OtherParams -&gt; ContentParser TimeTransparency
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155243"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155242"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TRANSPARENT&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeTransparency -&gt; ContentParser TimeTransparency
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TimeTransparency -&gt; ContentParser TimeTransparency)
-&gt; (OtherParams -&gt; TimeTransparency)
-&gt; OtherParams
-&gt; ContentParser TimeTransparency
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TimeTransparency
</span><a href="Text.ICalendar.Types.html#Transparent"><span class="hs-identifier hs-var">Transparent</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TimeTransparency)
-&gt; OtherParams -&gt; ContentParser TimeTransparency
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155243"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTransp"><span class="hs-identifier hs-var">parseTransp</span></a></span><span> </span><span id="local-6989586621679155239"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155239"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser TimeTransparency
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser TimeTransparency)
-&gt; String -&gt; ContentParser TimeTransparency
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTransp: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155239"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Parse event status. 3.8.1.11</span><span>
</span><span id="line-232"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseEventStatus"><span class="hs-identifier hs-type">parseEventStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#EventStatus"><span class="hs-identifier hs-type">EventStatus</span></a></span><span>
</span><span id="line-233"></span><span id="parseEventStatus"><span class="annot"><span class="annottext">parseEventStatus :: Content -&gt; ContentParser EventStatus
</span><a href="Text.ICalendar.Parser.Properties.html#parseEventStatus"><span class="hs-identifier hs-var hs-var">parseEventStatus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;STATUS&quot;</span><span> </span><span id="local-6989586621679155237"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155237"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155236"><span class="annot"><span class="annottext">x :: ByteString
</span><a href="#local-6989586621679155236"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TENTATIVE&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventStatus -&gt; ContentParser EventStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(EventStatus -&gt; ContentParser EventStatus)
-&gt; (OtherParams -&gt; EventStatus)
-&gt; OtherParams
-&gt; ContentParser EventStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; EventStatus
</span><a href="Text.ICalendar.Types.html#TentativeEvent"><span class="hs-identifier hs-var">TentativeEvent</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser EventStatus)
-&gt; OtherParams -&gt; ContentParser EventStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155237"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CONFIRMED&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventStatus -&gt; ContentParser EventStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(EventStatus -&gt; ContentParser EventStatus)
-&gt; (OtherParams -&gt; EventStatus)
-&gt; OtherParams
-&gt; ContentParser EventStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; EventStatus
</span><a href="Text.ICalendar.Types.html#ConfirmedEvent"><span class="hs-identifier hs-var">ConfirmedEvent</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser EventStatus)
-&gt; OtherParams -&gt; ContentParser EventStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155237"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CANCELLED&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventStatus -&gt; ContentParser EventStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(EventStatus -&gt; ContentParser EventStatus)
-&gt; (OtherParams -&gt; EventStatus)
-&gt; OtherParams
-&gt; ContentParser EventStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; EventStatus
</span><a href="Text.ICalendar.Types.html#CancelledEvent"><span class="hs-identifier hs-var">CancelledEvent</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser EventStatus)
-&gt; OtherParams -&gt; ContentParser EventStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155237"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseEventStatus"><span class="hs-identifier hs-var">parseEventStatus</span></a></span><span> </span><span id="local-6989586621679155232"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155232"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser EventStatus
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser EventStatus)
-&gt; String -&gt; ContentParser EventStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseEventStatus: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155232"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Parse todo status. 3.8.1.11</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTodoStatus"><span class="hs-identifier hs-type">parseTodoStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#TodoStatus"><span class="hs-identifier hs-type">TodoStatus</span></a></span><span>
</span><span id="line-241"></span><span id="parseTodoStatus"><span class="annot"><span class="annottext">parseTodoStatus :: Content -&gt; ContentParser TodoStatus
</span><a href="Text.ICalendar.Parser.Properties.html#parseTodoStatus"><span class="hs-identifier hs-var hs-var">parseTodoStatus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;STATUS&quot;</span><span> </span><span id="local-6989586621679155230"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155230"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155229"><span class="annot"><span class="annottext">x :: ByteString
</span><a href="#local-6989586621679155229"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;NEEDS-ACTION&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TodoStatus -&gt; ContentParser TodoStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TodoStatus -&gt; ContentParser TodoStatus)
-&gt; (OtherParams -&gt; TodoStatus)
-&gt; OtherParams
-&gt; ContentParser TodoStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TodoStatus
</span><a href="Text.ICalendar.Types.html#TodoNeedsAction"><span class="hs-identifier hs-var">TodoNeedsAction</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TodoStatus)
-&gt; OtherParams -&gt; ContentParser TodoStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155230"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;COMPLETED&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TodoStatus -&gt; ContentParser TodoStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TodoStatus -&gt; ContentParser TodoStatus)
-&gt; (OtherParams -&gt; TodoStatus)
-&gt; OtherParams
-&gt; ContentParser TodoStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TodoStatus
</span><a href="Text.ICalendar.Types.html#CompletedTodo"><span class="hs-identifier hs-var">CompletedTodo</span></a></span><span>   </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TodoStatus)
-&gt; OtherParams -&gt; ContentParser TodoStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155230"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IN-PROCESS&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TodoStatus -&gt; ContentParser TodoStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TodoStatus -&gt; ContentParser TodoStatus)
-&gt; (OtherParams -&gt; TodoStatus)
-&gt; OtherParams
-&gt; ContentParser TodoStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TodoStatus
</span><a href="Text.ICalendar.Types.html#InProcessTodo"><span class="hs-identifier hs-var">InProcessTodo</span></a></span><span>   </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TodoStatus)
-&gt; OtherParams -&gt; ContentParser TodoStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155230"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CANCELLED&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TodoStatus -&gt; ContentParser TodoStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TodoStatus -&gt; ContentParser TodoStatus)
-&gt; (OtherParams -&gt; TodoStatus)
-&gt; OtherParams
-&gt; ContentParser TodoStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; TodoStatus
</span><a href="Text.ICalendar.Types.html#CancelledTodo"><span class="hs-identifier hs-var">CancelledTodo</span></a></span><span>   </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser TodoStatus)
-&gt; OtherParams -&gt; ContentParser TodoStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155230"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTodoStatus"><span class="hs-identifier hs-var">parseTodoStatus</span></a></span><span> </span><span id="local-6989586621679155224"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155224"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser TodoStatus
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser TodoStatus)
-&gt; String -&gt; ContentParser TodoStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTodoStatus: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155224"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Parse journal status. 3.8.1.11</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseJournalStatus"><span class="hs-identifier hs-type">parseJournalStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#JournalStatus"><span class="hs-identifier hs-type">JournalStatus</span></a></span><span>
</span><span id="line-250"></span><span id="parseJournalStatus"><span class="annot"><span class="annottext">parseJournalStatus :: Content -&gt; ContentParser JournalStatus
</span><a href="Text.ICalendar.Parser.Properties.html#parseJournalStatus"><span class="hs-identifier hs-var hs-var">parseJournalStatus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;STATUS&quot;</span><span> </span><span id="local-6989586621679155222"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155222"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155221"><span class="annot"><span class="annottext">x :: ByteString
</span><a href="#local-6989586621679155221"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155221"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DRAFT&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JournalStatus -&gt; ContentParser JournalStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(JournalStatus -&gt; ContentParser JournalStatus)
-&gt; (OtherParams -&gt; JournalStatus)
-&gt; OtherParams
-&gt; ContentParser JournalStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; JournalStatus
</span><a href="Text.ICalendar.Types.html#DraftJournal"><span class="hs-identifier hs-var">DraftJournal</span></a></span><span>     </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser JournalStatus)
-&gt; OtherParams -&gt; ContentParser JournalStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155222"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155221"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;FINAL&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JournalStatus -&gt; ContentParser JournalStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(JournalStatus -&gt; ContentParser JournalStatus)
-&gt; (OtherParams -&gt; JournalStatus)
-&gt; OtherParams
-&gt; ContentParser JournalStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; JournalStatus
</span><a href="Text.ICalendar.Types.html#FinalJournal"><span class="hs-identifier hs-var">FinalJournal</span></a></span><span>     </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser JournalStatus)
-&gt; OtherParams -&gt; ContentParser JournalStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155222"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155221"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; CI ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CANCELLED&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JournalStatus -&gt; ContentParser JournalStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(JournalStatus -&gt; ContentParser JournalStatus)
-&gt; (OtherParams -&gt; JournalStatus)
-&gt; OtherParams
-&gt; ContentParser JournalStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OtherParams -&gt; JournalStatus
</span><a href="Text.ICalendar.Types.html#CancelledJournal"><span class="hs-identifier hs-var">CancelledJournal</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser JournalStatus)
-&gt; OtherParams -&gt; ContentParser JournalStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155222"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseJournalStatus"><span class="hs-identifier hs-var">parseJournalStatus</span></a></span><span> </span><span id="local-6989586621679155217"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155217"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser JournalStatus
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser JournalStatus)
-&gt; String -&gt; ContentParser JournalStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseJournalStatus: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155217"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Parse organizer. 3.8.4.3</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseOrganizer"><span class="hs-identifier hs-type">parseOrganizer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Organizer"><span class="hs-identifier hs-type">Organizer</span></a></span><span>
</span><span id="line-258"></span><span id="parseOrganizer"><span class="annot"><span class="annottext">parseOrganizer :: Content -&gt; ContentParser Organizer
</span><a href="Text.ICalendar.Parser.Properties.html#parseOrganizer"><span class="hs-identifier hs-var hs-var">parseOrganizer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;ORGANIZER&quot;</span><span> </span><span id="local-6989586621679155215"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155214"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155214"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679155213"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679155213"><span class="hs-identifier hs-var">organizerValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
-&gt; ContentParser URI
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155214"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679155212"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155212"><span class="hs-identifier hs-var">organizerCN</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CN&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679155211"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679155211"><span class="hs-identifier hs-var">organizerDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser URI)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ContentParser URI
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DIR&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679155210"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679155210"><span class="hs-identifier hs-var">organizerSentBy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser URI)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; (Text -&gt; String) -&gt; Text -&gt; ContentParser URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser URI)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ContentParser URI
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe URI))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;SENT-BY&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679155209"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155209"><span class="hs-identifier hs-var">organizerLanguage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language)
-&gt; ([Text]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         Text)
-&gt; [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155208"><span class="annot"><span class="annottext">f :: a -&gt; Bool
</span><a href="#local-6989586621679155208"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679155207"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679155207"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;CN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;DIR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;SENT-BY&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>        </span><span id="local-6989586621679155206"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155206"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; Bool
forall a. (Eq a, IsString a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679155208"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155215"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">Organizer -&gt; ContentParser Organizer
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Organizer :: URI
-&gt; Maybe Text
-&gt; Maybe URI
-&gt; Maybe URI
-&gt; Maybe Language
-&gt; OtherParams
-&gt; Organizer
</span><a href="Text.ICalendar.Types.html#Organizer"><span class="hs-identifier hs-type hs-type">Organizer</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">organizerOther :: OtherParams
</span><a href="Text.ICalendar.Types.html#organizerOther"><span class="hs-identifier hs-var">organizerOther</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155206"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseOrganizer"><span class="hs-identifier hs-var">parseOrganizer</span></a></span><span> </span><span id="local-6989586621679155197"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155197"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Organizer
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Organizer)
-&gt; String -&gt; ContentParser Organizer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseOrganizer: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155197"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Parse geographic position. 3.8.1.6</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseGeo"><span class="hs-identifier hs-type">parseGeo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Geo"><span class="hs-identifier hs-type">Geo</span></a></span><span>
</span><span id="line-273"></span><span id="parseGeo"><span class="annot"><span class="annottext">parseGeo :: Content -&gt; ContentParser Geo
</span><a href="Text.ICalendar.Parser.Properties.html#parseGeo"><span class="hs-identifier hs-var hs-var">parseGeo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;GEO&quot;</span><span> </span><span id="local-6989586621679155195"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155195"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155194"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155194"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155193"><span class="annot"><span class="annottext">lat' :: ByteString
</span><a href="#local-6989586621679155193"><span class="hs-identifier hs-var">lat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155192"><span class="annot"><span class="annottext">long' :: ByteString
</span><a href="#local-6989586621679155192"><span class="hs-identifier hs-var">long'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155194"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621679155191"><span class="annot"><span class="annottext">lat :: Maybe Float
</span><a href="#local-6989586621679155191"><span class="hs-identifier hs-var hs-var">lat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Float
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Float)
-&gt; (String -&gt; String) -&gt; String -&gt; Maybe Float
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679155190"><span class="hs-identifier hs-var">stripPlus</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Float) -&gt; String -&gt; Maybe Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155193"><span class="hs-identifier hs-var">lat'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-276"></span><span>        </span><span id="local-6989586621679155189"><span class="annot"><span class="annottext">long :: Maybe Float
</span><a href="#local-6989586621679155189"><span class="hs-identifier hs-var hs-var">long</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Float
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Float)
-&gt; (ByteString -&gt; String) -&gt; ByteString -&gt; Maybe Float
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679155190"><span class="hs-identifier hs-var">stripPlus</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String)
-&gt; (ByteString -&gt; String) -&gt; ByteString -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe Float) -&gt; ByteString -&gt; Maybe Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.tail</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155192"><span class="hs-identifier hs-var">long'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155192"><span class="hs-identifier hs-var">long'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe Float -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Float
</span><a href="#local-6989586621679155191"><span class="hs-identifier hs-var">lat</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Float -&gt; Maybe Float -&gt; Maybe Float
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Float
</span><a href="#local-6989586621679155189"><span class="hs-identifier hs-var">long</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Invalid latitude/longitude: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155194"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">Geo -&gt; ContentParser Geo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Geo -&gt; ContentParser Geo) -&gt; Geo -&gt; ContentParser Geo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; OtherParams -&gt; Geo
</span><a href="Text.ICalendar.Types.html#Geo"><span class="hs-identifier hs-var">Geo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Float -&gt; Float
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Float
</span><a href="#local-6989586621679155191"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Float -&gt; Float
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Float
</span><a href="#local-6989586621679155189"><span class="hs-identifier hs-var">long</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155195"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155190"><span class="annot"><span class="annottext">stripPlus :: String -&gt; String
</span><a href="#local-6989586621679155190"><span class="hs-identifier hs-var hs-var">stripPlus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-char">'+'</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155186"><span class="annot"><span class="annottext">xs :: String
</span><a href="#local-6989586621679155186"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155186"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><a href="#local-6989586621679155190"><span class="hs-identifier hs-var">stripPlus</span></a></span><span> </span><span id="local-6989586621679155185"><span class="annot"><span class="annottext">xs :: String
</span><a href="#local-6989586621679155185"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155185"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseGeo"><span class="hs-identifier hs-var">parseGeo</span></a></span><span> </span><span id="local-6989586621679155184"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155184"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Geo
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Geo) -&gt; String -&gt; ContentParser Geo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseGeo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155184"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Parse classification. 3.8.1.3</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseClass"><span class="hs-identifier hs-type">parseClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Class"><span class="hs-identifier hs-type">Class</span></a></span><span>
</span><span id="line-286"></span><span id="parseClass"><span class="annot"><span class="annottext">parseClass :: Content -&gt; ContentParser Class
</span><a href="Text.ICalendar.Parser.Properties.html#parseClass"><span class="hs-identifier hs-var hs-var">parseClass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;CLASS&quot;</span><span> </span><span id="local-6989586621679155182"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155182"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155181"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155181"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679155180"><span class="annot"><span class="annottext">ByteString -&gt; CI Text
</span><a href="#local-6989586621679155180"><span class="hs-identifier hs-var">iconv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; ByteString -&gt; CI Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (ByteString -&gt; CI Text)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; CI Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2IText"><span class="hs-identifier hs-var hs-var">dfBS2IText</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Class -&gt; ContentParser Class
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Class -&gt; ContentParser Class)
-&gt; (ClassValue -&gt; Class) -&gt; ClassValue -&gt; ContentParser Class
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ClassValue -&gt; OtherParams -&gt; Class)
-&gt; OtherParams -&gt; ClassValue -&gt; Class
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ClassValue -&gt; OtherParams -&gt; Class
</span><a href="Text.ICalendar.Types.html#Class"><span class="hs-identifier hs-var">Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155182"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ClassValue -&gt; ContentParser Class)
-&gt; ClassValue -&gt; ContentParser Class
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI Text
</span><a href="#local-6989586621679155180"><span class="hs-identifier hs-var">iconv</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155181"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>             </span><span class="hs-string">&quot;PUBLIC&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClassValue
</span><a href="Text.ICalendar.Types.html#Public"><span class="hs-identifier hs-var">Public</span></a></span><span>
</span><span id="line-291"></span><span>             </span><span class="hs-string">&quot;PRIVATE&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClassValue
</span><a href="Text.ICalendar.Types.html#Private"><span class="hs-identifier hs-var">Private</span></a></span><span>
</span><span id="line-292"></span><span>             </span><span class="hs-string">&quot;CONFIDENTIAL&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClassValue
</span><a href="Text.ICalendar.Types.html#Confidential"><span class="hs-identifier hs-var">Confidential</span></a></span><span>
</span><span id="line-293"></span><span>             </span><span id="local-6989586621679155173"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679155173"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; ClassValue
</span><a href="Text.ICalendar.Types.html#ClassValueX"><span class="hs-identifier hs-var">ClassValueX</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155173"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseClass"><span class="hs-identifier hs-var">parseClass</span></a></span><span> </span><span id="local-6989586621679155171"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155171"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Class
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Class) -&gt; String -&gt; ContentParser Class
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseClass: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155171"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Parse TZName. 3.8.3.1</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTZName"><span class="hs-identifier hs-type">parseTZName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#TZName"><span class="hs-identifier hs-type">TZName</span></a></span><span>
</span><span id="line-298"></span><span id="parseTZName"><span class="annot"><span class="annottext">parseTZName :: Content -&gt; ContentParser TZName
</span><a href="Text.ICalendar.Parser.Properties.html#parseTZName"><span class="hs-identifier hs-var hs-var">parseTZName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;TZNAME&quot;</span><span> </span><span id="local-6989586621679155169"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155169"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155168"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155168"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679155167"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155167"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155168"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679155166"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155166"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language) -&gt; Maybe [Text] -&gt; Maybe [Language]
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155169"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">TZName -&gt; ContentParser TZName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TZName -&gt; ContentParser TZName) -&gt; TZName -&gt; ContentParser TZName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Language -&gt; OtherParams -&gt; TZName
</span><a href="Text.ICalendar.Types.html#TZName"><span class="hs-identifier hs-var">TZName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155167"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679155166"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155169"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTZName"><span class="hs-identifier hs-var">parseTZName</span></a></span><span> </span><span id="local-6989586621679155164"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155164"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser TZName
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser TZName) -&gt; String -&gt; ContentParser TZName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTZName: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155164"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Parse a VERSION property 3.7.4</span><span>
</span><span id="line-306"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseVersion"><span class="hs-identifier hs-type">parseVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#ICalVersion"><span class="hs-identifier hs-type">ICalVersion</span></a></span><span>
</span><span id="line-307"></span><span id="parseVersion"><span class="annot"><span class="annottext">parseVersion :: Content -&gt; ContentParser ICalVersion
</span><a href="Text.ICalendar.Parser.Properties.html#parseVersion"><span class="hs-identifier hs-var hs-var">parseVersion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;VERSION&quot;</span><span> </span><span id="local-6989586621679155162"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155162"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155161"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155161"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679155160"><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679155160"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (ByteString -&gt; Text)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155159"><span class="annot"><span class="annottext">maxver' :: String
</span><a href="#local-6989586621679155159"><span class="hs-identifier hs-var">maxver'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155158"><span class="annot"><span class="annottext">minver'' :: String
</span><a href="#local-6989586621679155158"><span class="hs-identifier hs-var">minver''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String))
-&gt; (Text -&gt; String) -&gt; Text -&gt; (String, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (String, String)) -&gt; Text -&gt; (String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679155160"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155161"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span id="local-6989586621679155156"><span class="annot"><span class="annottext">minver' :: String
</span><a href="#local-6989586621679155156"><span class="hs-identifier hs-var hs-var">minver'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155158"><span class="hs-identifier hs-var">minver''</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span id="local-6989586621679155154"><span class="annot"><span class="annottext">parseVer :: String -&gt; Maybe Version
</span><a href="#local-6989586621679155154"><span class="hs-identifier hs-var hs-var">parseVer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Version, String) -&gt; Version
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Version, String) -&gt; Version)
-&gt; (String -&gt; Maybe (Version, String)) -&gt; String -&gt; Maybe Version
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Version, String)] -&gt; Maybe (Version, String)
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([(Version, String)] -&gt; Maybe (Version, String))
-&gt; (String -&gt; [(Version, String)])
-&gt; String
-&gt; Maybe (Version, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Version, String) -&gt; Bool)
-&gt; [(Version, String)] -&gt; [(Version, String)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; ((Version, String) -&gt; String) -&gt; (Version, String) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Version, String) -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                                       </span><span class="annot"><span class="annottext">([(Version, String)] -&gt; [(Version, String)])
-&gt; (String -&gt; [(Version, String)]) -&gt; String -&gt; [(Version, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReadP Version -&gt; String -&gt; [(Version, String)]
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readP_to_S</span></span><span> </span><span class="annot"><span class="annottext">ReadP Version
</span><span class="hs-identifier hs-var">Ver.parseVersion</span></span><span>
</span><span id="line-313"></span><span>        </span><span id="local-6989586621679155151"><span class="annot"><span class="annottext">maxver :: Maybe Version
</span><a href="#local-6989586621679155151"><span class="hs-identifier hs-var hs-var">maxver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Version
</span><a href="#local-6989586621679155154"><span class="hs-identifier hs-var">parseVer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155159"><span class="hs-identifier hs-var">maxver'</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679155150"><span class="annot"><span class="annottext">minver :: Maybe Version
</span><a href="#local-6989586621679155150"><span class="hs-identifier hs-var hs-var">minver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Version
</span><a href="#local-6989586621679155154"><span class="hs-identifier hs-var">parseVer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155156"><span class="hs-identifier hs-var">minver'</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679155149"><span class="annot"><span class="annottext">maxJ :: Version
</span><a href="#local-6989586621679155149"><span class="hs-identifier hs-var">maxJ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155148"><span class="annot"><span class="annottext">minJ :: Version
</span><a href="#local-6989586621679155148"><span class="hs-identifier hs-var">minJ</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Version -&gt; Version
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Version -&gt; Version) -&gt; [Maybe Version] -&gt; [Version]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Version
</span><a href="#local-6989586621679155151"><span class="hs-identifier hs-var">maxver</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Version
</span><a href="#local-6989586621679155150"><span class="hs-identifier hs-var">minver</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Version -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Version
</span><a href="#local-6989586621679155151"><span class="hs-identifier hs-var">maxver</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-317"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseVersion: error parsing version: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155159"><span class="hs-identifier hs-var">maxver'</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155158"><span class="hs-identifier hs-var">minver''</span></a></span><span>
</span><span id="line-319"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ICalVersion -&gt; ContentParser ICalVersion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ICalVersion -&gt; ContentParser ICalVersion)
-&gt; ICalVersion -&gt; ContentParser ICalVersion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; OtherParams -&gt; ICalVersion
</span><a href="Text.ICalendar.Types.html#MaxICalVersion"><span class="hs-identifier hs-var">MaxICalVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679155149"><span class="hs-identifier hs-var">maxJ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155162"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Version -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Version
</span><a href="#local-6989586621679155150"><span class="hs-identifier hs-var">minver</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-321"></span><span>                    </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseVersion: error parsing version: &quot;</span></span><span>
</span><span id="line-322"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155156"><span class="hs-identifier hs-var">minver'</span></a></span><span>
</span><span id="line-323"></span><span>               </span><span class="annot"><span class="annottext">ICalVersion -&gt; ContentParser ICalVersion
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ICalVersion -&gt; ContentParser ICalVersion)
-&gt; ICalVersion -&gt; ContentParser ICalVersion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; OtherParams -&gt; ICalVersion
</span><a href="Text.ICalendar.Types.html#MinMaxICalVersion"><span class="hs-identifier hs-var">MinMaxICalVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679155149"><span class="hs-identifier hs-var">maxJ</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679155148"><span class="hs-identifier hs-var">minJ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155162"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseVersion"><span class="hs-identifier hs-var">parseVersion</span></a></span><span> </span><span id="local-6989586621679155144"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155144"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser ICalVersion
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser ICalVersion)
-&gt; String -&gt; ContentParser ICalVersion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseVersion: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155144"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Parse a TZID property. 3.8.3.1</span><span>
</span><span id="line-327"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTZID"><span class="hs-identifier hs-type">parseTZID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#TZID"><span class="hs-identifier hs-type">TZID</span></a></span><span>
</span><span id="line-328"></span><span id="parseTZID"><span class="annot"><span class="annottext">parseTZID :: Content -&gt; ContentParser TZID
</span><a href="Text.ICalendar.Parser.Properties.html#parseTZID"><span class="hs-identifier hs-var hs-var">parseTZID</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;TZID&quot;</span><span> </span><span id="local-6989586621679155142"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155142"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155141"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155141"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679155140"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155140"><span class="hs-identifier hs-var">tzidValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; Text)
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((DecodingFunctions -&gt; Text)
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; (DecodingFunctions -&gt; Text)
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155141"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155139"><span class="annot"><span class="annottext">tzidGlobal :: Bool
</span><a href="#local-6989586621679155139"><span class="hs-identifier hs-var hs-var">tzidGlobal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char, Text) -&gt; Char
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Char, Text) -&gt; Char) -&gt; Maybe (Char, Text) -&gt; Maybe Char
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">T.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155140"><span class="hs-identifier hs-var">tzidValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Char -&gt; Maybe Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span>
</span><span id="line-331"></span><span>        </span><span id="local-6989586621679155137"><span class="annot"><span class="annottext">tzidOther :: OtherParams
</span><a href="#local-6989586621679155137"><span class="hs-identifier hs-var hs-var">tzidOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155142"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">TZID -&gt; ContentParser TZID
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TZID :: Text -&gt; Bool -&gt; OtherParams -&gt; TZID
</span><a href="Text.ICalendar.Types.html#TZID"><span class="hs-identifier hs-type hs-type">TZID</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseTZID"><span class="hs-identifier hs-var">parseTZID</span></a></span><span> </span><span id="local-6989586621679155131"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155131"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser TZID
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser TZID) -&gt; String -&gt; ContentParser TZID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseTZID: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155131"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Parse RRule. 3.8.5.3</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRRule"><span class="hs-identifier hs-type">parseRRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DTStart"><span class="hs-identifier hs-type">DTStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RRule"><span class="hs-identifier hs-type">RRule</span></a></span><span>
</span><span id="line-337"></span><span id="parseRRule"><span class="annot"><span class="annottext">parseRRule :: Maybe DTStart -&gt; Content -&gt; ContentParser RRule
</span><a href="Text.ICalendar.Parser.Properties.html#parseRRule"><span class="hs-identifier hs-var hs-var">parseRRule</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RRule
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRRule: missing DTSTART.&quot;</span></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRRule"><span class="hs-identifier hs-var">parseRRule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679155129"><span class="annot"><span class="annottext">dts :: DTStart
</span><a href="#local-6989586621679155129"><span class="hs-identifier hs-var">dts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;RRULE&quot;</span><span> </span><span id="local-6989586621679155128"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155128"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155127"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155127"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parsec ByteString DecodingFunctions (ContentParser Recur)
-&gt; DecodingFunctions
-&gt; String
-&gt; ByteString
-&gt; Either ParseError (ContentParser Recur)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; String -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTStart
-&gt; Parsec ByteString DecodingFunctions (ContentParser Recur)
</span><a href="Text.ICalendar.Parser.Parameters.html#parseRecur"><span class="hs-identifier hs-var">parseRecur</span></a></span><span> </span><span class="annot"><span class="annottext">DTStart
</span><a href="#local-6989586621679155129"><span class="hs-identifier hs-var">dts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DecodingFunctions
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="hs-string">&quot;RRULE&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155127"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679155124"><span class="annot"><span class="annottext">e :: ParseError
</span><a href="#local-6989586621679155124"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RRule
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RRule) -&gt; String -&gt; ContentParser RRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679155124"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-341"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679155123"><span class="annot"><span class="annottext">x :: ContentParser Recur
</span><a href="#local-6989586621679155123"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679155122"><span class="annot"><span class="annottext">Recur
</span><a href="#local-6989586621679155122"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContentParser Recur
</span><a href="#local-6989586621679155123"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-342"></span><span>                       </span><span class="annot"><span class="annottext">RRule -&gt; ContentParser RRule
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RRule -&gt; ContentParser RRule)
-&gt; (OtherParams -&gt; RRule) -&gt; OtherParams -&gt; ContentParser RRule
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Recur -&gt; OtherParams -&gt; RRule
</span><a href="Text.ICalendar.Types.html#RRule"><span class="hs-identifier hs-var">RRule</span></a></span><span> </span><span class="annot"><span class="annottext">Recur
</span><a href="#local-6989586621679155122"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser RRule)
-&gt; OtherParams -&gt; ContentParser RRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155128"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRRule"><span class="hs-identifier hs-var">parseRRule</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679155120"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155120"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RRule
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RRule) -&gt; String -&gt; ContentParser RRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRRule: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155120"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | Parse Created, 3.8.7.3</span><span>
</span><span id="line-346"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseCreated"><span class="hs-identifier hs-type">parseCreated</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Created"><span class="hs-identifier hs-type">Created</span></a></span><span>
</span><span id="line-347"></span><span id="parseCreated"><span class="annot"><span class="annottext">parseCreated :: Content -&gt; ContentParser Created
</span><a href="Text.ICalendar.Parser.Properties.html#parseCreated"><span class="hs-identifier hs-var hs-var">parseCreated</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;CREATED&quot;</span><span> </span><span id="local-6989586621679155118"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155118"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155117"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155117"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679155116"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679155116"><span class="hs-identifier hs-var">createdValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; ContentParser UTCTime
</span><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var">mustBeUTC</span></a></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; ContentParser UTCTime)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
-&gt; ContentParser UTCTime
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155117"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155115"><span class="annot"><span class="annottext">createdOther :: OtherParams
</span><a href="#local-6989586621679155115"><span class="hs-identifier hs-var hs-var">createdOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155118"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><span class="annottext">Created -&gt; ContentParser Created
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Created :: UTCTime -&gt; OtherParams -&gt; Created
</span><a href="Text.ICalendar.Types.html#Created"><span class="hs-identifier hs-type hs-type">Created</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseCreated"><span class="hs-identifier hs-var">parseCreated</span></a></span><span> </span><span id="local-6989586621679155110"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155110"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Created
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser Created)
-&gt; String -&gt; ContentParser Created
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseCreated: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155110"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Parse Last Modified, 3.8.7.3</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseLastModified"><span class="hs-identifier hs-type">parseLastModified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#LastModified"><span class="hs-identifier hs-type">LastModified</span></a></span><span>
</span><span id="line-355"></span><span id="parseLastModified"><span class="annot"><span class="annottext">parseLastModified :: Content -&gt; ContentParser LastModified
</span><a href="Text.ICalendar.Parser.Properties.html#parseLastModified"><span class="hs-identifier hs-var hs-var">parseLastModified</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;LAST-MODIFIED&quot;</span><span> </span><span id="local-6989586621679155108"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155108"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155107"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155107"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679155106"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679155106"><span class="hs-identifier hs-var">lastModifiedValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; ContentParser UTCTime
</span><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var">mustBeUTC</span></a></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; ContentParser UTCTime)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
-&gt; ContentParser UTCTime
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155107"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155105"><span class="annot"><span class="annottext">lastModifiedOther :: OtherParams
</span><a href="#local-6989586621679155105"><span class="hs-identifier hs-var hs-var">lastModifiedOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155108"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><span class="annottext">LastModified -&gt; ContentParser LastModified
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LastModified :: UTCTime -&gt; OtherParams -&gt; LastModified
</span><a href="Text.ICalendar.Types.html#LastModified"><span class="hs-identifier hs-type hs-type">LastModified</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseLastModified"><span class="hs-identifier hs-var">parseLastModified</span></a></span><span> </span><span id="local-6989586621679155100"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155100"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser LastModified
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser LastModified)
-&gt; String -&gt; ContentParser LastModified
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseLastModified: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155100"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | Parse an RDate</span><span>
</span><span id="line-362"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRDate"><span class="hs-identifier hs-type">parseRDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#RDate"><span class="hs-identifier hs-type">RDate</span></a></span><span>
</span><span id="line-363"></span><span id="parseRDate"><span class="annot"><span class="annottext">parseRDate :: Content -&gt; ContentParser RDate
</span><a href="Text.ICalendar.Parser.Properties.html#parseRDate"><span class="hs-identifier hs-var hs-var">parseRDate</span></a></span></span><span> </span><span id="local-6989586621679155098"><span class="annot"><span class="annottext">c :: Content
</span><a href="#local-6989586621679155098"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;RDATE&quot;</span><span> </span><span id="local-6989586621679155097"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155097"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155096"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155096"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679155095"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155095"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; (Maybe [Text] -&gt; [Text])
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe [Text] -&gt; [Text]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;DATE-TIME&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155097"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679155095"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>         </span><span class="hs-string">&quot;PERIOD&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>             </span><span id="local-6989586621679155094"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155094"><span class="hs-identifier hs-var">tzid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155097"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-368"></span><span>             </span><span id="local-6989586621679155093"><span class="annot"><span class="annottext">Set Period
</span><a href="#local-6989586621679155093"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Period] -&gt; Set Period
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Period] -&gt; Set Period)
-&gt; ([ByteString]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [Period])
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set Period)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Period)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Period]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
-&gt; ByteString
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Period
</span><a href="Text.ICalendar.Parser.Parameters.html#parsePeriod"><span class="hs-identifier hs-var">parsePeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679155094"><span class="hs-identifier hs-var">tzid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set Period))
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set Period)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155096"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-369"></span><span>             </span><span class="annot"><span class="annottext">RDate -&gt; ContentParser RDate
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RDate -&gt; ContentParser RDate)
-&gt; ([(CI Text, [Text])] -&gt; RDate)
-&gt; [(CI Text, [Text])]
-&gt; ContentParser RDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set Period -&gt; OtherParams -&gt; RDate
</span><a href="Text.ICalendar.Types.html#RDatePeriods"><span class="hs-identifier hs-var">RDatePeriods</span></a></span><span> </span><span class="annot"><span class="annottext">Set Period
</span><a href="#local-6989586621679155093"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; RDate)
-&gt; ([(CI Text, [Text])] -&gt; OtherParams)
-&gt; [(CI Text, [Text])]
-&gt; RDate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">([(CI Text, [Text])] -&gt; ContentParser RDate)
-&gt; [(CI Text, [Text])] -&gt; ContentParser RDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-370"></span><span>                </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; [CI Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155097"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-371"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Set DateTime -&gt; OtherParams -&gt; RDate)
-&gt; (Set Date -&gt; OtherParams -&gt; RDate)
-&gt; Content
-&gt; ContentParser RDate
forall a.
(Set DateTime -&gt; OtherParams -&gt; a)
-&gt; (Set Date -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDatesOrDateTimes"><span class="hs-identifier hs-var">parseSimpleDatesOrDateTimes</span></a></span><span> </span><span class="annot"><span class="annottext">Set DateTime -&gt; OtherParams -&gt; RDate
</span><a href="Text.ICalendar.Types.html#RDateDateTimes"><span class="hs-identifier hs-var">RDateDateTimes</span></a></span><span> </span><span class="annot"><span class="annottext">Set Date -&gt; OtherParams -&gt; RDate
</span><a href="Text.ICalendar.Types.html#RDateDates"><span class="hs-identifier hs-var">RDateDates</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155098"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-372"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseRDate"><span class="hs-identifier hs-var">parseRDate</span></a></span><span> </span><span id="local-6989586621679155087"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155087"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser RDate
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser RDate) -&gt; String -&gt; ContentParser RDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseRDate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155087"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | Parse a UTC Offset property 3.3.14, 3.8.3.4, and 3.8.3.3</span><span>
</span><span id="line-375"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseUTCOffset"><span class="hs-identifier hs-type">parseUTCOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#UTCOffset"><span class="hs-identifier hs-type">UTCOffset</span></a></span><span>
</span><span id="line-376"></span><span id="parseUTCOffset"><span class="annot"><span class="annottext">parseUTCOffset :: Content -&gt; ContentParser UTCOffset
</span><a href="Text.ICalendar.Parser.Properties.html#parseUTCOffset"><span class="hs-identifier hs-var hs-var">parseUTCOffset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679155085"><span class="annot"><span class="annottext">n :: CI Text
</span><a href="#local-6989586621679155085"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679155084"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679155084"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679155083"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155083"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679155085"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [CI Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;TZOFFSETTO&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;TZOFFSETFROM&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155081"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679155081"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155083"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679155080"><span class="annot"><span class="annottext">s :: Char
</span><a href="#local-6989586621679155080"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155079"><span class="annot"><span class="annottext">rest :: String
</span><a href="#local-6989586621679155079"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155081"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679155078"><span class="annot"><span class="annottext">t1 :: Int
</span><a href="#local-6989586621679155078"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155077"><span class="annot"><span class="annottext">t2 :: Int
</span><a href="#local-6989586621679155077"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155076"><span class="annot"><span class="annottext">m1 :: Int
</span><a href="#local-6989586621679155076"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155075"><span class="annot"><span class="annottext">m2 :: Int
</span><a href="#local-6989586621679155075"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155074"><span class="annot"><span class="annottext">sec :: [Int]
</span><a href="#local-6989586621679155074"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; String -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155079"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679155072"><span class="annot"><span class="annottext">s1 :: Int
</span><a href="#local-6989586621679155072"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679155071"><span class="annot"><span class="annottext">s2 :: Int
</span><a href="#local-6989586621679155071"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679155074"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span id="local-6989586621679155070"><span class="annot"><span class="annottext">sign :: p -&gt; p
</span><a href="#local-6989586621679155070"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679155069"><span class="annot"><span class="annottext">x :: p
</span><a href="#local-6989586621679155069"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679155080"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p -&gt; p
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679155069"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679155069"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155081"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155079"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679155080"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'+'</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-char">'-'</span></span><span class="hs-special">]</span><span>
</span><span id="line-384"></span><span>                         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679155074"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseUTCOffset: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679155081"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">UTCOffset -&gt; ContentParser UTCOffset
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(UTCOffset -&gt; ContentParser UTCOffset)
-&gt; (OtherParams -&gt; UTCOffset)
-&gt; OtherParams
-&gt; ContentParser UTCOffset
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; OtherParams -&gt; UTCOffset
</span><a href="Text.ICalendar.Types.html#UTCOffset"><span class="hs-identifier hs-var">UTCOffset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><a href="#local-6989586621679155070"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155078"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155077"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155076"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155075"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-387"></span><span>                                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679155074"><span class="hs-identifier hs-var">sec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155072"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679155071"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>                       </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser UTCOffset)
-&gt; OtherParams -&gt; ContentParser UTCOffset
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679155084"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Text.ICalendar.Parser.Properties.html#parseUTCOffset"><span class="hs-identifier hs-var">parseUTCOffset</span></a></span><span> </span><span id="local-6989586621679155060"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679155060"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser UTCOffset
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser UTCOffset)
-&gt; String -&gt; ContentParser UTCOffset
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseUTCOffset: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679155060"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-392"></span></pre></body></html>