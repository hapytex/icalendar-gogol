<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_IZDkafvT6bo9C5HInft9eF"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.ICalendar.Parser.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Error</span></span><span>          </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.RWS</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>                                               </span><span class="annot"><span class="hs-identifier">MonadWriter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RWS</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>                                               </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Builder</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bu</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CI</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Encoding</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Day</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LocalTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LocalTime</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                                               </span><span class="annot"><span class="hs-identifier">TimeOfDay</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Time</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.URI</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">URI</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                      </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_time(1,5,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Locale</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">defaultTimeLocale</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Parsec.Combinator</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">optional</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Parsec.Prim</span></span><span>       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html"><span class="hs-identifier">Text.ICalendar.Types</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Content lines, separated into components. 3.1.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">data</span><span> </span><span id="Content"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-var">Content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ContentLine"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-var">ContentLine</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.SourcePos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-48"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Component"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Component"><span class="hs-identifier hs-var">Component</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.SourcePos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154469"><span id="local-6989586621679154471"><span id="local-6989586621679154473"><span class="annot"><span class="annottext">Int -&gt; Content -&gt; ShowS
[Content] -&gt; ShowS
Content -&gt; String
(Int -&gt; Content -&gt; ShowS)
-&gt; (Content -&gt; String) -&gt; ([Content] -&gt; ShowS) -&gt; Show Content
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Content] -&gt; ShowS
$cshowList :: [Content] -&gt; ShowS
show :: Content -&gt; String
$cshow :: Content -&gt; String
showsPrec :: Int -&gt; Content -&gt; ShowS
$cshowsPrec :: Int -&gt; Content -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154464"><span id="local-6989586621679154466"><span class="annot"><span class="annottext">Content -&gt; Content -&gt; Bool
(Content -&gt; Content -&gt; Bool)
-&gt; (Content -&gt; Content -&gt; Bool) -&gt; Eq Content
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Content -&gt; Content -&gt; Bool
$c/= :: Content -&gt; Content -&gt; Bool
== :: Content -&gt; Content -&gt; Bool
$c== :: Content -&gt; Content -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154448"><span id="local-6989586621679154450"><span id="local-6989586621679154452"><span id="local-6989586621679154454"><span id="local-6989586621679154456"><span id="local-6989586621679154458"><span id="local-6989586621679154460"><span class="annot"><span class="annottext">Eq Content
Eq Content =&gt;
(Content -&gt; Content -&gt; Ordering)
-&gt; (Content -&gt; Content -&gt; Bool)
-&gt; (Content -&gt; Content -&gt; Bool)
-&gt; (Content -&gt; Content -&gt; Bool)
-&gt; (Content -&gt; Content -&gt; Bool)
-&gt; (Content -&gt; Content -&gt; Content)
-&gt; (Content -&gt; Content -&gt; Content)
-&gt; Ord Content
Content -&gt; Content -&gt; Bool
Content -&gt; Content -&gt; Ordering
Content -&gt; Content -&gt; Content
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Content -&gt; Content -&gt; Content
$cmin :: Content -&gt; Content -&gt; Content
max :: Content -&gt; Content -&gt; Content
$cmax :: Content -&gt; Content -&gt; Content
&gt;= :: Content -&gt; Content -&gt; Bool
$c&gt;= :: Content -&gt; Content -&gt; Bool
&gt; :: Content -&gt; Content -&gt; Bool
$c&gt; :: Content -&gt; Content -&gt; Bool
&lt;= :: Content -&gt; Content -&gt; Bool
$c&lt;= :: Content -&gt; Content -&gt; Bool
&lt; :: Content -&gt; Content -&gt; Bool
$c&lt; :: Content -&gt; Content -&gt; Bool
compare :: Content -&gt; Content -&gt; Ordering
$ccompare :: Content -&gt; Content -&gt; Ordering
$cp1Ord :: Eq Content
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="TextParser"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#TextParser"><span class="hs-identifier hs-var">TextParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-type">DecodingFunctions</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="ContentParser"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-var">ContentParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ErrorT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- Fatal errors.</span><span>
</span><span id="line-54"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RWS</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-type">DecodingFunctions</span></a></span><span>
</span><span id="line-55"></span><span>                                 </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Warnings.</span><span>
</span><span id="line-56"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.SourcePos</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Functions for decoding 'ByteString's into 'Text'.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="DecodingFunctions"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-var">DecodingFunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DecodingFunctions"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-var">DecodingFunctions</span></a></span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="dfBS2Text"><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="dfBS2IText"><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; CI Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2IText"><span class="hs-identifier hs-var hs-var">dfBS2IText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | UTF8.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-type">DecodingFunctions</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679154441"><span class="annot"><span class="annottext">def :: DecodingFunctions
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ByteString -&gt; CI Text) -&gt; DecodingFunctions
</span><a href="Text.ICalendar.Parser.Common.html#DecodingFunctions"><span class="hs-identifier hs-var">DecodingFunctions</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; CI Text) -&gt; (ByteString -&gt; Text) -&gt; ByteString -&gt; CI Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Parse text. 3.3.11</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseText%27"><span class="hs-identifier hs-type">parseText'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span id="parseText%27"><span class="annot"><span class="annottext">parseText' :: ByteString -&gt; ContentParser ([Text], ByteString)
</span><a href="Text.ICalendar.Parser.Common.html#parseText%27"><span class="hs-identifier hs-var hs-var">parseText'</span></a></span></span><span> </span><span id="local-6989586621679154435"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154435"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154434"><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679154434"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (ByteString -&gt; Text)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span>
</span><span id="line-71"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parsec ByteString () ([Builder], ByteString)
-&gt; ()
-&gt; String
-&gt; ByteString
-&gt; Either ParseError ([Builder], ByteString)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; String -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; ByteString -&gt; ([Builder], ByteString))
-&gt; ParsecT ByteString () Identity [Builder]
-&gt; ParsecT
     ByteString () Identity (ByteString -&gt; ([Builder], ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString () Identity [Builder]
forall u. ParsecT ByteString u Identity [Builder]
</span><a href="#local-6989586621679154431"><span class="hs-identifier hs-var">texts</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  ByteString () Identity (ByteString -&gt; ([Builder], ByteString))
-&gt; ParsecT ByteString () Identity ByteString
-&gt; Parsec ByteString () ([Builder], ByteString)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString () Identity ByteString
forall (m :: * -&gt; *) s u. Monad m =&gt; ParsecT s u m s
</span><span class="hs-identifier hs-var">getInput</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;text&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154435"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-72"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679154429"><span class="annot"><span class="annottext">e :: ParseError
</span><a href="#local-6989586621679154429"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser ([Text], ByteString)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser ([Text], ByteString))
-&gt; String -&gt; ContentParser ([Text], ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseText': &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679154429"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-73"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154426"><span class="annot"><span class="annottext">x :: [Builder]
</span><a href="#local-6989586621679154426"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154425"><span class="annot"><span class="annottext">r :: ByteString
</span><a href="#local-6989586621679154425"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Text], ByteString) -&gt; ContentParser ([Text], ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; [Builder] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679154434"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; (Builder -&gt; ByteString) -&gt; Builder -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">Bu.toLazyByteString</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Builder]
</span><a href="#local-6989586621679154426"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-74"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154425"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679154431"><span class="annot"><span class="annottext">texts :: ParsecT ByteString u Identity [Builder]
</span><a href="#local-6989586621679154431"><span class="hs-identifier hs-var hs-var">texts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString u Identity Builder
-&gt; ParsecT ByteString u Identity Char
-&gt; ParsecT ByteString u Identity [Builder]
forall s (m :: * -&gt; *) t u a sep.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m sep -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">sepBy1</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString u Identity Builder
forall u. ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154422"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString u Identity [Builder]
-&gt; ParsecT ByteString u Identity [Builder]
-&gt; ParsecT ByteString u Identity [Builder]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; ParsecT ByteString u Identity [Builder]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621679154422"><span class="annot"><span class="annottext">text :: ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154422"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154419"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154419"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT ByteString u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679154417"><span class="hs-identifier hs-var">isTSafe'</span></a></span><span>
</span><span id="line-77"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154419"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-78"></span><span>                       </span><span class="hs-char">'\\'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154416"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154416"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString u Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.anyChar</span></span><span>
</span><span id="line-79"></span><span>                                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154416"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-80"></span><span>                                       </span><span class="hs-char">'\\'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="hs-char">'\\'</span></span><span>
</span><span id="line-81"></span><span>                                       </span><span class="hs-char">';'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="hs-char">';'</span></span><span>
</span><span id="line-82"></span><span>                                       </span><span class="hs-char">','</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span>
</span><span id="line-83"></span><span>                                       </span><span id="local-6989586621679154413"><span class="annot"><span class="annottext">z :: Char
</span><a href="#local-6989586621679154413"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154413"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'n'</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-char">'N'</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="hs-char">'\n'</span></span><span>
</span><span id="line-84"></span><span>                                       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT ByteString u Identity Builder
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT ByteString u Identity Builder)
-&gt; String -&gt; ParsecT ByteString u Identity Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;unexpected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154419"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-85"></span><span>                       </span><span id="local-6989586621679154411"><span class="annot"><span class="annottext">y :: Char
</span><a href="#local-6989586621679154411"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154411"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-comment">-- isTSafe + 0x22, 0x3A, and 0x5C is pattern matched against.</span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679154417"><span class="annot"><span class="annottext">isTSafe' :: Char -&gt; Bool
</span><a href="#local-6989586621679154417"><span class="hs-identifier hs-var hs-var">isTSafe'</span></a></span></span><span> </span><span id="local-6989586621679154410"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679154410"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154409"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154410"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-88"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0x20</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0x2B</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0x2D</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0x3A</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0x3C</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679154409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-number">0x7F</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621679154414"><span class="annot"><span class="annottext">nxt :: Char -&gt; ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679154403"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679154403"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">Bu.char8</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154403"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder)
-&gt; ParsecT ByteString u Identity Builder
-&gt; ParsecT ByteString u Identity Builder
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT ByteString u Identity Builder
</span><a href="#local-6989586621679154422"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString u Identity Builder
-&gt; ParsecT ByteString u Identity Builder
-&gt; ParsecT ByteString u Identity Builder
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ParsecT ByteString u Identity Builder
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Chech that there's no remainding text after the parser is done.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#noRestText"><span class="hs-identifier hs-type">noRestText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span id="noRestText"><span class="annot"><span class="annottext">noRestText :: ([Text], ByteString) -&gt; ContentParser [Text]
</span><a href="Text.ICalendar.Parser.Common.html#noRestText"><span class="hs-identifier hs-var hs-var">noRestText</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154400"><span class="annot"><span class="annottext">x :: [Text]
</span><a href="#local-6989586621679154400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser [Text]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679154400"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#noRestText"><span class="hs-identifier hs-var">noRestText</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154399"><span class="annot"><span class="annottext">x :: ByteString
</span><a href="#local-6989586621679154399"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser [Text]
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser [Text]) -&gt; String -&gt; ContentParser [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;noRestText: remainding text: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154399"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Parse text, not allowing any remainding text.</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-type">parseText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span id="parseText"><span class="annot"><span class="annottext">parseText :: ByteString -&gt; ContentParser [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var hs-var">parseText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Text], ByteString) -&gt; ContentParser [Text]
</span><a href="Text.ICalendar.Parser.Common.html#noRestText"><span class="hs-identifier hs-var">noRestText</span></a></span><span> </span><span class="annot"><span class="annottext">(([Text], ByteString) -&gt; ContentParser [Text])
-&gt; (ByteString -&gt; ContentParser ([Text], ByteString))
-&gt; ByteString
-&gt; ContentParser [Text]
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ContentParser ([Text], ByteString)
</span><a href="Text.ICalendar.Parser.Common.html#parseText%27"><span class="hs-identifier hs-var">parseText'</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Parse a DateTime value. 3.3.5</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-type">parseDateTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- ^ Time Zone ID</span><span>
</span><span id="line-104"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span>
</span><span id="line-105"></span><span id="parseDateTime"><span class="annot"><span class="annottext">parseDateTime :: Maybe Text -&gt; ByteString -&gt; ContentParser DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var hs-var">parseDateTime</span></a></span></span><span> </span><span id="local-6989586621679154395"><span class="annot"><span class="annottext">mTZ :: Maybe Text
</span><a href="#local-6989586621679154395"><span class="hs-identifier hs-var">mTZ</span></a></span></span><span> </span><span id="local-6989586621679154394"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154394"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679154393"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154393"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((DecodingFunctions -&gt; String)
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      String)
-&gt; (DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154394"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154391"><span class="annot"><span class="annottext">dayRes :: Maybe (Day, String)
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var hs-var">dayRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (Day, String)
</span><a href="Text.ICalendar.Parser.Common.html#parseDateStr"><span class="hs-identifier hs-var">parseDateStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154393"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154389"><span class="annot"><span class="annottext">day :: Day
</span><a href="#local-6989586621679154389"><span class="hs-identifier hs-var">day</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154388"><span class="annot"><span class="annottext">rest' :: String
</span><a href="#local-6989586621679154388"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Day, String)
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var">dayRes</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span id="local-6989586621679154387"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679154387"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154388"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679154385"><span class="annot"><span class="annottext">timeRes :: Maybe (TimeOfDay, Bool)
</span><a href="#local-6989586621679154385"><span class="hs-identifier hs-var hs-var">timeRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (TimeOfDay, Bool)
</span><a href="Text.ICalendar.Parser.Common.html#parseTimeStr"><span class="hs-identifier hs-var">parseTimeStr</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe (TimeOfDay, Bool))
-&gt; String -&gt; Maybe (TimeOfDay, Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154388"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154382"><span class="annot"><span class="annottext">time :: TimeOfDay
</span><a href="#local-6989586621679154382"><span class="hs-identifier hs-var">time</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154381"><span class="annot"><span class="annottext">isUTC :: Bool
</span><a href="#local-6989586621679154381"><span class="hs-identifier hs-var">isUTC</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TimeOfDay, Bool)
</span><a href="#local-6989586621679154385"><span class="hs-identifier hs-var">timeRes</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TimeOfDay, Bool) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Day, String)
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var">dayRes</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Day, String)
-&gt; Maybe (TimeOfDay, Bool) -&gt; Maybe (TimeOfDay, Bool)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TimeOfDay, Bool)
</span><a href="#local-6989586621679154385"><span class="hs-identifier hs-var">timeRes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154387"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;T&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseDateTime: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154393"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679154381"><span class="hs-identifier hs-var">isUTC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154395"><span class="hs-identifier hs-var">mTZ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;parseDateTime: TZID on UTC timezone: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154393"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">DateTime -&gt; ContentParser DateTime
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; ContentParser DateTime)
-&gt; DateTime -&gt; ContentParser DateTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154395"><span class="hs-identifier hs-var">mTZ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679154381"><span class="hs-identifier hs-var">isUTC</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalTime -&gt; DateTime
</span><a href="Text.ICalendar.Types.html#FloatingDateTime"><span class="hs-identifier hs-var">FloatingDateTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; TimeOfDay -&gt; LocalTime
</span><span class="hs-identifier hs-var">LocalTime</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679154389"><span class="hs-identifier hs-var">day</span></a></span><span> </span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679154382"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679154376"><span class="annot"><span class="annottext">tz :: Text
</span><a href="#local-6989586621679154376"><span class="hs-identifier hs-var">tz</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalTime -&gt; Text -&gt; DateTime
</span><a href="Text.ICalendar.Types.html#ZonedDateTime"><span class="hs-identifier hs-var">ZonedDateTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; TimeOfDay -&gt; LocalTime
</span><span class="hs-identifier hs-var">LocalTime</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679154389"><span class="hs-identifier hs-var">day</span></a></span><span> </span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679154382"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154376"><span class="hs-identifier hs-var">tz</span></a></span><span>
</span><span id="line-119"></span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; DateTime
</span><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-var">UTCDateTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; DiffTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">UTCTime</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679154389"><span class="hs-identifier hs-var">day</span></a></span><span>
</span><span id="line-120"></span><span>                                                  </span><span class="annot"><span class="annottext">(DiffTime -&gt; UTCTime) -&gt; DiffTime -&gt; UTCTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeOfDay -&gt; DiffTime
</span><span class="hs-identifier hs-var">Time.timeOfDayToTime</span></span><span> </span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679154382"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Parse a string to a Day. 3.3.4</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseDateStr"><span class="hs-identifier hs-type">parseDateStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span id="parseDateStr"><span class="annot"><span class="annottext">parseDateStr :: String -&gt; Maybe (Day, String)
</span><a href="Text.ICalendar.Parser.Common.html#parseDateStr"><span class="hs-identifier hs-var hs-var">parseDateStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Day, String)] -&gt; Maybe (Day, String)
forall a. [a] -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#lastToMaybe"><span class="hs-identifier hs-var">lastToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">([(Day, String)] -&gt; Maybe (Day, String))
-&gt; (String -&gt; [(Day, String)]) -&gt; String -&gt; Maybe (Day, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; [(Day, String)]
forall t. ParseTime t =&gt; Bool -&gt; TimeLocale -&gt; String -&gt; ReadS t
</span><span class="hs-identifier hs-var">Time.readSTime</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="hs-string">&quot;%Y%m%d&quot;</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Parse a string to a TimeOfDay, and a bool if it's in UTC.</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseTimeStr"><span class="hs-identifier hs-type">parseTimeStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TimeOfDay</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="parseTimeStr"><span class="annot"><span class="annottext">parseTimeStr :: String -&gt; Maybe (TimeOfDay, Bool)
</span><a href="Text.ICalendar.Parser.Common.html#parseTimeStr"><span class="hs-identifier hs-var hs-var">parseTimeStr</span></a></span></span><span> </span><span id="local-6989586621679154370"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679154370"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679154369"><span class="annot"><span class="annottext">t :: TimeOfDay
</span><a href="#local-6989586621679154369"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154368"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621679154368"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(TimeOfDay, String)] -&gt; Maybe (TimeOfDay, String)
forall a. [a] -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#lastToMaybe"><span class="hs-identifier hs-var">lastToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TimeLocale -&gt; String -&gt; ReadS TimeOfDay
forall t. ParseTime t =&gt; Bool -&gt; TimeLocale -&gt; String -&gt; ReadS t
</span><span class="hs-identifier hs-var">Time.readSTime</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="hs-string">&quot;%H%M%S&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154370"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154368"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>         </span><span class="hs-string">&quot;Z&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TimeOfDay, Bool) -&gt; Maybe (TimeOfDay, Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679154369"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>         </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TimeOfDay, Bool) -&gt; Maybe (TimeOfDay, Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679154369"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (TimeOfDay, Bool)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Parse a Date value. 3.3.4</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseDate"><span class="hs-identifier hs-type">parseDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>
</span><span id="line-137"></span><span id="parseDate"><span class="annot"><span class="annottext">parseDate :: ByteString -&gt; ContentParser Date
</span><a href="Text.ICalendar.Parser.Common.html#parseDate"><span class="hs-identifier hs-var hs-var">parseDate</span></a></span></span><span> </span><span id="local-6989586621679154366"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154366"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679154365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154365"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((DecodingFunctions -&gt; String)
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      String)
-&gt; (DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154366"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154364"><span class="annot"><span class="annottext">dayRes :: Maybe (Day, String)
</span><a href="#local-6989586621679154364"><span class="hs-identifier hs-var hs-var">dayRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (Day, String)
</span><a href="Text.ICalendar.Parser.Common.html#parseDateStr"><span class="hs-identifier hs-var">parseDateStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154365"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154363"><span class="annot"><span class="annottext">day :: Day
</span><a href="#local-6989586621679154363"><span class="hs-identifier hs-var">day</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154362"><span class="annot"><span class="annottext">rest :: String
</span><a href="#local-6989586621679154362"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Day, String)
</span><a href="#local-6989586621679154364"><span class="hs-identifier hs-var">dayRes</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Day, String) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Day, String)
</span><a href="#local-6989586621679154364"><span class="hs-identifier hs-var">dayRes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseDate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154365"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154362"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;parseDate: extra content: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154362"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Date -&gt; ContentParser Date
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Date -&gt; ContentParser Date) -&gt; Date -&gt; ContentParser Date
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Day -&gt; Date
</span><a href="Text.ICalendar.Types.html#Date"><span class="hs-identifier hs-var">Date</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679154363"><span class="hs-identifier hs-var">day</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- {{{ Misc parsers</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-type">parseURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span>
</span><span id="line-150"></span><span id="parseURI"><span class="annot"><span class="annottext">parseURI :: String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var hs-var">parseURI</span></a></span></span><span> </span><span id="local-6989586621679154357"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679154357"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe URI
</span><span class="hs-identifier hs-var">URI.parseURI</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154357"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-151"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679154355"><span class="annot"><span class="annottext">x :: URI
</span><a href="#local-6989586621679154355"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">URI -&gt; ContentParser URI
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679154355"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-152"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI) -&gt; String -&gt; ContentParser URI
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="hs-string">&quot;Invalid URI: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679154357"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Convert a 'DateTime' to 'UTCTime', giving an appropriate error.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-type">mustBeUTC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-156"></span><span id="mustBeUTC"><span class="annot"><span class="annottext">mustBeUTC :: DateTime -&gt; ContentParser UTCTime
</span><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var hs-var">mustBeUTC</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#UTCDateTime"><span class="hs-identifier hs-type">UTCDateTime</span></a></span><span> </span><span id="local-6989586621679154353"><span class="annot"><span class="annottext">x :: UTCTime
</span><a href="#local-6989586621679154353"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; ContentParser UTCTime
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679154353"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var">mustBeUTC</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser UTCTime
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DateTime-value must be UTC&quot;</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Parse something simple with only a Text-field for the content, and</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- 'OtherParams'.</span><span>
</span><span id="line-161"></span><span id="local-6989586621679154352"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimple"><span class="hs-identifier hs-type">parseSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154352"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154352"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-162"></span><span id="parseSimple"><span class="annot"><span class="annottext">parseSimple :: (Text -&gt; OtherParams -&gt; b) -&gt; Content -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#parseSimple"><span class="hs-identifier hs-var hs-var">parseSimple</span></a></span></span><span> </span><span id="local-6989586621679154350"><span class="annot"><span class="annottext">k :: Text -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154350"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154349"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154349"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154348"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154348"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154347"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154347"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser Text)
-&gt; ContentParser [Text] -&gt; ContentParser Text
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ContentParser [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154348"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-163"></span><span>                                          </span><span class="annot"><span class="annottext">b -&gt; ContentParser b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; ContentParser b) -&gt; b -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154350"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154347"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154349"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimple"><span class="hs-identifier hs-var">parseSimple</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154343"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154343"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser b) -&gt; String -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimple: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154343"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Parse something simple with only a CI Text-field for the content, and</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- 'OtherParams'.</span><span>
</span><span id="line-168"></span><span id="local-6989586621679154342"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleI"><span class="hs-identifier hs-type">parseSimpleI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154342"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154342"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-169"></span><span id="parseSimpleI"><span class="annot"><span class="annottext">parseSimpleI :: (CI Text -&gt; OtherParams -&gt; b) -&gt; Content -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleI"><span class="hs-identifier hs-var hs-var">parseSimpleI</span></a></span></span><span> </span><span id="local-6989586621679154340"><span class="annot"><span class="annottext">k :: CI Text -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154340"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154339"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154339"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154338"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154338"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154337"><span class="annot"><span class="annottext">ByteString -&gt; CI Text
</span><a href="#local-6989586621679154337"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; ByteString -&gt; CI Text)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (ByteString -&gt; CI Text)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; CI Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2IText"><span class="hs-identifier hs-var hs-var">dfBS2IText</span></a></span><span>
</span><span id="line-170"></span><span>                                           </span><span class="annot"><span class="annottext">b -&gt; ContentParser b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; ContentParser b) -&gt; b -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154340"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI Text
</span><a href="#local-6989586621679154337"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154338"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154339"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleI"><span class="hs-identifier hs-var">parseSimpleI</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154336"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154336"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser b) -&gt; String -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleI: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154336"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Parse something simple with only a Int-field for the content, and</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- 'OtherParams'.</span><span>
</span><span id="line-175"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleRead"><span class="hs-identifier hs-type">parseSimpleRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679154334"><span class="annot"><a href="#local-6989586621679154334"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679154333"><span class="annot"><a href="#local-6989586621679154333"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679154334"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-176"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679154334"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154333"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154333"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-177"></span><span id="parseSimpleRead"><span class="annot"><span class="annottext">parseSimpleRead :: (a -&gt; OtherParams -&gt; b) -&gt; Content -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleRead"><span class="hs-identifier hs-var hs-var">parseSimpleRead</span></a></span></span><span> </span><span id="local-6989586621679154332"><span class="annot"><span class="annottext">k :: a -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154332"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154331"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154331"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154330"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154330"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154329"><span class="annot"><span class="annottext">r :: Maybe a
</span><a href="#local-6989586621679154329"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe a) -&gt; String -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154330"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679154334"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679154329"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleRead: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154330"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">b -&gt; ContentParser b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; ContentParser b) -&gt; b -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; OtherParams -&gt; b
</span><a href="#local-6989586621679154332"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679154329"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154331"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleRead"><span class="hs-identifier hs-var">parseSimpleRead</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154325"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154325"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser b) -&gt; String -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleRead: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154325"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Parse something b with alternative representations, language</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- specification, and 'OtherParams'.</span><span>
</span><span id="line-185"></span><span id="local-6989586621679154577"><span id="local-6989586621679154578"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang%27"><span class="hs-identifier hs-type">parseAltRepLang'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154578"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679154578"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-type">Language</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154577"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-188"></span><span id="parseAltRepLang%27"><span class="annot"><span class="annottext">parseAltRepLang' :: ([Text] -&gt; ContentParser b)
-&gt; (b -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang%27"><span class="hs-identifier hs-var hs-var">parseAltRepLang'</span></a></span></span><span> </span><span id="local-6989586621679154323"><span class="annot"><span class="annottext">m :: [Text] -&gt; ContentParser b
</span><a href="#local-6989586621679154323"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679154322"><span class="annot"><span class="annottext">f :: b -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154322"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154321"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154321"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154320"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154320"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679154319"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679154319"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser b
</span><a href="#local-6989586621679154323"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser b)
-&gt; ContentParser [Text] -&gt; ContentParser b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ContentParser [Text]
</span><a href="Text.ICalendar.Parser.Common.html#parseText"><span class="hs-identifier hs-var">parseText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154320"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679154318"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679154318"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; ContentParser URI)
-&gt; Maybe [String]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; ([String]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         String)
-&gt; [String]
-&gt; ContentParser URI
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe [String]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe URI))
-&gt; Maybe [String]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe URI)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Maybe [Text] -&gt; Maybe [String]
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ALTREP&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154321"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679154314"><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679154314"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      Language)
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     Language
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Language]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Language))
-&gt; Maybe [Language]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Language)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; Language
</span><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-var">Language</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Language) -&gt; (Text -&gt; CI Text) -&gt; Text -&gt; Language
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Language) -&gt; Maybe [Text] -&gt; Maybe [Language]
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154321"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154312"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154312"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679154311"><span class="annot"><span class="annottext">x :: CI Text
</span><a href="#local-6989586621679154311"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154311"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [CI Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;ALTREP&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;LANGUAGE&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154321"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a) -&gt; a -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154322"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679154319"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679154318"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621679154314"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154312"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang%27"><span class="hs-identifier hs-var">parseAltRepLang'</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154309"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154309"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseAltRepLang': &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154309"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Parse something 'Text' with alternative representations, language</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- specification, and 'OtherParams'.</span><span>
</span><span id="line-198"></span><span id="local-6989586621679154308"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang"><span class="hs-identifier hs-type">parseAltRepLang</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-type">Language</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154308"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154308"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-200"></span><span id="parseAltRepLang"><span class="annot"><span class="annottext">parseAltRepLang :: (Text -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang"><span class="hs-identifier hs-var hs-var">parseAltRepLang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser Text)
-&gt; (Text -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ContentParser a
forall b a.
([Text] -&gt; ContentParser b)
-&gt; (b -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang%27"><span class="hs-identifier hs-var">parseAltRepLang'</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser Text
</span><a href="#local-6989586621679154306"><span class="hs-identifier hs-var">lenientTextOnlyOne</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621679154306"><span class="hs-identifier hs-type">lenientTextOnlyOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-202"></span><span>        </span><span id="local-6989586621679154306"><span class="annot"><span class="annottext">lenientTextOnlyOne :: [Text] -&gt; ContentParser Text
</span><a href="#local-6989586621679154306"><span class="hs-identifier hs-var hs-var">lenientTextOnlyOne</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679154305"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679154305"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ContentParser Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154305"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="#local-6989586621679154306"><span class="hs-identifier hs-var">lenientTextOnlyOne</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser Text
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Must have one value, not zero.&quot;</span></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="#local-6989586621679154306"><span class="hs-identifier hs-var">lenientTextOnlyOne</span></a></span><span> </span><span id="local-6989586621679154304"><span class="annot"><span class="annottext">xs :: [Text]
</span><a href="#local-6989586621679154304"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>            </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;Illegal comma in value that only allows one TEXT, assuming literal comma was intended.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; ContentParser Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ContentParser Text) -&gt; Text -&gt; ContentParser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679154304"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Parse something '[Text]' with alternative representations, language</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- specification, and 'OtherParams'.</span><span>
</span><span id="line-210"></span><span id="local-6989586621679154302"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseAltRepLangN"><span class="hs-identifier hs-type">parseAltRepLangN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Language"><span class="hs-identifier hs-type">Language</span></a></span><span>
</span><span id="line-211"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154302"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154302"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-213"></span><span id="parseAltRepLangN"><span class="annot"><span class="annottext">parseAltRepLangN :: (Set Text -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseAltRepLangN"><span class="hs-identifier hs-var hs-var">parseAltRepLangN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser (Set Text))
-&gt; (Set Text -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ContentParser a
forall b a.
([Text] -&gt; ContentParser b)
-&gt; (b -&gt; Maybe URI -&gt; Maybe Language -&gt; OtherParams -&gt; a)
-&gt; Content
-&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseAltRepLang%27"><span class="hs-identifier hs-var">parseAltRepLang'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Text -&gt; ContentParser (Set Text)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Set Text -&gt; ContentParser (Set Text))
-&gt; ([Text] -&gt; Set Text) -&gt; [Text] -&gt; ContentParser (Set Text)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Set Text
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Parse something simple with only a URI-field for the content, and</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- 'OtherParams'.</span><span>
</span><span id="line-217"></span><span id="local-6989586621679154299"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleURI"><span class="hs-identifier hs-type">parseSimpleURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154299"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154299"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-218"></span><span id="parseSimpleURI"><span class="annot"><span class="annottext">parseSimpleURI :: (URI -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleURI"><span class="hs-identifier hs-var hs-var">parseSimpleURI</span></a></span></span><span> </span><span id="local-6989586621679154297"><span class="annot"><span class="annottext">f :: URI -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154297"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154296"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154296"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154295"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154295"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679154294"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679154294"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser URI
</span><a href="Text.ICalendar.Parser.Common.html#parseURI"><span class="hs-identifier hs-var">parseURI</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser URI)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
-&gt; ContentParser URI
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(DecodingFunctions -&gt; String)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (DecodingFunctions -&gt; Text) -&gt; DecodingFunctions -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154295"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Text) -&gt; Text)
-&gt; (DecodingFunctions -&gt; ByteString -&gt; Text)
-&gt; DecodingFunctions
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingFunctions -&gt; ByteString -&gt; Text
</span><a href="Text.ICalendar.Parser.Common.html#dfBS2Text"><span class="hs-identifier hs-var hs-var">dfBS2Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a)
-&gt; (OtherParams -&gt; a) -&gt; OtherParams -&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154297"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679154294"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser a) -&gt; OtherParams -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154296"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleURI"><span class="hs-identifier hs-var">parseSimpleURI</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154293"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154293"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleURI: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154293"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Parse something which has either a 'Date' or a 'DateTime' value, and</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- 'OtherParams'. Uses DateTime if there is no value parameter.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679154292"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateOrDateTime"><span class="hs-identifier hs-type">parseSimpleDateOrDateTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span>
</span><span id="line-229"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154292"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span id="parseSimpleDateOrDateTime"><span class="annot"><span class="annottext">parseSimpleDateOrDateTime :: (DateTime -&gt; OtherParams -&gt; a)
-&gt; (Date -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateOrDateTime"><span class="hs-identifier hs-var hs-var">parseSimpleDateOrDateTime</span></a></span></span><span> </span><span id="local-6989586621679154290"><span class="annot"><span class="annottext">dt :: DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154290"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span id="local-6989586621679154289"><span class="annot"><span class="annottext">d :: Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154289"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154288"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154288"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154287"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154287"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679154286"><span class="annot"><span class="annottext">typ :: Text
</span><a href="#local-6989586621679154286"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154285"><span class="annot"><span class="annottext">tzid :: Maybe Text
</span><a href="#local-6989586621679154285"><span class="hs-identifier hs-var">tzid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154284"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154284"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
-&gt; ContentParser (Text, Maybe Text, [(CI Text, [Text])])
</span><a href="Text.ICalendar.Parser.Common.html#typTzIdO"><span class="hs-identifier hs-var">typTzIdO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154288"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154286"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-233"></span><span>         </span><span class="hs-string">&quot;DATE-TIME&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154282"><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679154282"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteString -&gt; ContentParser DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154285"><span class="hs-identifier hs-var">tzid</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154287"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-234"></span><span>                           </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a)
-&gt; (OtherParams -&gt; a) -&gt; OtherParams -&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154290"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679154282"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser a) -&gt; OtherParams -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154284"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-235"></span><span>         </span><span class="hs-string">&quot;DATE&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154281"><span class="annot"><span class="annottext">Date
</span><a href="#local-6989586621679154281"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ContentParser Date
</span><a href="Text.ICalendar.Parser.Common.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154287"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-236"></span><span>                      </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a)
-&gt; (OtherParams -&gt; a) -&gt; OtherParams -&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154289"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Date
</span><a href="#local-6989586621679154281"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser a) -&gt; OtherParams -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154284"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-237"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Invalid type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154286"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateOrDateTime"><span class="hs-identifier hs-var">parseSimpleDateOrDateTime</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154280"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154280"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleDateOrDateTime: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154280"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Parse something which has a set of either a 'Date' or a 'DateTime' value,</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- and 'OtherParams'. Uses DateTime if there is no value parameter.</span><span>
</span><span id="line-243"></span><span id="local-6989586621679154279"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDatesOrDateTimes"><span class="hs-identifier hs-type">parseSimpleDatesOrDateTimes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span>
</span><span id="line-246"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154279"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-247"></span><span id="parseSimpleDatesOrDateTimes"><span class="annot"><span class="annottext">parseSimpleDatesOrDateTimes :: (Set DateTime -&gt; OtherParams -&gt; a)
-&gt; (Set Date -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDatesOrDateTimes"><span class="hs-identifier hs-var hs-var">parseSimpleDatesOrDateTimes</span></a></span></span><span> </span><span id="local-6989586621679154277"><span class="annot"><span class="annottext">dt :: Set DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154277"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span id="local-6989586621679154276"><span class="annot"><span class="annottext">d :: Set Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154276"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154275"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154275"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154274"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154274"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679154273"><span class="annot"><span class="annottext">typ :: Text
</span><a href="#local-6989586621679154273"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154272"><span class="annot"><span class="annottext">tzid :: Maybe Text
</span><a href="#local-6989586621679154272"><span class="hs-identifier hs-var">tzid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154271"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154271"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
-&gt; ContentParser (Text, Maybe Text, [(CI Text, [Text])])
</span><a href="Text.ICalendar.Parser.Common.html#typTzIdO"><span class="hs-identifier hs-var">typTzIdO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154275"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154273"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>         </span><span class="hs-string">&quot;DATE-TIME&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154270"><span class="annot"><span class="annottext">Set DateTime
</span><a href="#local-6989586621679154270"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DateTime] -&gt; Set DateTime
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([DateTime] -&gt; Set DateTime)
-&gt; ([ByteString]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [DateTime])
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set DateTime)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ContentParser DateTime)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [DateTime]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteString -&gt; ContentParser DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154272"><span class="hs-identifier hs-var">tzid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set DateTime))
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set DateTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-251"></span><span>                                                </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154274"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-252"></span><span>                           </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a)
-&gt; (OtherParams -&gt; a) -&gt; OtherParams -&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154277"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Set DateTime
</span><a href="#local-6989586621679154270"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser a) -&gt; OtherParams -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154271"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-253"></span><span>         </span><span class="hs-string">&quot;DATE&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154268"><span class="annot"><span class="annottext">Set Date
</span><a href="#local-6989586621679154268"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Date] -&gt; Set Date
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Date] -&gt; Set Date)
-&gt; ([ByteString]
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         [Date])
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set Date)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ContentParser Date)
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Date]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ContentParser Date
</span><a href="Text.ICalendar.Parser.Common.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Set Date))
-&gt; [ByteString]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Set Date)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">B.split</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154274"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-254"></span><span>                      </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ContentParser a)
-&gt; (OtherParams -&gt; a) -&gt; OtherParams -&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set Date -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154276"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Set Date
</span><a href="#local-6989586621679154268"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; ContentParser a) -&gt; OtherParams -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154271"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-255"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Invalid type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154273"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDatesOrDateTimes"><span class="hs-identifier hs-var">parseSimpleDatesOrDateTimes</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154267"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154267"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleDatesOrDateTimes: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#typTzIdO"><span class="hs-identifier hs-type">typTzIdO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="typTzIdO"><span class="annot"><span class="annottext">typTzIdO :: [(CI Text, [Text])]
-&gt; ContentParser (Text, Maybe Text, [(CI Text, [Text])])
</span><a href="Text.ICalendar.Parser.Common.html#typTzIdO"><span class="hs-identifier hs-var hs-var">typTzIdO</span></a></span></span><span> </span><span id="local-6989586621679154266"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154266"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679154265"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154265"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser Text)
-&gt; (Maybe [Text] -&gt; [Text]) -&gt; Maybe [Text] -&gt; ContentParser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe [Text] -&gt; [Text]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;DATE-TIME&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text] -&gt; ContentParser Text)
-&gt; Maybe [Text] -&gt; ContentParser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154266"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679154263"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154263"><span class="hs-identifier hs-var">tzid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154265"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DATE-TIME&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154266"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-264"></span><span>                                                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe [Text]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154262"><span class="annot"><span class="annottext">f :: a -&gt; Bool
</span><a href="#local-6989586621679154262"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679154261"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679154261"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679154261"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;VALUE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154265"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;DATE-TIME&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679154261"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>        </span><span id="local-6989586621679154260"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154260"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; Bool
forall a. (Eq a, IsString a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679154262"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154266"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="annottext">(Text, Maybe Text, [(CI Text, [Text])])
-&gt; ContentParser (Text, Maybe Text, [(CI Text, [Text])])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679154265"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154263"><span class="hs-identifier hs-var">tzid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154260"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Parse something which has only a DateTime value, and 'OtherParams'.</span><span>
</span><span id="line-270"></span><span id="local-6989586621679154259"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateTime"><span class="hs-identifier hs-type">parseSimpleDateTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Types.html#DateTime"><span class="hs-identifier hs-type">DateTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span>
</span><span id="line-272"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154259"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-273"></span><span id="parseSimpleDateTime"><span class="annot"><span class="annottext">parseSimpleDateTime :: (DateTime -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateTime"><span class="hs-identifier hs-var hs-var">parseSimpleDateTime</span></a></span></span><span> </span><span id="local-6989586621679154257"><span class="annot"><span class="annottext">dt :: DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154257"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154256"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154256"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154255"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154255"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679154254"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154254"><span class="hs-identifier hs-var">tzid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; ContentParser Text)
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ContentParser Text
forall a. [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Text]
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      (Maybe Text))
-&gt; Maybe [Text]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [(CI Text, [Text])] -&gt; Maybe [Text]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154256"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154253"><span class="annot"><span class="annottext">o' :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154253"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; Bool)
-&gt; [(CI Text, [Text])] -&gt; [(CI Text, [Text])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="hs-string">&quot;TZID&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CI Text -&gt; Bool)
-&gt; ((CI Text, [Text]) -&gt; CI Text) -&gt; (CI Text, [Text]) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CI Text, [Text]) -&gt; CI Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154256"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">(DateTime -&gt; OtherParams -&gt; a) -&gt; OtherParams -&gt; DateTime -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">DateTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154257"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154253"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; a) -&gt; ContentParser DateTime -&gt; ContentParser a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteString -&gt; ContentParser DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679154254"><span class="hs-identifier hs-var">tzid</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154255"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleDateTime"><span class="hs-identifier hs-var">parseSimpleDateTime</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154251"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154251"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleDateTime: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154251"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621679154250"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleUTC"><span class="hs-identifier hs-type">parseSimpleUTC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span>
</span><span id="line-281"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154250"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-282"></span><span id="parseSimpleUTC"><span class="annot"><span class="annottext">parseSimpleUTC :: (UTCTime -&gt; OtherParams -&gt; a) -&gt; Content -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#parseSimpleUTC"><span class="hs-identifier hs-var hs-var">parseSimpleUTC</span></a></span></span><span> </span><span id="local-6989586621679154248"><span class="annot"><span class="annottext">dt :: UTCTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154248"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154247"><span class="annot"><span class="annottext">o :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154247"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679154246"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154246"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">(UTCTime -&gt; OtherParams -&gt; a) -&gt; OtherParams -&gt; UTCTime -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; OtherParams -&gt; a
</span><a href="#local-6989586621679154248"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154247"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; a) -&gt; ContentParser UTCTime -&gt; ContentParser a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DateTime -&gt; ContentParser UTCTime
</span><a href="Text.ICalendar.Parser.Common.html#mustBeUTC"><span class="hs-identifier hs-var">mustBeUTC</span></a></span><span> </span><span class="annot"><span class="annottext">(DateTime -&gt; ContentParser UTCTime)
-&gt; ContentParser DateTime -&gt; ContentParser UTCTime
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; ByteString -&gt; ContentParser DateTime
</span><a href="Text.ICalendar.Parser.Common.html#parseDateTime"><span class="hs-identifier hs-var">parseDateTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154246"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#parseSimpleUTC"><span class="hs-identifier hs-var">parseSimpleUTC</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154245"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154245"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser a) -&gt; String -&gt; ContentParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parseSimpleUTC: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154245"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Convert a property dictionary to 'OtherParams'.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-type">toO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-type">OtherParams</span></a></span><span>
</span><span id="line-288"></span><span id="toO"><span class="annot"><span class="annottext">toO :: [(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var hs-var">toO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set OtherParam -&gt; OtherParams
</span><a href="Text.ICalendar.Types.html#OtherParams"><span class="hs-identifier hs-var">OtherParams</span></a></span><span> </span><span class="annot"><span class="annottext">(Set OtherParam -&gt; OtherParams)
-&gt; ([(CI Text, [Text])] -&gt; Set OtherParam)
-&gt; [(CI Text, [Text])]
-&gt; OtherParams
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[OtherParam] -&gt; Set OtherParam
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([OtherParam] -&gt; Set OtherParam)
-&gt; ([(CI Text, [Text])] -&gt; [OtherParam])
-&gt; [(CI Text, [Text])]
-&gt; Set OtherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((CI Text, [Text]) -&gt; OtherParam)
-&gt; [(CI Text, [Text])] -&gt; [OtherParam]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CI Text -&gt; [Text] -&gt; OtherParam)
-&gt; (CI Text, [Text]) -&gt; OtherParam
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; [Text] -&gt; OtherParam
</span><a href="Text.ICalendar.Types.html#OtherParam"><span class="hs-identifier hs-var">OtherParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Get the remaining properties.</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#otherProperties"><span class="hs-identifier hs-type">otherProperties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.ICalendar.Types.html#OtherProperty"><span class="hs-identifier hs-type">OtherProperty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="otherProperties"><span class="annot"><span class="annottext">otherProperties :: ContentParser (Set OtherProperty)
</span><a href="Text.ICalendar.Parser.Common.html#otherProperties"><span class="hs-identifier hs-var hs-var">otherProperties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679154240"><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154240"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-293"></span><span>                     </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>                     </span><span class="annot"><span class="annottext">[OtherProperty] -&gt; Set OtherProperty
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([OtherProperty] -&gt; Set OtherProperty)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [OtherProperty]
-&gt; ContentParser (Set OtherProperty)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Content
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      OtherProperty)
-&gt; [Content]
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [OtherProperty]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Content
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
</span><a href="#local-6989586621679154238"><span class="hs-identifier hs-var">lineToOtherProp</span></a></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154240"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679154238"><span class="annot"><span class="annottext">lineToOtherProp :: Content
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
</span><a href="#local-6989586621679154238"><span class="hs-identifier hs-var hs-var">lineToOtherProp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154237"><span class="annot"><span class="annottext">n :: CI Text
</span><a href="#local-6989586621679154237"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679154236"><span class="annot"><span class="annottext">opts :: [(CI Text, [Text])]
</span><a href="#local-6989586621679154236"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679154235"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679154235"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">OtherProperty
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI Text -&gt; ByteString -&gt; OtherParams -&gt; OtherProperty
</span><a href="Text.ICalendar.Types.html#OtherProperty"><span class="hs-identifier hs-var">OtherProperty</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154237"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154235"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">(OtherParams -&gt; OtherProperty) -&gt; OtherParams -&gt; OtherProperty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])] -&gt; OtherParams
</span><a href="Text.ICalendar.Parser.Common.html#toO"><span class="hs-identifier hs-var">toO</span></a></span><span> </span><span class="annot"><span class="annottext">[(CI Text, [Text])]
</span><a href="#local-6989586621679154236"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><a href="#local-6989586621679154238"><span class="hs-identifier hs-var">lineToOtherProp</span></a></span><span> </span><span id="local-6989586621679154233"><span class="annot"><span class="annottext">c :: Content
</span><a href="#local-6989586621679154233"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">Content
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154233"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String
   (RWS DecodingFunctions [String] (SourcePos, [Content]))
   OtherProperty
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      OtherProperty)
-&gt; (String
    -&gt; ErrorT
         String
         (RWS DecodingFunctions [String] (SourcePos, [Content]))
         OtherProperty)
-&gt; String
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String
      (RWS DecodingFunctions [String] (SourcePos, [Content]))
      OtherProperty)
-&gt; String
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     OtherProperty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unconsumed component: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154233"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#neg"><span class="hs-identifier hs-type">neg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#TextParser"><span class="hs-identifier hs-type">TextParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span id="neg"><span class="annot"><span class="annottext">neg :: TextParser (Int -&gt; Int)
</span><a href="Text.ICalendar.Parser.Common.html#neg"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (Char -&gt; Int -&gt; Int) -&gt; Maybe Char -&gt; Int -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679154228"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679154228"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679154228"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>            </span><span class="annot"><span class="annottext">(Maybe Char -&gt; Int -&gt; Int)
-&gt; ParsecT ByteString DecodingFunctions Identity (Maybe Char)
-&gt; TextParser (Int -&gt; Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString DecodingFunctions Identity Char
-&gt; ParsecT ByteString DecodingFunctions Identity (Maybe Char)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT ByteString DecodingFunctions Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;+-&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#digits"><span class="hs-identifier hs-type">digits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#TextParser"><span class="hs-identifier hs-type">TextParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-305"></span><span id="digits"><span class="annot"><span class="annottext">digits :: TextParser Int
</span><a href="Text.ICalendar.Parser.Common.html#digits"><span class="hs-identifier hs-var hs-var">digits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; [Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; (Int -&gt; Int) -&gt; Int -&gt; Int -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; (String -&gt; [Int]) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; String -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int)
-&gt; ParsecT ByteString DecodingFunctions Identity String
-&gt; TextParser Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString DecodingFunctions Identity Char
-&gt; ParsecT ByteString DecodingFunctions Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">ParsecT ByteString DecodingFunctions Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.digit</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#digitsN"><span class="hs-identifier hs-type">digitsN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#TextParser"><span class="hs-identifier hs-type">TextParser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span id="digitsN"><span class="annot"><span class="annottext">digitsN :: TextParser [Int]
</span><a href="Text.ICalendar.Parser.Common.html#digitsN"><span class="hs-identifier hs-var hs-var">digitsN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextParser Int
-&gt; ParsecT ByteString DecodingFunctions Identity Char
-&gt; TextParser [Int]
forall s (m :: * -&gt; *) t u a sep.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m sep -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">sepBy1</span></span><span> </span><span class="annot"><span class="annottext">TextParser Int
</span><a href="Text.ICalendar.Parser.Common.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT ByteString DecodingFunctions Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="hs-char">','</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- | Set the parser context.</span><span>
</span><span id="line-313"></span><span id="local-6989586621679154542"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-type">down</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154542"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154542"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-314"></span><span id="down"><span class="annot"><span class="annottext">down :: Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var hs-var">down</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span id="local-6989586621679154217"><span class="annot"><span class="annottext">p :: SourcePos
</span><a href="#local-6989586621679154217"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154216"><span class="annot"><span class="annottext">x :: [Content]
</span><a href="#local-6989586621679154216"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; ContentParser a -&gt; ContentParser a
forall a.
(SourcePos, [Content]) -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down%27"><span class="hs-identifier hs-var">down'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679154217"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154216"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span id="local-6989586621679154214"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154214"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span id="local-6989586621679154213"><span class="annot"><span class="annottext">p :: SourcePos
</span><a href="#local-6989586621679154213"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; ContentParser a -&gt; ContentParser a
forall a.
(SourcePos, [Content]) -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down%27"><span class="hs-identifier hs-var">down'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679154213"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154214"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Set the parser context.</span><span>
</span><span id="line-318"></span><span id="local-6989586621679154524"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#down%27"><span class="hs-identifier hs-type">down'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.SourcePos</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154524"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-319"></span><span id="down%27"><span class="annot"><span class="annottext">down' :: (SourcePos, [Content]) -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down%27"><span class="hs-identifier hs-var hs-var">down'</span></a></span></span><span> </span><span id="local-6989586621679154212"><span class="annot"><span class="annottext">x :: (SourcePos, [Content])
</span><a href="#local-6989586621679154212"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679154211"><span class="annot"><span class="annottext">m :: ContentParser a
</span><a href="#local-6989586621679154211"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
-&gt; ((SourcePos, [Content]) -&gt; ContentParser a) -&gt; ContentParser a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679154210"><span class="annot"><span class="annottext">old :: (SourcePos, [Content])
</span><a href="#local-6989586621679154210"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content])
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content])
</span><a href="#local-6989586621679154212"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ContentParser a -&gt; ContentParser a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ContentParser a
</span><a href="#local-6989586621679154211"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ContentParser a
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ContentParser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content])
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content])
</span><a href="#local-6989586621679154210"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Many optional components named ...</span><span>
</span><span id="line-322"></span><span id="local-6989586621679154208"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#optCompN"><span class="hs-identifier hs-type">optCompN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679154208"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-323"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154208"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679154208"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-324"></span><span id="optCompN"><span class="annot"><span class="annottext">optCompN :: CI Text -&gt; (Content -&gt; ContentParser a) -&gt; ContentParser (Set a)
</span><a href="Text.ICalendar.Parser.Common.html#optCompN"><span class="hs-identifier hs-var hs-var">optCompN</span></a></span></span><span> </span><span id="local-6989586621679154206"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154206"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679154205"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser a
</span><a href="#local-6989586621679154205"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ContentParser a)
-&gt; ([Content], [Content]) -&gt; ContentParser (Set a)
forall b.
Ord b =&gt;
(Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#optN"><span class="hs-identifier hs-var">optN</span></a></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser a
</span><a href="#local-6989586621679154205"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([Content], [Content]) -&gt; ContentParser (Set a))
-&gt; ([Content] -&gt; ([Content], [Content]))
-&gt; [Content]
-&gt; ContentParser (Set a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; Bool) -&gt; [Content] -&gt; ([Content], [Content])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isComponentNamed"><span class="hs-operator hs-var">`isComponentNamed`</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154206"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Content] -&gt; ContentParser (Set a))
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
-&gt; ContentParser (Set a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | One required line named ...</span><span>
</span><span id="line-327"></span><span id="local-6989586621679154202"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#reqLine1"><span class="hs-identifier hs-type">reqLine1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154202"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-328"></span><span id="reqLine1"><span class="annot"><span class="annottext">reqLine1 :: CI Text -&gt; (Content -&gt; ContentParser a) -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#reqLine1"><span class="hs-identifier hs-var hs-var">reqLine1</span></a></span></span><span> </span><span id="local-6989586621679154200"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154200"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679154199"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser a
</span><a href="#local-6989586621679154199"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI Text
-&gt; (Content -&gt; ContentParser a)
-&gt; ([Content], [Content])
-&gt; ContentParser a
forall b.
CI Text
-&gt; (Content -&gt; ContentParser b)
-&gt; ([Content], [Content])
-&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#req1"><span class="hs-identifier hs-var">req1</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154200"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser a
</span><a href="#local-6989586621679154199"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([Content], [Content]) -&gt; ContentParser a)
-&gt; ([Content] -&gt; ([Content], [Content]))
-&gt; [Content]
-&gt; ContentParser a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; Bool) -&gt; [Content] -&gt; ([Content], [Content])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-operator hs-var">`isLineNamed`</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154200"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Content] -&gt; ContentParser a)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
-&gt; ContentParser a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | One optional line named ...</span><span>
</span><span id="line-331"></span><span id="local-6989586621679154196"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#optLine1"><span class="hs-identifier hs-type">optLine1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="#local-6989586621679154196"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-332"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154196"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154196"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-333"></span><span id="optLine1"><span class="annot"><span class="annottext">optLine1 :: CI Text -&gt; (Content -&gt; ContentParser b) -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#optLine1"><span class="hs-identifier hs-var hs-var">optLine1</span></a></span></span><span> </span><span id="local-6989586621679154194"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154194"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679154193"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154193"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser b
forall b.
Default b =&gt;
(Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#opt1"><span class="hs-identifier hs-var">opt1</span></a></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([Content], [Content]) -&gt; ContentParser b)
-&gt; ([Content] -&gt; ([Content], [Content]))
-&gt; [Content]
-&gt; ContentParser b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; Bool) -&gt; [Content] -&gt; ([Content], [Content])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-operator hs-var">`isLineNamed`</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154194"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Content] -&gt; ContentParser b)
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
-&gt; ContentParser b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Many optional lines named ...</span><span>
</span><span id="line-336"></span><span id="local-6989586621679154191"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#optLineN"><span class="hs-identifier hs-type">optLineN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679154191"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-337"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154191"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679154191"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-338"></span><span id="optLineN"><span class="annot"><span class="annottext">optLineN :: CI Text -&gt; (Content -&gt; ContentParser b) -&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#optLineN"><span class="hs-identifier hs-var hs-var">optLineN</span></a></span></span><span> </span><span id="local-6989586621679154189"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154189"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679154188"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154188"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser (Set b)
forall b.
Ord b =&gt;
(Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#optN"><span class="hs-identifier hs-var">optN</span></a></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154188"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([Content], [Content]) -&gt; ContentParser (Set b))
-&gt; ([Content] -&gt; ([Content], [Content]))
-&gt; [Content]
-&gt; ContentParser (Set b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; Bool) -&gt; [Content] -&gt; ([Content], [Content])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-operator hs-var">`isLineNamed`</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154189"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Content] -&gt; ContentParser (Set b))
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
-&gt; ContentParser (Set b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Many lines named ..., at least one required.</span><span>
</span><span id="line-341"></span><span id="local-6989586621679154187"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#reqLineN"><span class="hs-identifier hs-type">reqLineN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679154187"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-342"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154187"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679154187"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-343"></span><span id="reqLineN"><span class="annot"><span class="annottext">reqLineN :: CI Text -&gt; (Content -&gt; ContentParser b) -&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#reqLineN"><span class="hs-identifier hs-var hs-var">reqLineN</span></a></span></span><span> </span><span id="local-6989586621679154185"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154185"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679154184"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI Text
-&gt; (Content -&gt; ContentParser b)
-&gt; ([Content], [Content])
-&gt; ContentParser (Set b)
forall b.
Ord b =&gt;
CI Text
-&gt; (Content -&gt; ContentParser b)
-&gt; ([Content], [Content])
-&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#reqN"><span class="hs-identifier hs-var">reqN</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154185"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154184"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(([Content], [Content]) -&gt; ContentParser (Set b))
-&gt; ([Content] -&gt; ([Content], [Content]))
-&gt; [Content]
-&gt; ContentParser (Set b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; Bool) -&gt; [Content] -&gt; ([Content], [Content])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-operator hs-var">`isLineNamed`</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154185"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Content] -&gt; ContentParser (Set b))
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
-&gt; ContentParser (Set b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos, [Content]) -&gt; [Content]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     (SourcePos, [Content])
-&gt; ErrorT
     String
     (RWS DecodingFunctions [String] (SourcePos, [Content]))
     [Content]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ErrorT
  String
  (RWS DecodingFunctions [String] (SourcePos, [Content]))
  (SourcePos, [Content])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | One required ...</span><span>
</span><span id="line-346"></span><span id="local-6989586621679154514"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#req1"><span class="hs-identifier hs-type">req1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154514"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154514"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-348"></span><span id="req1"><span class="annot"><span class="annottext">req1 :: CI Text
-&gt; (Content -&gt; ContentParser b)
-&gt; ([Content], [Content])
-&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#req1"><span class="hs-identifier hs-var hs-var">req1</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154182"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154182"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679154181"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154181"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154180"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154180"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154180"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ContentParser b -&gt; ContentParser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154182"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154181"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#req1"><span class="hs-identifier hs-var">req1</span></a></span><span> </span><span id="local-6989586621679154179"><span class="annot"><span class="annottext">s :: CI Text
</span><a href="#local-6989586621679154179"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContentParser b) -&gt; String -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Missing content: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154179"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#req1"><span class="hs-identifier hs-var">req1</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154178"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154178"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154177"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154177"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679154176"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154176"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154175"><span class="annot"><span class="annottext">xs' :: [Content]
</span><a href="#local-6989586621679154175"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154175"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                          </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Content -&gt; String) -&gt; [Content] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Extra content: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (Content -&gt; String) -&gt; Content -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154176"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>                          </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154177"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(ContentParser b -&gt; ContentParser b)
-&gt; ContentParser b -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154178"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154177"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | One optional ...</span><span>
</span><span id="line-355"></span><span id="local-6989586621679154512"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#opt1"><span class="hs-identifier hs-type">opt1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="#local-6989586621679154512"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-356"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154512"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154512"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-358"></span><span id="opt1"><span class="annot"><span class="annottext">opt1 :: (Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser b
</span><a href="Text.ICalendar.Parser.Common.html#opt1"><span class="hs-identifier hs-var hs-var">opt1</span></a></span></span><span> </span><span id="local-6989586621679154174"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154174"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679154173"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154173"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154172"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154172"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154172"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ErrorT
  String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ContentParser b -&gt; ContentParser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154173"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154174"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154173"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#opt1"><span class="hs-identifier hs-var">opt1</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; ContentParser b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#opt1"><span class="hs-identifier hs-var">opt1</span></a></span><span> </span><span id="local-6989586621679154171"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154171"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154170"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154170"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679154169"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154169"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154168"><span class="annot"><span class="annottext">xs' :: [Content]
</span><a href="#local-6989586621679154168"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154168"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                        </span><span class="annot"><span class="annottext">[String]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Content -&gt; String) -&gt; [Content] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Extra content: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (Content -&gt; String) -&gt; Content -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154169"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                        </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154170"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(ContentParser b -&gt; ContentParser b)
-&gt; ContentParser b -&gt; ContentParser b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154171"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154170"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Many optional ...</span><span>
</span><span id="line-365"></span><span id="local-6989586621679154517"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#optN"><span class="hs-identifier hs-type">optN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679154517"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-366"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154517"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679154517"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-368"></span><span id="optN"><span class="annot"><span class="annottext">optN :: (Content -&gt; ContentParser b)
-&gt; ([Content], [Content]) -&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#optN"><span class="hs-identifier hs-var hs-var">optN</span></a></span></span><span> </span><span id="local-6989586621679154167"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154167"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154166"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154166"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154165"><span class="annot"><span class="annottext">xs' :: [Content]
</span><a href="#local-6989586621679154165"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154165"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>                      </span><span class="annot"><span class="annottext">[b] -&gt; Set b
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Set b)
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) [b]
-&gt; ContentParser (Set b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ContentParser b)
-&gt; [Content]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) [b]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679154164"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154164"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154164"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154167"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154166"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Many ..., at least one required.</span><span>
</span><span id="line-372"></span><span id="local-6989586621679154509"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#reqN"><span class="hs-identifier hs-type">reqN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679154509"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-373"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- ^ What, needed for the error.</span><span>
</span><span id="line-374"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154509"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679154509"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-376"></span><span id="reqN"><span class="annot"><span class="annottext">reqN :: CI Text
-&gt; (Content -&gt; ContentParser b)
-&gt; ([Content], [Content])
-&gt; ContentParser (Set b)
</span><a href="Text.ICalendar.Parser.Common.html#reqN"><span class="hs-identifier hs-var hs-var">reqN</span></a></span></span><span> </span><span id="local-6989586621679154163"><span class="annot"><span class="annottext">w :: CI Text
</span><a href="#local-6989586621679154163"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679154162"><span class="annot"><span class="annottext">f :: Content -&gt; ContentParser b
</span><a href="#local-6989586621679154162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679154161"><span class="annot"><span class="annottext">xs :: [Content]
</span><a href="#local-6989586621679154161"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154160"><span class="annot"><span class="annottext">xs' :: [Content]
</span><a href="#local-6989586621679154160"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">((SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Content] -&gt; [Content])
-&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">(([Content] -&gt; [Content])
 -&gt; (SourcePos, [Content]) -&gt; (SourcePos, [Content]))
-&gt; ([Content] -&gt; [Content])
-&gt; (SourcePos, [Content])
-&gt; (SourcePos, [Content])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Content] -&gt; [Content] -&gt; [Content]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154160"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                        </span><span id="local-6989586621679154159"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679154159"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Set b
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Set b)
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) [b]
-&gt; ContentParser (Set b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Content -&gt; ContentParser b)
-&gt; [Content]
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) [b]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679154158"><span class="annot"><span class="annottext">x :: Content
</span><a href="#local-6989586621679154158"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Content -&gt; ContentParser b -&gt; ContentParser b
forall a. Content -&gt; ContentParser a -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#down"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154158"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Content -&gt; ContentParser b
</span><a href="#local-6989586621679154162"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Content
</span><a href="#local-6989586621679154158"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Content]
</span><a href="#local-6989586621679154161"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-378"></span><span>                        </span><span class="annot"><span class="annottext">Bool
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set b -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">S.size</span></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679154159"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ErrorT
   String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; (String
    -&gt; ErrorT
         String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-379"></span><span>                            </span><span class="annot"><span class="annottext">String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ErrorT
      String (RWS DecodingFunctions [String] (SourcePos, [Content])) ())
-&gt; String
-&gt; ErrorT
     String (RWS DecodingFunctions [String] (SourcePos, [Content])) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;At least one required: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154163"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-380"></span><span>                        </span><span class="annot"><span class="annottext">Set b -&gt; ContentParser (Set b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679154159"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | Only allow one parameter value.</span><span>
</span><span id="line-383"></span><span id="local-6989586621679154155"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-type">paramOnlyOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679154155"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154155"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-384"></span><span id="paramOnlyOne"><span class="annot"><span class="annottext">paramOnlyOne :: [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var hs-var">paramOnlyOne</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679154154"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679154154"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679154154"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-385"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#paramOnlyOne"><span class="hs-identifier hs-var">paramOnlyOne</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Only one parameter value allowed.&quot;</span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621679154605"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-type">valueOnlyOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679154605"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentParser"><span class="hs-identifier hs-type">ContentParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154605"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-388"></span><span id="valueOnlyOne"><span class="annot"><span class="annottext">valueOnlyOne :: [a] -&gt; ContentParser a
</span><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var hs-var">valueOnlyOne</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679154153"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679154153"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ContentParser a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679154153"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Must have one value, not zero.&quot;</span></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#valueOnlyOne"><span class="hs-identifier hs-var">valueOnlyOne</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContentParser a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Only one value allowed.&quot;</span></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- | Line predicate.</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-identifier hs-type">isLineNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-394"></span><span id="isLineNamed"><span class="annot"><span class="annottext">isLineNamed :: Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-identifier hs-var hs-var">isLineNamed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#ContentLine"><span class="hs-identifier hs-type">ContentLine</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154152"><span class="annot"><span class="annottext">n :: CI Text
</span><a href="#local-6989586621679154152"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679154151"><span class="annot"><span class="annottext">n' :: CI Text
</span><a href="#local-6989586621679154151"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154152"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154151"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-395"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isLineNamed"><span class="hs-identifier hs-var">isLineNamed</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Component name predicate.</span><span>
</span><span id="line-398"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isComponentNamed"><span class="hs-identifier hs-type">isComponentNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-399"></span><span id="isComponentNamed"><span class="annot"><span class="annottext">isComponentNamed :: Content -&gt; CI Text -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isComponentNamed"><span class="hs-identifier hs-var hs-var">isComponentNamed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679154150"><span class="annot"><span class="annottext">n :: CI Text
</span><a href="#local-6989586621679154150"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679154149"><span class="annot"><span class="annottext">n' :: CI Text
</span><a href="#local-6989586621679154149"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154150"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621679154149"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isComponentNamed"><span class="hs-identifier hs-var">isComponentNamed</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isComponent"><span class="hs-identifier hs-type">isComponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Content"><span class="hs-identifier hs-type">Content</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-403"></span><span id="isComponent"><span class="annot"><span class="annottext">isComponent :: Content -&gt; Bool
</span><a href="Text.ICalendar.Parser.Common.html#isComponent"><span class="hs-identifier hs-var hs-var">isComponent</span></a></span></span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#Component"><span class="hs-identifier hs-type">Component</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#isComponent"><span class="hs-identifier hs-var">isComponent</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- Util</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span id="local-6989586621679154598"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-type">maybeRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679154598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679154598"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-409"></span><span id="maybeRead"><span class="annot"><span class="annottext">maybeRead :: String -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#maybeRead"><span class="hs-identifier hs-var hs-var">maybeRead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, String) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((a, String) -&gt; a)
-&gt; (String -&gt; Maybe (a, String)) -&gt; String -&gt; Maybe a
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, String)] -&gt; Maybe (a, String)
forall a. [a] -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#lastToMaybe"><span class="hs-identifier hs-var">lastToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, String)] -&gt; Maybe (a, String))
-&gt; (String -&gt; [(a, String)]) -&gt; String -&gt; Maybe (a, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, String)]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span id="local-6989586621679154615"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#lastToMaybe"><span class="hs-identifier hs-type">lastToMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679154615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679154615"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-412"></span><span id="lastToMaybe"><span class="annot"><span class="annottext">lastToMaybe :: [a] -&gt; Maybe a
</span><a href="Text.ICalendar.Parser.Common.html#lastToMaybe"><span class="hs-identifier hs-var hs-var">lastToMaybe</span></a></span></span><span> </span><span id="local-6989586621679154146"><span class="annot"><span class="annottext">x :: [a]
</span><a href="#local-6989586621679154146"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679154146"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679154146"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span id="local-6989586621679154585"><span id="local-6989586621679154586"><span id="local-6989586621679154587"><span id="local-6989586621679154588"><span class="annot"><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-type">(.:)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679154588"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679154587"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679154586"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154588"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679154587"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154586"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679154588"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679154587"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679154585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-415"></span><span id=".%3A"><span class="annot"><span class="annottext">.: :: (a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-var hs-var">(.:)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((g a -&gt; g b) -&gt; f (g a) -&gt; f (g b))
-&gt; ((a -&gt; b) -&gt; g a -&gt; g b) -&gt; (a -&gt; b) -&gt; f (g a) -&gt; f (g b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(g a -&gt; g b) -&gt; f (g a) -&gt; f (g b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Text.ICalendar.Parser.Common.html#.%3A"><span class="hs-operator hs-type">.:</span></a></span><span>
</span><span id="line-418"></span></pre></body></html>