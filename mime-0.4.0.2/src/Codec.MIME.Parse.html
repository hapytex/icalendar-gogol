<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module    : Codec.MIME.Pare</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright : (c) 2006-2009, Galois, Inc. </span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer: Sigbjorn Finne &lt;sigbjorn.finne@gmail.com&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability : provisional</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability: portable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Parsing MIME content.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- </span><span>
</span><span id="line-14"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.MIME.Parse</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEBody"><span class="hs-identifier">parseMIMEBody</span></a></span><span>    </span><span class="hs-comment">-- :: [(T.Text,T.Text)] -&gt; T.Text -&gt; MIMEValue</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEType"><span class="hs-identifier">parseMIMEType</span></a></span><span>    </span><span class="hs-comment">-- :: T.Text -&gt; Maybe Type</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier">parseMIMEMessage</span></a></span><span> </span><span class="hs-comment">-- :: T.Text -&gt; MIMEValue</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseHeaders"><span class="hs-identifier">parseHeaders</span></a></span><span>     </span><span class="hs-comment">-- :: T.Text -&gt; ([(T.Text,T.Text)], T.Text)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseMultipart"><span class="hs-identifier">parseMultipart</span></a></span><span>   </span><span class="hs-comment">-- :: Type -&gt; T.Text -&gt; (MIMEValue, T.Text)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#parseContentType"><span class="hs-identifier">parseContentType</span></a></span><span> </span><span class="hs-comment">-- :: T.Text -&gt; Maybe Type</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#splitMulti"><span class="hs-identifier">splitMulti</span></a></span><span>       </span><span class="hs-comment">-- :: T.Text -&gt; T.Text -&gt; ([MIMEValue], T.Text)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier">normalizeCRLF</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html"><span class="hs-identifier">Codec.MIME.Type</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.MIME.Decode.html"><span class="hs-identifier">Codec.MIME.Decode</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">trace</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Codec.MIME.Parse.html#enableTrace"><span class="hs-identifier hs-type">enableTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-39"></span><span id="enableTrace"><span class="annot"><span class="annottext">enableTrace :: Bool
</span><a href="Codec.MIME.Parse.html#enableTrace"><span class="hs-identifier hs-var hs-var">enableTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621679052339"><span class="annot"><a href="Codec.MIME.Parse.html#doTrace"><span class="hs-identifier hs-type">doTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679052339"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679052339"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-42"></span><span id="doTrace"><span class="annot"><span class="annottext">doTrace :: String -&gt; b -&gt; b
</span><a href="Codec.MIME.Parse.html#doTrace"><span class="hs-identifier hs-var hs-var">doTrace</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Codec.MIME.Parse.html#enableTrace"><span class="hs-identifier hs-var">enableTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; b -&gt; b
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span>
</span><span id="line-43"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679052337"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621679052337"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679052337"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEBody"><span class="hs-identifier hs-type">parseMIMEBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#MIMEValue"><span class="hs-identifier hs-type">MIMEValue</span></a></span><span>
</span><span id="line-47"></span><span id="parseMIMEBody"><span class="annot"><span class="annottext">parseMIMEBody :: [MIMEParam] -&gt; Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEBody"><span class="hs-identifier hs-var hs-var">parseMIMEBody</span></a></span></span><span> </span><span id="local-6989586621679052336"><span class="annot"><span class="annottext">headers_in :: [MIMEParam]
</span><a href="#local-6989586621679052336"><span class="hs-identifier hs-var">headers_in</span></a></span></span><span> </span><span id="local-6989586621679052335"><span class="annot"><span class="annottext">body :: Text
</span><a href="#local-6989586621679052335"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MIMEValue
</span><a href="#local-6989586621679052334"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mime_val_headers :: [MIMEParam]
</span><a href="Codec.MIME.Type.html#mime_val_headers"><span class="hs-identifier hs-var">mime_val_headers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052332"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679052334"><span class="annot"><span class="annottext">result :: MIMEValue
</span><a href="#local-6989586621679052334"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#mimeType"><span class="hs-identifier hs-var hs-var">mimeType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052330"><span class="hs-identifier hs-var">mty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Codec.MIME.Type.html#Multipart"><span class="hs-identifier hs-type">Multipart</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(MIMEValue, Text) -&gt; MIMEValue
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Text -&gt; (MIMEValue, Text)
</span><a href="Codec.MIME.Parse.html#parseMultipart"><span class="hs-identifier hs-var">parseMultipart</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052330"><span class="hs-identifier hs-var">mty</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052335"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Codec.MIME.Type.html#Message"><span class="hs-identifier hs-type">Message</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(MIMEValue, Text) -&gt; MIMEValue
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Text -&gt; (MIMEValue, Text)
</span><a href="Codec.MIME.Parse.html#parseMultipart"><span class="hs-identifier hs-var">parseMultipart</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052330"><span class="hs-identifier hs-var">mty</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052335"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MIMEValue
</span><a href="Codec.MIME.Type.html#nullMIMEValue"><span class="hs-identifier hs-var">nullMIMEValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mime_val_type :: Type
</span><a href="Codec.MIME.Type.html#mime_val_type"><span class="hs-identifier hs-var">mime_val_type</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052330"><span class="hs-identifier hs-var">mty</span></a></span><span>
</span><span id="line-53"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_disp :: Maybe Disposition
</span><a href="Codec.MIME.Type.html#mime_val_disp"><span class="hs-identifier hs-var">mime_val_disp</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MIMEParam] -&gt; Maybe Disposition
</span><a href="Codec.MIME.Parse.html#parseContentDisp"><span class="hs-identifier hs-var">parseContentDisp</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052332"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-54"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_content :: MIMEContent
</span><a href="Codec.MIME.Type.html#mime_val_content"><span class="hs-identifier hs-var">mime_val_content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MIMEContent
</span><a href="Codec.MIME.Type.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MIMEParam] -&gt; Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#processBody"><span class="hs-identifier hs-var">processBody</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052332"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052335"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679052332"><span class="annot"><span class="annottext">headers :: [MIMEParam]
</span><a href="#local-6989586621679052332"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052318"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052317"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span> </span><span id="local-6989586621679052318"><span class="annot"><span class="annottext">k :: Text
</span><a href="#local-6989586621679052318"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679052317"><span class="annot"><span class="annottext">v :: Text
</span><a href="#local-6989586621679052317"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052336"><span class="hs-identifier hs-var">headers_in</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679052330"><span class="annot"><span class="annottext">mty :: Type
</span><a href="#local-6989586621679052330"><span class="hs-identifier hs-var hs-var">mty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type -&gt; Type
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Codec.MIME.Parse.html#defaultType"><span class="hs-identifier hs-var">defaultType</span></a></span><span>
</span><span id="line-58"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Type
</span><a href="Codec.MIME.Parse.html#parseContentType"><span class="hs-identifier hs-var">parseContentType</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Type) -&gt; Maybe Text -&gt; Maybe Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Maybe Text
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;content-type&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MIMEParam] -&gt; [(Text, Text)]
</span><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-var">paramPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052332"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Codec.MIME.Parse.html#defaultType"><span class="hs-identifier hs-type">defaultType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-60"></span><span id="defaultType"><span class="annot"><span class="annottext">defaultType :: Type
</span><a href="Codec.MIME.Parse.html#defaultType"><span class="hs-identifier hs-var hs-var">defaultType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type :: MIMEType -&gt; [MIMEParam] -&gt; Type
</span><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type hs-type">Type</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mimeType :: MIMEType
</span><a href="Codec.MIME.Type.html#mimeType"><span class="hs-identifier hs-var">mimeType</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Text"><span class="hs-identifier hs-var">Text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;plain&quot;</span></span><span>
</span><span id="line-61"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mimeParams :: [MIMEParam]
</span><a href="Codec.MIME.Type.html#mimeParams"><span class="hs-identifier hs-var">mimeParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;charset&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;us-ascii&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseContentDisp"><span class="hs-identifier hs-type">parseContentDisp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Disposition"><span class="hs-identifier hs-type">Disposition</span></a></span><span>
</span><span id="line-65"></span><span id="parseContentDisp"><span class="annot"><span class="annottext">parseContentDisp :: [MIMEParam] -&gt; Maybe Disposition
</span><a href="Codec.MIME.Parse.html#parseContentDisp"><span class="hs-identifier hs-var hs-var">parseContentDisp</span></a></span></span><span> </span><span id="local-6989586621679052307"><span class="annot"><span class="annottext">headers :: [MIMEParam]
</span><a href="#local-6989586621679052307"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Disposition
</span><a href="#local-6989586621679052306"><span class="hs-identifier hs-var">processDisp</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Disposition)
-&gt; (Text -&gt; Text) -&gt; Text -&gt; Maybe Disposition
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Disposition) -&gt; Maybe Text -&gt; Maybe Disposition
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Maybe Text
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;content-disposition&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MIMEParam] -&gt; [(Text, Text)]
</span><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-var">paramPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052307"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621679052306"><span class="annot"><span class="annottext">processDisp :: Text -&gt; Maybe Disposition
</span><a href="#local-6989586621679052306"><span class="hs-identifier hs-var hs-var">processDisp</span></a></span></span><span> </span><span id="local-6989586621679052303"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052303"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052303"><span class="hs-identifier hs-var">t</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Disposition
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-69"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052301"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Disposition -&gt; Maybe Disposition
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Disposition -&gt; Maybe Disposition)
-&gt; Disposition -&gt; Maybe Disposition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Disposition :: DispType -&gt; [DispParam] -&gt; Disposition
</span><a href="Codec.MIME.Type.html#Disposition"><span class="hs-identifier hs-type hs-type">Disposition</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dispType :: DispType
</span><a href="Codec.MIME.Type.html#dispType"><span class="hs-identifier hs-var">dispType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispType
</span><a href="#local-6989586621679052297"><span class="hs-identifier hs-var">toDispType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052296"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>                                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dispParams :: [DispParam]
</span><a href="Codec.MIME.Type.html#dispParams"><span class="hs-identifier hs-var">dispParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>                                                   </span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Disposition -&gt; Maybe Disposition
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Disposition -&gt; Maybe Disposition)
-&gt; Disposition -&gt; Maybe Disposition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Disposition :: DispType -&gt; [DispParam] -&gt; Disposition
</span><a href="Codec.MIME.Type.html#Disposition"><span class="hs-identifier hs-type hs-type">Disposition</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dispType :: DispType
</span><a href="Codec.MIME.Type.html#dispType"><span class="hs-identifier hs-var">dispType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispType
</span><a href="#local-6989586621679052297"><span class="hs-identifier hs-var">toDispType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052296"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>                                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dispParams :: [DispParam]
</span><a href="Codec.MIME.Type.html#dispParams"><span class="hs-identifier hs-var">dispParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MIMEParam] -&gt; [DispParam]
</span><a href="#local-6989586621679052294"><span class="hs-identifier hs-var">processParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [MIMEParam]
</span><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052301"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                                                   </span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052296"><span class="annot"><span class="annottext">as :: Text
</span><a href="#local-6989586621679052296"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052301"><span class="annot"><span class="annottext">bs :: Text
</span><a href="#local-6989586621679052301"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679052291"><span class="annot"><span class="annottext">ch :: Char
</span><a href="#local-6989586621679052291"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052291"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052291"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">';'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052303"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679052294"><span class="annot"><span class="annottext">processParams :: [MIMEParam] -&gt; [DispParam]
</span><a href="#local-6989586621679052294"><span class="hs-identifier hs-var hs-var">processParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MIMEParam -&gt; DispParam) -&gt; [MIMEParam] -&gt; [DispParam]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MIMEParam -&gt; DispParam
</span><a href="#local-6989586621679052288"><span class="hs-identifier hs-var">procP</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>        </span><span id="local-6989586621679052288"><span class="annot"><span class="annottext">procP :: MIMEParam -&gt; DispParam
</span><a href="#local-6989586621679052288"><span class="hs-identifier hs-var hs-var">procP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span> </span><span id="local-6989586621679052287"><span class="annot"><span class="annottext">as :: Text
</span><a href="#local-6989586621679052287"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679052286"><span class="annot"><span class="annottext">val :: Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-81"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;filename&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#Filename"><span class="hs-identifier hs-var">Filename</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-82"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;creation-date&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#CreationDate"><span class="hs-identifier hs-var">CreationDate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-83"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;modification-date&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#ModDate"><span class="hs-identifier hs-var">ModDate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-84"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;read-date&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#ReadDate"><span class="hs-identifier hs-var">ReadDate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-86"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; DispParam
</span><a href="Codec.MIME.Type.html#OtherParam"><span class="hs-identifier hs-var">OtherParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var">asl</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052286"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-87"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679052285"><span class="annot"><span class="annottext">asl :: Text
</span><a href="#local-6989586621679052285"><span class="hs-identifier hs-var hs-var">asl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052287"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679052297"><span class="annot"><span class="annottext">toDispType :: Text -&gt; DispType
</span><a href="#local-6989586621679052297"><span class="hs-identifier hs-var hs-var">toDispType</span></a></span></span><span> </span><span id="local-6989586621679052277"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052277"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052277"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;inline&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DispType
</span><a href="Codec.MIME.Type.html#DispInline"><span class="hs-identifier hs-var">DispInline</span></a></span><span>
</span><span id="line-90"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052277"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;attachment&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DispType
</span><a href="Codec.MIME.Type.html#DispAttachment"><span class="hs-identifier hs-var">DispAttachment</span></a></span><span>
</span><span id="line-91"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052277"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;form-data&quot;</span></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DispType
</span><a href="Codec.MIME.Type.html#DispFormData"><span class="hs-identifier hs-var">DispFormData</span></a></span><span>
</span><span id="line-92"></span><span>                   </span><span class="hs-keyword">else</span><span>  </span><span class="annot"><span class="annottext">Text -&gt; DispType
</span><a href="Codec.MIME.Type.html#DispOther"><span class="hs-identifier hs-var">DispOther</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052277"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-type">paramPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span id="paramPairs"><span class="annot"><span class="annottext">paramPairs :: [MIMEParam] -&gt; [(Text, Text)]
</span><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-var hs-var">paramPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MIMEParam -&gt; (Text, Text)) -&gt; [MIMEParam] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MIMEParam -&gt; (Text, Text)
</span><a href="#local-6989586621679052272"><span class="hs-identifier hs-var">paramPair</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679052272"><span class="annot"><span class="annottext">paramPair :: MIMEParam -&gt; (Text, Text)
</span><a href="#local-6989586621679052272"><span class="hs-identifier hs-var hs-var">paramPair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span> </span><span id="local-6989586621679052271"><span class="annot"><span class="annottext">a :: Text
</span><a href="#local-6989586621679052271"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679052270"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679052270"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052271"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052270"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Codec.MIME.Parse.html#processBody"><span class="hs-identifier hs-type">processBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-100"></span><span id="processBody"><span class="annot"><span class="annottext">processBody :: [MIMEParam] -&gt; Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#processBody"><span class="hs-identifier hs-var hs-var">processBody</span></a></span></span><span> </span><span id="local-6989586621679052269"><span class="annot"><span class="annottext">headers :: [MIMEParam]
</span><a href="#local-6989586621679052269"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679052268"><span class="annot"><span class="annottext">body :: Text
</span><a href="#local-6989586621679052268"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Maybe Text
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;content-transfer-encoding&quot;</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; Maybe Text) -&gt; [(Text, Text)] -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MIMEParam] -&gt; [(Text, Text)]
</span><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-var">paramPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052269"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052268"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679052267"><span class="annot"><span class="annottext">v :: Text
</span><a href="#local-6989586621679052267"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="Codec.MIME.Decode.html#decodeBody"><span class="hs-identifier hs-var">decodeBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052268"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-type">normalizeCRLF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-106"></span><span id="normalizeCRLF"><span class="annot"><span class="annottext">normalizeCRLF :: Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-var hs-var">normalizeCRLF</span></a></span></span><span> </span><span id="local-6989586621679052263"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-var">normalizeCRLF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;\r&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-var">normalizeCRLF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052259"><span class="annot"><span class="annottext">a :: Text
</span><a href="#local-6989586621679052259"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052258"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679052258"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'\r'</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-char">'\n'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052259"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-var">normalizeCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052258"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span>
</span><span id="line-112"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier hs-type">parseMIMEMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#MIMEValue"><span class="hs-identifier hs-type">MIMEValue</span></a></span><span>
</span><span id="line-113"></span><span id="parseMIMEMessage"><span class="annot"><span class="annottext">parseMIMEMessage :: Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier hs-var hs-var">parseMIMEMessage</span></a></span></span><span> </span><span id="local-6989586621679052256"><span class="annot"><span class="annottext">entity :: Text
</span><a href="#local-6989586621679052256"><span class="hs-identifier hs-var">entity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ([MIMEParam], Text)
</span><a href="Codec.MIME.Parse.html#parseHeaders"><span class="hs-identifier hs-var">parseHeaders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#normalizeCRLF"><span class="hs-identifier hs-var">normalizeCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052256"><span class="hs-identifier hs-var">entity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679052255"><span class="annot"><span class="annottext">as :: [MIMEParam]
</span><a href="#local-6989586621679052255"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052254"><span class="annot"><span class="annottext">bs :: Text
</span><a href="#local-6989586621679052254"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[MIMEParam] -&gt; Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEBody"><span class="hs-identifier hs-var">parseMIMEBody</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052255"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052254"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseHeaders"><span class="hs-identifier hs-type">parseHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span id="parseHeaders"><span class="annot"><span class="annottext">parseHeaders :: Text -&gt; ([MIMEParam], Text)
</span><a href="Codec.MIME.Parse.html#parseHeaders"><span class="hs-identifier hs-var hs-var">parseHeaders</span></a></span></span><span> </span><span id="local-6989586621679052253"><span class="annot"><span class="annottext">str :: Text
</span><a href="#local-6989586621679052253"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Either (Text, Text) Text
</span><a href="#local-6989586621679052252"><span class="hs-identifier hs-var">findFieldName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052253"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052251"><span class="annot"><span class="annottext">nm :: Text
</span><a href="#local-6989586621679052251"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052250"><span class="annot"><span class="annottext">rs :: Text
</span><a href="#local-6989586621679052250"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ([MIMEParam], Text)
</span><a href="#local-6989586621679052249"><span class="hs-identifier hs-var">parseFieldValue</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052251"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052250"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679052248"><span class="annot"><span class="annottext">body :: Text
</span><a href="#local-6989586621679052248"><span class="hs-identifier hs-var">body</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052248"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679052252"><span class="annot"><span class="annottext">findFieldName :: Text -&gt; Text -&gt; Either (Text, Text) Text
</span><a href="#local-6989586621679052252"><span class="hs-identifier hs-var hs-var">findFieldName</span></a></span></span><span> </span><span id="local-6989586621679052247"><span class="annot"><span class="annottext">acc :: Text
</span><a href="#local-6989586621679052247"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679052246"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either (Text, Text) Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either (Text, Text) Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either (Text, Text) Text)
-&gt; Text -&gt; Either (Text, Text) Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; Either (Text, Text) Text
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052247"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Either (Text, Text) Text
</span><a href="#local-6989586621679052252"><span class="hs-identifier hs-var">findFieldName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052247"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either (Text, Text) Text)
-&gt; Text -&gt; Either (Text, Text) Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052246"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679052249"><span class="annot"><span class="annottext">parseFieldValue :: Text -&gt; Text -&gt; ([MIMEParam], Text)
</span><a href="#local-6989586621679052249"><span class="hs-identifier hs-var hs-var">parseFieldValue</span></a></span></span><span> </span><span id="local-6989586621679052241"><span class="annot"><span class="annottext">nm :: Text
</span><a href="#local-6989586621679052241"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621679052240"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679052240"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052239"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052241"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052238"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052237"><span class="annot"><span class="annottext">zs :: [MIMEParam]
</span><a href="#local-6989586621679052237"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052236"><span class="annot"><span class="annottext">ys :: Text
</span><a href="#local-6989586621679052236"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ([MIMEParam], Text)
</span><a href="Codec.MIME.Parse.html#parseHeaders"><span class="hs-identifier hs-var">parseHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052239"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052241"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052238"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">MIMEParam -&gt; [MIMEParam] -&gt; [MIMEParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[MIMEParam]
</span><a href="#local-6989586621679052237"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052236"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679052238"><span class="annot"><span class="annottext">as :: Text
</span><a href="#local-6989586621679052238"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052239"><span class="annot"><span class="annottext">bs :: Text
</span><a href="#local-6989586621679052239"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text, Text)
</span><a href="Codec.MIME.Parse.html#takeUntilCRLF"><span class="hs-identifier hs-var">takeUntilCRLF</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052240"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseMultipart"><span class="hs-identifier hs-type">parseMultipart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEValue"><span class="hs-identifier hs-type">MIMEValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span id="parseMultipart"><span class="annot"><span class="annottext">parseMultipart :: Type -&gt; Text -&gt; (MIMEValue, Text)
</span><a href="Codec.MIME.Parse.html#parseMultipart"><span class="hs-identifier hs-var hs-var">parseMultipart</span></a></span></span><span> </span><span id="local-6989586621679052234"><span class="annot"><span class="annottext">mty :: Type
</span><a href="#local-6989586621679052234"><span class="hs-identifier hs-var">mty</span></a></span></span><span> </span><span id="local-6989586621679052233"><span class="annot"><span class="annottext">body :: Text
</span><a href="#local-6989586621679052233"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Maybe Text
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;boundary&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MIMEParam] -&gt; [(Text, Text)]
</span><a href="Codec.MIME.Parse.html#paramPairs"><span class="hs-identifier hs-var">paramPairs</span></a></span><span> </span><span class="annot"><span class="annottext">([MIMEParam] -&gt; [(Text, Text)]) -&gt; [MIMEParam] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [MIMEParam]
</span><a href="Codec.MIME.Type.html#mimeParams"><span class="hs-identifier hs-var hs-var">mimeParams</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052234"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (MIMEValue, Text) -&gt; (MIMEValue, Text)
forall a. String -&gt; a -&gt; a
</span><a href="Codec.MIME.Parse.html#doTrace"><span class="hs-identifier hs-var">doTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Multipart mime type, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Text
</span><a href="Codec.MIME.Type.html#showType"><span class="hs-identifier hs-var">showType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052234"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="hs-string">&quot;, has no required boundary parameter. Defaulting to text/plain&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((MIMEValue, Text) -&gt; (MIMEValue, Text))
-&gt; (MIMEValue, Text) -&gt; (MIMEValue, Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MIMEValue
</span><a href="Codec.MIME.Type.html#nullMIMEValue"><span class="hs-identifier hs-var">nullMIMEValue</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mime_val_type :: Type
</span><a href="Codec.MIME.Type.html#mime_val_type"><span class="hs-identifier hs-var">mime_val_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Codec.MIME.Parse.html#defaultType"><span class="hs-identifier hs-var">defaultType</span></a></span><span>
</span><span id="line-141"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_disp :: Maybe Disposition
</span><a href="Codec.MIME.Type.html#mime_val_disp"><span class="hs-identifier hs-var">mime_val_disp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Disposition
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-142"></span><span>		    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_content :: MIMEContent
</span><a href="Codec.MIME.Type.html#mime_val_content"><span class="hs-identifier hs-var">mime_val_content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MIMEContent
</span><a href="Codec.MIME.Type.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052233"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-143"></span><span>		    </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679052231"><span class="annot"><span class="annottext">bnd :: Text
</span><a href="#local-6989586621679052231"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MIMEValue
</span><a href="Codec.MIME.Type.html#nullMIMEValue"><span class="hs-identifier hs-var">nullMIMEValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mime_val_type :: Type
</span><a href="Codec.MIME.Type.html#mime_val_type"><span class="hs-identifier hs-var">mime_val_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679052234"><span class="hs-identifier hs-var">mty</span></a></span><span>
</span><span id="line-145"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_disp :: Maybe Disposition
</span><a href="Codec.MIME.Type.html#mime_val_disp"><span class="hs-identifier hs-var">mime_val_disp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Disposition
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-146"></span><span>			       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mime_val_content :: MIMEContent
</span><a href="Codec.MIME.Type.html#mime_val_content"><span class="hs-identifier hs-var">mime_val_content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MIMEValue] -&gt; MIMEContent
</span><a href="Codec.MIME.Type.html#Multi"><span class="hs-identifier hs-var">Multi</span></a></span><span> </span><span class="annot"><span class="annottext">[MIMEValue]
</span><a href="#local-6989586621679052229"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-147"></span><span>			       </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052228"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052229"><span class="annot"><span class="annottext">vals :: [MIMEValue]
</span><a href="#local-6989586621679052229"><span class="hs-identifier hs-var">vals</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052228"><span class="annot"><span class="annottext">rs :: Text
</span><a href="#local-6989586621679052228"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ([MIMEValue], Text)
</span><a href="Codec.MIME.Parse.html#splitMulti"><span class="hs-identifier hs-var">splitMulti</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052231"><span class="hs-identifier hs-var">bnd</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052233"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Codec.MIME.Parse.html#splitMulti"><span class="hs-identifier hs-type">splitMulti</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEValue"><span class="hs-identifier hs-type">MIMEValue</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="splitMulti"><span class="annot"><span class="annottext">splitMulti :: Text -&gt; Text -&gt; ([MIMEValue], Text)
</span><a href="Codec.MIME.Parse.html#splitMulti"><span class="hs-identifier hs-var hs-var">splitMulti</span></a></span></span><span> </span><span id="local-6989586621679052227"><span class="annot"><span class="annottext">bnd :: Text
</span><a href="#local-6989586621679052227"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span id="local-6989586621679052226"><span class="annot"><span class="annottext">body_in :: Text
</span><a href="#local-6989586621679052226"><span class="hs-identifier hs-var">body_in</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- Note: we insert a CRLF if it looks as if the boundary string starts</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- right off the bat.  No harm done if this turns out to be incorrect.</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679052225"><span class="annot"><span class="annottext">body :: Text
</span><a href="#local-6989586621679052225"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052226"><span class="hs-identifier hs-var">body_in</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052226"><span class="hs-identifier hs-var">body_in</span></a></span><span>
</span><span id="line-155"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052226"><span class="hs-identifier hs-var">body_in</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="Codec.MIME.Parse.html#untilMatch"><span class="hs-identifier hs-var">untilMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052223"><span class="hs-identifier hs-var">dashBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052225"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([MIMEValue], Text)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-158"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679052222"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679052222"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052222"><span class="hs-identifier hs-var">xs</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052222"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ([MIMEValue], Text)
</span><a href="#local-6989586621679052221"><span class="hs-identifier hs-var">splitMulti1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621679052220"><span class="hs-identifier hs-var">dropTrailer</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052222"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679052223"><span class="annot"><span class="annottext">dashBoundary :: Text
</span><a href="#local-6989586621679052223"><span class="hs-identifier hs-var hs-var">dashBoundary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;\r\n--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052227"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679052221"><span class="annot"><span class="annottext">splitMulti1 :: Text -&gt; ([MIMEValue], Text)
</span><a href="#local-6989586621679052221"><span class="hs-identifier hs-var hs-var">splitMulti1</span></a></span></span><span> </span><span id="local-6989586621679052219"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679052219"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052218"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier hs-var">parseMIMEMessage</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052218"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.isPrefixOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier hs-var">parseMIMEMessage</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052218"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621679052220"><span class="hs-identifier hs-var">dropTrailer</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052215"><span class="annot"><span class="annottext">zs :: [MIMEValue]
</span><a href="#local-6989586621679052215"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052214"><span class="annot"><span class="annottext">ys :: Text
</span><a href="#local-6989586621679052214"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ([MIMEValue], Text)
</span><a href="#local-6989586621679052221"><span class="hs-identifier hs-var">splitMulti1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621679052220"><span class="hs-identifier hs-var">dropTrailer</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; MIMEValue
</span><a href="Codec.MIME.Parse.html#parseMIMEMessage"><span class="hs-identifier hs-var">parseMIMEMessage</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052218"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MIMEValue -&gt; [MIMEValue] -&gt; [MIMEValue]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MIMEValue]
</span><a href="#local-6989586621679052215"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052214"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679052218"><span class="annot"><span class="annottext">as :: Text
</span><a href="#local-6989586621679052218"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679052216"><span class="annot"><span class="annottext">bs :: Text
</span><a href="#local-6989586621679052216"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><a href="Codec.MIME.Parse.html#matchUntil"><span class="hs-identifier hs-var">matchUntil</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052223"><span class="hs-identifier hs-var">dashBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052219"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679052220"><span class="annot"><span class="annottext">dropTrailer :: Text -&gt; Text
</span><a href="#local-6989586621679052220"><span class="hs-identifier hs-var hs-var">dropTrailer</span></a></span></span><span> </span><span id="local-6989586621679052212"><span class="annot"><span class="annottext">xs :: Text
</span><a href="#local-6989586621679052212"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052211"><span class="hs-identifier hs-var">xs1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052211"><span class="hs-identifier hs-var">xs1</span></a></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052211"><span class="hs-identifier hs-var">xs1</span></a></span><span> </span><span class="hs-comment">-- hmm, flag an error?</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>       </span><span id="local-6989586621679052211"><span class="annot"><span class="annottext">xs1 :: Text
</span><a href="#local-6989586621679052211"><span class="hs-identifier hs-var hs-var">xs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052212"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseMIMEType"><span class="hs-identifier hs-type">parseMIMEType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-181"></span><span id="parseMIMEType"><span class="annot"><span class="annottext">parseMIMEType :: Text -&gt; Maybe Type
</span><a href="Codec.MIME.Parse.html#parseMIMEType"><span class="hs-identifier hs-var hs-var">parseMIMEType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Type
</span><a href="Codec.MIME.Parse.html#parseContentType"><span class="hs-identifier hs-var">parseContentType</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseContentType"><span class="hs-identifier hs-type">parseContentType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-184"></span><span id="parseContentType"><span class="annot"><span class="annottext">parseContentType :: Text -&gt; Maybe Type
</span><a href="Codec.MIME.Parse.html#parseContentType"><span class="hs-identifier hs-var hs-var">parseContentType</span></a></span></span><span> </span><span id="local-6989586621679052210"><span class="annot"><span class="annottext">str :: Text
</span><a href="#local-6989586621679052210"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052209"><span class="hs-identifier hs-var">minor0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Type -&gt; Maybe Type
forall a. String -&gt; a -&gt; a
</span><a href="Codec.MIME.Parse.html#doTrace"><span class="hs-identifier hs-var">doTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;unable to parse content-type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052210"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; Maybe Type) -&gt; Maybe Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type :: MIMEType -&gt; [MIMEParam] -&gt; Type
</span><a href="Codec.MIME.Type.html#Type"><span class="hs-identifier hs-type hs-type">Type</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mimeType :: MIMEType
</span><a href="Codec.MIME.Type.html#mimeType"><span class="hs-identifier hs-var">mimeType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEType
</span><a href="#local-6989586621679052207"><span class="hs-identifier hs-var">toType</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052206"><span class="hs-identifier hs-var">maj</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052205"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-187"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mimeParams :: [MIMEParam]
</span><a href="Codec.MIME.Type.html#mimeParams"><span class="hs-identifier hs-var">mimeParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [MIMEParam]
</span><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052204"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679052206"><span class="annot"><span class="annottext">maj :: Text
</span><a href="#local-6989586621679052206"><span class="hs-identifier hs-var">maj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052209"><span class="annot"><span class="annottext">minor0 :: Text
</span><a href="#local-6989586621679052209"><span class="hs-identifier hs-var">minor0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052210"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679052203"><span class="annot"><span class="annottext">minor :: Text
</span><a href="#local-6989586621679052203"><span class="hs-identifier hs-var hs-var">minor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052209"><span class="hs-identifier hs-var">minor0</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679052205"><span class="annot"><span class="annottext">as :: Text
</span><a href="#local-6989586621679052205"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052204"><span class="annot"><span class="annottext">bs :: Text
</span><a href="#local-6989586621679052204"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679052202"><span class="annot"><span class="annottext">ch :: Char
</span><a href="#local-6989586621679052202"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052202"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isTSpecial"><span class="hs-identifier hs-var">isTSpecial</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052202"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052203"><span class="hs-identifier hs-var">minor</span></a></span><span> </span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679052207"><span class="annot"><span class="annottext">toType :: Text -&gt; Text -&gt; MIMEType
</span><a href="#local-6989586621679052207"><span class="hs-identifier hs-var hs-var">toType</span></a></span></span><span> </span><span id="local-6989586621679052200"><span class="annot"><span class="annottext">a :: Text
</span><a href="#local-6989586621679052200"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679052199"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679052199"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text -&gt; MIMEType)] -&gt; Maybe (Text -&gt; MIMEType)
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052200"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text -&gt; MIMEType)]
</span><a href="Codec.MIME.Parse.html#mediaTypes"><span class="hs-identifier hs-var">mediaTypes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679052197"><span class="annot"><span class="annottext">ctor :: Text -&gt; MIMEType
</span><a href="#local-6989586621679052197"><span class="hs-identifier hs-var">ctor</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="#local-6989586621679052197"><span class="hs-identifier hs-var">ctor</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052199"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-195"></span><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052200"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052199"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-type">parseParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-type">MIMEParam</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span id="parseParams"><span class="annot"><span class="annottext">parseParams :: Text -&gt; [MIMEParam]
</span><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-var hs-var">parseParams</span></a></span></span><span> </span><span id="local-6989586621679052195"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052195"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052195"><span class="hs-identifier hs-var">t</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-char">';'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052195"><span class="hs-identifier hs-var">t</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052193"><span class="annot"><span class="annottext">nm_raw :: Text
</span><a href="#local-6989586621679052193"><span class="hs-identifier hs-var">nm_raw</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052192"><span class="annot"><span class="annottext">vs0 :: Text
</span><a href="#local-6989586621679052192"><span class="hs-identifier hs-var">vs0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'='</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052195"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-200"></span><span>                                          </span><span id="local-6989586621679052190"><span class="annot"><span class="annottext">nm :: Text
</span><a href="#local-6989586621679052190"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052193"><span class="hs-identifier hs-var">nm_raw</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-201"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052192"><span class="hs-identifier hs-var">vs0</span></a></span><span> </span><span>
</span><span id="line-202"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679052189"><span class="annot"><span class="annottext">vs :: Text
</span><a href="#local-6989586621679052189"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052192"><span class="hs-identifier hs-var">vs0</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-204"></span><span>                            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052189"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052189"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'&quot;'</span></span><span> </span><span>
</span><span id="line-205"></span><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679052187"><span class="annot"><span class="annottext">vs1 :: Text
</span><a href="#local-6989586621679052187"><span class="hs-identifier hs-var hs-var">vs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052189"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span>
</span><span id="line-206"></span><span>                                         </span><span class="hs-special">(</span><span id="local-6989586621679052186"><span class="annot"><span class="annottext">val :: Text
</span><a href="#local-6989586621679052186"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052185"><span class="annot"><span class="annottext">zs0 :: Text
</span><a href="#local-6989586621679052185"><span class="hs-identifier hs-var">zs0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052187"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-207"></span><span>                                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052185"><span class="hs-identifier hs-var">zs0</span></a></span><span> </span><span>
</span><span id="line-208"></span><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052190"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052186"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052190"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052186"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">MIMEParam -&gt; [MIMEParam] -&gt; [MIMEParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [MIMEParam]
</span><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052185"><span class="hs-identifier hs-var">zs0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679052184"><span class="annot"><span class="annottext">val :: Text
</span><a href="#local-6989586621679052184"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679052183"><span class="annot"><span class="annottext">zs :: Text
</span><a href="#local-6989586621679052183"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.break</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679052182"><span class="annot"><span class="annottext">ch :: Char
</span><a href="#local-6989586621679052182"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052182"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isTSpecial"><span class="hs-identifier hs-var">isTSpecial</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052182"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052189"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-211"></span><span>                                    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; MIMEParam
</span><a href="Codec.MIME.Type.html#MIMEParam"><span class="hs-identifier hs-var">MIMEParam</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052190"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052184"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">MIMEParam -&gt; [MIMEParam] -&gt; [MIMEParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [MIMEParam]
</span><a href="Codec.MIME.Parse.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052183"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [MIMEParam] -&gt; [MIMEParam]
forall a. String -&gt; a -&gt; a
</span><a href="Codec.MIME.Parse.html#doTrace"><span class="hs-identifier hs-var">doTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Codec.MIME.Parse.parseParams: curious param value -- &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052195"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Codec.MIME.Parse.html#mediaTypes"><span class="hs-identifier hs-type">mediaTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#MIMEType"><span class="hs-identifier hs-type">MIMEType</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span id="mediaTypes"><span class="annot"><span class="annottext">mediaTypes :: [(Text, Text -&gt; MIMEType)]
</span><a href="Codec.MIME.Parse.html#mediaTypes"><span class="hs-identifier hs-var hs-var">mediaTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;multipart&quot;</span></span><span class="hs-special">,</span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Multipart -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Multipart"><span class="hs-identifier hs-var">Multipart</span></a></span><span> </span><span class="annot"><span class="annottext">(Multipart -&gt; MIMEType) -&gt; (Text -&gt; Multipart) -&gt; Text -&gt; MIMEType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Multipart
</span><a href="#local-6989586621679052181"><span class="hs-identifier hs-var">toMultipart</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;application&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;audio&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Audio"><span class="hs-identifier hs-var">Audio</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;image&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Image"><span class="hs-identifier hs-var">Image</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;message&quot;</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Message"><span class="hs-identifier hs-var">Message</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;model&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Model"><span class="hs-identifier hs-var">Model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;text&quot;</span></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Text"><span class="hs-identifier hs-var">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;video&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Text -&gt; MIMEType
</span><a href="Codec.MIME.Type.html#Video"><span class="hs-identifier hs-var">Video</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679052181"><span class="annot"><span class="annottext">toMultipart :: Text -&gt; Multipart
</span><a href="#local-6989586621679052181"><span class="hs-identifier hs-var hs-var">toMultipart</span></a></span></span><span> </span><span id="local-6989586621679052175"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679052175"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multipart -&gt; Maybe Multipart -&gt; Multipart
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Multipart
</span><a href="#local-6989586621679052174"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [(Text, Multipart)] -&gt; Maybe Multipart
forall a. Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052175"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Multipart)]
</span><a href="Codec.MIME.Parse.html#multipartTypes"><span class="hs-identifier hs-var">multipartTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679052174"><span class="annot"><span class="annottext">other :: Multipart
</span><a href="#local-6989586621679052174"><span class="hs-identifier hs-var hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.isPrefixOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;x-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052175"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Multipart
</span><a href="Codec.MIME.Type.html#Extension"><span class="hs-identifier hs-var">Extension</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052175"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-227"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Multipart
</span><a href="Codec.MIME.Type.html#OtherMulti"><span class="hs-identifier hs-var">OtherMulti</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052175"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Codec.MIME.Parse.html#multipartTypes"><span class="hs-identifier hs-type">multipartTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.MIME.Type.html#Multipart"><span class="hs-identifier hs-type">Multipart</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span id="multipartTypes"><span class="annot"><span class="annottext">multipartTypes :: [(Text, Multipart)]
</span><a href="Codec.MIME.Parse.html#multipartTypes"><span class="hs-identifier hs-var hs-var">multipartTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;alternative&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Alternative"><span class="hs-identifier hs-var">Alternative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;byteranges&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Byteranges"><span class="hs-identifier hs-var">Byteranges</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;digest&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Digest"><span class="hs-identifier hs-var">Digest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;encrypted&quot;</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Encrypted"><span class="hs-identifier hs-var">Encrypted</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;form-data&quot;</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#FormData"><span class="hs-identifier hs-var">FormData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;mixed&quot;</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Mixed"><span class="hs-identifier hs-var">Mixed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;parallel&quot;</span></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Parallel"><span class="hs-identifier hs-var">Parallel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;related&quot;</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Related"><span class="hs-identifier hs-var">Related</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;signed&quot;</span></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Multipart
</span><a href="Codec.MIME.Type.html#Signed"><span class="hs-identifier hs-var">Signed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Codec.MIME.Parse.html#untilMatch"><span class="hs-identifier hs-type">untilMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-243"></span><span id="untilMatch"><span class="annot"><span class="annottext">untilMatch :: Text -&gt; Text -&gt; Maybe Text
</span><a href="Codec.MIME.Parse.html#untilMatch"><span class="hs-identifier hs-var hs-var">untilMatch</span></a></span></span><span> </span><span id="local-6989586621679052161"><span class="annot"><span class="annottext">a :: Text
</span><a href="#local-6989586621679052161"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679052160"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052161"><span class="hs-identifier hs-var">a</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-244"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052161"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052161"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-246"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="Codec.MIME.Parse.html#untilMatch"><span class="hs-identifier hs-var">untilMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052161"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052160"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Codec.MIME.Parse.html#matchUntil"><span class="hs-identifier hs-type">matchUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- searching str; returning parts before str and after str</span><span>
</span><span id="line-250"></span><span id="matchUntil"><span class="annot"><span class="annottext">matchUntil :: Text -&gt; Text -&gt; (Text, Text)
</span><a href="Codec.MIME.Parse.html#matchUntil"><span class="hs-identifier hs-var hs-var">matchUntil</span></a></span></span><span> </span><span id="local-6989586621679052158"><span class="annot"><span class="annottext">str :: Text
</span><a href="#local-6989586621679052158"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text, Text) -&gt; (Text, Text)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Text -&gt; Text) -&gt; Int -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052158"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; (Text, Text))
-&gt; (Text -&gt; (Text, Text)) -&gt; Text -&gt; (Text, Text)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052158"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">{-
matchUntil' :: T.Text -&gt; T.Text -&gt; (T.Text, T.Text)
matchUntil' _   &quot;&quot; = (&quot;&quot;, &quot;&quot;)
matchUntil' str xs
    | T.null xs = mempty
    -- slow, but it'll do for now.
    | str `T.isPrefixOf` xs = (&quot;&quot;, T.drop (T.length str) xs)
    | otherwise = let (as,bs) = matchUntil' str $ T.tail xs in (T.take 1 xs &lt;&gt; as, bs)
-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-type">isHSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-263"></span><span id="isHSpace"><span class="annot"><span class="annottext">isHSpace :: Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var hs-var">isHSpace</span></a></span></span><span> </span><span id="local-6989586621679052156"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679052156"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052156"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052156"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'\t'</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Codec.MIME.Parse.html#isTSpecial"><span class="hs-identifier hs-type">isTSpecial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-266"></span><span id="isTSpecial"><span class="annot"><span class="annottext">isTSpecial :: Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isTSpecial"><span class="hs-identifier hs-var hs-var">isTSpecial</span></a></span></span><span> </span><span id="local-6989586621679052155"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679052155"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679052155"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;()&lt;&gt;@,;:\\\&quot;/[]?=&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &quot;</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-type">dropFoldingWSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-269"></span><span id="dropFoldingWSP"><span class="annot"><span class="annottext">dropFoldingWSP :: Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var hs-var">dropFoldingWSP</span></a></span></span><span> </span><span id="local-6989586621679052154"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-270"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-271"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; Text -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Char) -&gt; Text -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-272"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Codec.MIME.Parse.html#dropFoldingWSP"><span class="hs-identifier hs-var">dropFoldingWSP</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-273"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052154"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Codec.MIME.Parse.html#takeUntilCRLF"><span class="hs-identifier hs-type">takeUntilCRLF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span id="takeUntilCRLF"><span class="annot"><span class="annottext">takeUntilCRLF :: Text -&gt; (Text, Text)
</span><a href="Codec.MIME.Parse.html#takeUntilCRLF"><span class="hs-identifier hs-var hs-var">takeUntilCRLF</span></a></span></span><span> </span><span id="local-6989586621679052153"><span class="annot"><span class="annottext">str :: Text
</span><a href="#local-6989586621679052153"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><a href="#local-6989586621679052152"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052153"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-277"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679052152"><span class="annot"><span class="annottext">go :: Text -&gt; Text -&gt; (Text, Text)
</span><a href="#local-6989586621679052152"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679052151"><span class="annot"><span class="annottext">acc :: Text
</span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679052150"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; Text -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Char) -&gt; Text -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-280"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><a href="#local-6989586621679052152"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-string">&quot;\r\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; Text -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-282"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Codec.MIME.Parse.html#isHSpace"><span class="hs-identifier hs-var">isHSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><a href="#local-6989586621679052152"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (Text, Text)) -&gt; Text -&gt; (Text, Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- case in-sensitive lookup of field names or attributes\/parameters.</span><span>
</span><span id="line-286"></span><span id="local-6989586621679052388"><span class="annot"><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-type">lookupField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679052388"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679052388"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-287"></span><span id="lookupField"><span class="annot"><span class="annottext">lookupField :: Text -&gt; [(Text, a)] -&gt; Maybe a
</span><a href="Codec.MIME.Parse.html#lookupField"><span class="hs-identifier hs-var hs-var">lookupField</span></a></span></span><span> </span><span id="local-6989586621679052149"><span class="annot"><span class="annottext">n :: Text
</span><a href="#local-6989586621679052149"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679052148"><span class="annot"><span class="annottext">ns :: [(Text, a)]
</span><a href="#local-6989586621679052148"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-288"></span><span>   </span><span class="hs-comment">-- assume that inputs have been mostly normalized already </span><span>
</span><span id="line-289"></span><span>   </span><span class="hs-comment">-- (i.e., lower-cased), but should the lookup fail fall back</span><span>
</span><span id="line-290"></span><span>   </span><span class="hs-comment">-- to a second try where we do normalize before giving up.</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, a)] -&gt; Maybe a
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052149"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, a)]
</span><a href="#local-6989586621679052148"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679052146"><span class="annot"><span class="annottext">x :: Maybe a
</span><a href="#local-6989586621679052146"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679052146"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679052145"><span class="annot"><span class="annottext">nl :: Text
</span><a href="#local-6989586621679052145"><span class="hs-identifier hs-var hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052149"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">((Text, a) -&gt; a) -&gt; Maybe (Text, a) -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Text, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Text, a) -&gt; Maybe a) -&gt; Maybe (Text, a) -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Text, a) -&gt; Bool) -&gt; [(Text, a)] -&gt; Maybe (Text, a)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">L.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679052145"><span class="hs-identifier hs-var">nl</span></a></span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; ((Text, a) -&gt; Text) -&gt; (Text, a) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; ((Text, a) -&gt; Text) -&gt; (Text, a) -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text, a) -&gt; Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, a)]
</span><a href="#local-6989586621679052148"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span>
</span><span id="line-297"></span></pre></body></html>